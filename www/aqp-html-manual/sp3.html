<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Soil Profile Data Example 3</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for sp3 {aqp}"><tr><td>sp3 {aqp}</td><td align="right">R Documentation</td></tr></table>

<h2>
Soil Profile Data Example 3
</h2>

<h3>Description</h3>


<p>Soil samples from 10 soil profiles, taken from the Sierra Foothill Region of California.
</p>


<h3>Usage</h3>

<pre>data(sp3)</pre>


<h3>Format</h3>


<p>A data frame with 46 observations on the following 15 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>soil id</p>
</dd>
<dt><code>top</code></dt><dd><p>horizon upper boundary (cm)</p>
</dd> 
<dt><code>bottom</code></dt><dd><p>horizon lower boundary (cm)</p>
</dd>
<dt><code>clay</code></dt><dd><p>clay content</p>
</dd>
<dt><code>cec</code></dt><dd><p>CEC by amonium acetate at pH 7</p>
</dd>
<dt><code>ph</code></dt><dd><p>pH in 1:1 water-soil mixture</p>
</dd>
<dt><code>tc</code></dt><dd><p>total carbon percent</p>
</dd>
<dt><code>hue</code></dt><dd><p>Munsell hue (dry)</p>
</dd>
<dt><code>value</code></dt><dd><p>Munsell value (dry)</p>
</dd>
<dt><code>chroma</code></dt><dd><p>Munsell chroma (dry)</p>
</dd>
<dt><code>mid</code></dt><dd><p>horizon midpoint (cm)</p>
</dd>
<dt><code>ln_tc</code></dt><dd><p>natural log of total carbon percent</p>
</dd>
<dt><code>L</code></dt><dd><p>color: l-coordinate, CIE-LAB colorspace (dry)</p>
</dd>
<dt><code>A</code></dt><dd><p>color: a-coordinate, CIE-LAB colorspace (dry)</p>
</dd>
<dt><code>B</code></dt><dd><p>color: b-coordinate, CIE-LAB colorspace (dry)</p>
</dd>
<dt>name</dt><dd><p>horizon name</p>
</dd>
<dt>soil_color</dt><dd><p>horizon color</p>
</dd>
</dl>



<h3>Details</h3>


<p>These data were collected to support research funded by the Kearney Foundation of Soil Science.
</p>


<h3>References</h3>

<p>http://casoilresource.lawr.ucdavis.edu/</p>


<h3>Examples</h3>

<pre><code class="r">
## this example investigates the concept of a &quot;median profile&quot;

# required packages
library(ape)
data(sp3)

# generate a RGB version of soil colors
# and convert to HSV for aggregation
sp3$h &lt;- NA ; sp3$s &lt;- NA ; sp3$v &lt;- NA
</code></pre>

<pre><code>## Error: length of replacement must equal number of sites or number of
## horizons
</code></pre>

<pre><code class="r">sp3.rgb &lt;- with(sp3, munsell2rgb(hue, value, chroma, return_triplets=TRUE))
</code></pre>

<pre><code>## Error: error in evaluating the argument &#39;x&#39; in selecting a method for
## function &#39;unique&#39;: Error: object &#39;hue&#39; not found
</code></pre>

<pre><code class="r">sp3[, c(&#39;h&#39;,&#39;s&#39;,&#39;v&#39;)] &lt;- t(with(sp3.rgb, rgb2hsv(r, g, b, maxColorValue=1)))
</code></pre>

<pre><code>## Error: object &#39;sp3.rgb&#39; not found
</code></pre>

<pre><code class="r">
# promote to SoilProfileCollection
depths(sp3) &lt;- id ~ top + bottom

# aggregate across entire collection
a &lt;- slab(sp3, fm= ~ clay + cec + ph + h + s + v, slab.structure=10)
</code></pre>

<pre><code>## Error: undefined columns selected
</code></pre>

<pre><code class="r">
# check
str(a)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    107 obs. of  12 variables:
##  $ variable             : Factor w/ 1 level &quot;name&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ all.profiles         : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ H1                   : num  1 1 1 0.96 0.56 0.28 0.04 0 0 0 ...
##  $ H2                   : num  0 0 0 0.04 0.44 0.72 0.96 1 1 0.96 ...
##  $ H3                   : num  0 0 0 0 0 0 0 0 0 0.04 ...
##  $ H4                   : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ H5                   : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ H6                   : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ H7                   : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ top                  : int  0 1 2 3 4 5 6 7 8 9 ...
##  $ bottom               : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ contributing_fraction: num  1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">
# convert back to wide format
library(reshape)
a.wide.q25 &lt;- cast(a, top + bottom ~ variable, value=c(&#39;p.q25&#39;))
</code></pre>

<pre><code>## Error: arguments imply differing number of rows: 107, 0
</code></pre>

<pre><code class="r">a.wide.q50 &lt;- cast(a, top + bottom ~ variable, value=c(&#39;p.q50&#39;))
</code></pre>

<pre><code>## Error: arguments imply differing number of rows: 107, 0
</code></pre>

<pre><code class="r">a.wide.q75 &lt;- cast(a, top + bottom ~ variable, value=c(&#39;p.q75&#39;))
</code></pre>

<pre><code>## Error: arguments imply differing number of rows: 107, 0
</code></pre>

<pre><code class="r">
# add a new id for the 25th, 50th, and 75th percentile pedons
a.wide.q25$id &lt;- &#39;Q25&#39;
</code></pre>

<pre><code>## Error: object &#39;a.wide.q25&#39; not found
</code></pre>

<pre><code class="r">a.wide.q50$id &lt;- &#39;Q50&#39;
</code></pre>

<pre><code>## Error: object &#39;a.wide.q50&#39; not found
</code></pre>

<pre><code class="r">a.wide.q75$id &lt;- &#39;Q75&#39;
</code></pre>

<pre><code>## Error: object &#39;a.wide.q75&#39; not found
</code></pre>

<pre><code class="r">
# combine original data with &quot;mean profile&quot;
vars &lt;- c(&#39;top&#39;,&#39;bottom&#39;,&#39;id&#39;,&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;,&#39;h&#39;,&#39;s&#39;,&#39;v&#39;)
# make data.frame version of sp3
sp3.df &lt;- as(sp3, &#39;data.frame&#39;)
sp3.grouped &lt;- rbind(
sp3.df[, vars], a.wide.q25[, vars], a.wide.q50[, vars], a.wide.q75[, vars]
)
</code></pre>

<pre><code>## Error: undefined columns selected
</code></pre>

<pre><code class="r">
# re-constitute the soil color from HSV triplets
# convert HSV back to standard R colors
sp3.grouped$soil_color &lt;- with(sp3.grouped, hsv(h, s, v))
</code></pre>

<pre><code>## Error: object &#39;sp3.grouped&#39; not found
</code></pre>

<pre><code class="r">
# give each horizon a name
sp3.grouped$name &lt;- paste(round(sp3.grouped$clay), &#39;/&#39; , 
round(sp3.grouped$cec), &#39;/&#39;, round(sp3.grouped$ph,1))
</code></pre>

<pre><code>## Error: object &#39;sp3.grouped&#39; not found
</code></pre>

<pre><code class="r">


## perform comparison, and convert to phylo class object
## D is rescaled to [0,]
d &lt;- profile_compare(sp3.grouped, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), max_d=100, 
k=0.01, replace_na=TRUE, add_soil_flag=TRUE, rescale.result=TRUE)
</code></pre>

<pre><code>## Error: error in evaluating the argument &#39;s&#39; in selecting a method for
## function &#39;profile_compare&#39;: Error: object &#39;sp3.grouped&#39; not found
</code></pre>

<pre><code class="r">
require(cluster)
h &lt;- agnes(d, method=&#39;ward&#39;)
p &lt;- ladderize(as.phylo(as.hclust(h)))


# look at distance plot-- just the median profile
plot_distance_graph(d, 12)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAwFBMVEX9/v0AAAAAAEYAAHMARpoAdL0ApDEAuSgAzQAAzR0AzUYAzXMA1kYA1poA3r0SzQASzRIddkAoXUAxQEA5QEA5jxJAQEBAXShGAABGAEZGAHNGRkZGm5pGm95GzQBGzUZGzXNG5t5zAABzAEZzvv1zzQBz7v2aRgCadACa1gCa3/2a9t6a9v29dAC9dHO93gC97nO9/r29/v3em0be3/3e5kbe/r3e/t7e/v39vnP935r97nP99pr9/r39/t79/v2qi3IVAAAAQHRSTlP///////////////////////////////////////////////////////////////////////////////////8AwnuxRAAAAAlwSFlzAAAPYQAAD2EBqD+naQAAGjxJREFUeJztnQ1748Z1RgOt1MJO104dh5GdyokZ7apWVt12WTVL7VL8//+q+CAJkJgBMIN5Bxdz3/M8FEWBxFwAR3MHFx/83Z4QAL+bOwCSJhSLQKBYBALFIhAoFoFAsQgEikUgUCwCgWIRCBSLQKBYBALFIhAoFoFAsQgEikUgUCwCgWIRCBSLQKBYBALFIhAoFoFAsQgEikUgUCwCgWIRCBSLQKBYBALFIhAoFoFAsQgEikUgUCwCgWIRCBSLQKBYBALFIhAoFoFAsQgEikUgUCwCgWIRCBSLQKBYBALFIhAoFoFAsQgEikUgUCwCgWIRCBSLQKBYBALFIhAoFoFAsQgEikUgUCwCgWIRCBSLQKBYBALFIhAoFoFAsQgEikUgUCwCgWIRCBSLQKBYBALFIhAoFoFAsQgEikUgUCwCgWIRCBSLQKBYBALFIhAoFoEQWKyMJM5cYoWdHZEGxSIQFIq1mq9pRSFQLIYAQaFYJAYUi0BQKJaCPCQgBIrFECAoFIvEgGIRCOHFevn50+n3bZZlN9PaDY+CPCQghOBi7dZvTmJts/vitdEsipV4CKHFKvqok1ivD6VT26vHKe2SZRJYrJfbu81JrOLF6ad3u2SZhB9jtcW635e5UZhYCvKQgBCQYpVDrP35IOt0ts6qWLCZHqsZ2z48VjO3H+cRU6zGsLGzI8tEYSokMcCKVQ/e76e0Gx4FAxwBISDFElpuULBVBYSAFEtogZTEACVWPXAX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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
# similarity relative to median profile (profile #12)
round(1 - (as.matrix(d)[12, ] / max(as.matrix(d)[12, ])), 2)
</code></pre>

<pre><code>##  hon-1 hon-10 hon-11 hon-13 hon-14 hon-17 hon-18 hon-19  hon-2 hon-20 
##   0.05   0.04   0.00   0.33   0.23   0.47   0.36   0.48   0.17   0.40 
## hon-21 hon-22  hon-3  hon-4  hon-5  hon-6  hon-7  hon-8 
##   0.78   1.00   0.06   0.23   0.19   0.17   0.08   0.08
</code></pre>

<pre><code class="r">
## make dendrogram + soil profiles
# first promote to SoilProfileCollection
depths(sp3.grouped) &lt;- id ~ top + bottom
</code></pre>

<pre><code>## Error: object &#39;sp3.grouped&#39; not found
</code></pre>

<pre><code class="r">
# setup plot: note that D has a scale of [0,1]
par(mar=c(1,1,1,1))
p.plot &lt;- plot(p, cex=0.8, label.offset=3, direction=&#39;up&#39;, y.lim=c(2,0), 
x.lim=c(1.25,length(sp3.grouped)+1), show.tip.label=FALSE)
</code></pre>

<pre><code>## Error: object &#39;sp3.grouped&#39; not found
</code></pre>

<pre><code class="r">
# get the last plot geometry
lastPP &lt;- get(&quot;last_plot.phylo&quot;, envir = .PlotPhyloEnv)

# the original labels, and new (indexed) order of pedons in dendrogram
d.labels &lt;- attr(d, &#39;Labels&#39;)

new_order &lt;- sapply(1:lastPP$Ntip,
function(i) which(as.integer(lastPP$xx[1:lastPP$Ntip]) == i))

# plot the profiles, in the ordering defined by the dendrogram
# with a couple fudge factors to make them fit
plot(sp3.grouped, color=&quot;soil_color&quot;, plot.order=new_order,
scaling.factor=0.01, width=0.1, cex.names=0.5,
y.offset=max(lastPP$yy)+0.1, add=TRUE)
</code></pre>

<pre><code>## Error: error in evaluating the argument &#39;x&#39; in selecting a method for
## function &#39;plot&#39;: Error: object &#39;sp3.grouped&#39; not found
</code></pre>

<pre><code class="r">
</code></pre>


<hr><div align="center">[Package <em>aqp</em> version 1.4-7 <a href="00Index.html">Index</a>]</div>
</body></html>
