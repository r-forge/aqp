<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Example Objective Function for Full-Pattern Matching</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for f.noise {aqp}"><tr><td>f.noise {aqp}</td><td align="right">R Documentation</td></tr></table>

<h2>
Example Objective Function for Full-Pattern Matching
</h2>

<h3>Description</h3>


<p>Basic objective function that can be used as a starting point for developing XRD full-pattern matching strategies. [details pending...]
</p>


<h3>Usage</h3>

<pre>
f.noise(inits, pure.patterns, sample.pattern, eps.total = 0.05)
</pre>


<h3>Arguments</h3>


<table summary="R argblock">
<tr valign="top"><td><code>inits</code></td>
<td>
<p>vector of initial guesses for mineral fractions, last item is a noise component</p>
</td></tr>
<tr valign="top"><td><code>pure.patterns</code></td>
<td>
<p>a matrix of XRD patterns of pure samples, resampled to the same twotheta resolution and rescaled according to an external standard</p>
</td></tr>
<tr valign="top"><td><code>sample.pattern</code></td>
<td>
<p>the unkown or composite pattern, aligned to the same twotheta axis as the pure patterns and rescaled to an external standard</p>
</td></tr>
<tr valign="top"><td><code>eps.total</code></td>
<td>
<p>precision of comparisons; currently not used</p>
</td></tr>
</table>


<h3>Details</h3>


<p>This is similar to the work of Chipera and Bish (2002), using the methods described in (Bish, 1994). If the flexibility of a custom objective function is not required, the linear model framework should be sufficient for pattern fitting. GLS should be used if realistic standard errors are needed.
</p>


<h3>Value</h3>

<p>the sum of absolute differences between the unkown pattern and combination of pure patterns for the current set of mixture proportions</p>


<h3>Author(s)</h3>

<p>Dylan E. Beaudette</p>


<h3>References</h3>


<p>Chipera, S.J., &amp; Bish, D.L. (2002) FULLPAT:  A full-pattern quantitative 
analysis program for X-ray powder diffraction using measured and calculated 
patterns.  J. Applied Crystallography, 35, 744-749. 
</p>
<p>Bish, D. 1994. Quantitative Methods in Soil Mineralogy, in Quantitative X-Ray Diffraction Analysis of Soil. Amonette, J. &amp; Zelazny, L. (ed.) Soil Science Society of America, pp 267-295.
</p>


<h3>See Also</h3>

<p><code><a href="resample.twotheta.html">resample.twotheta</a></code></p>


<h3>Examples</h3>

<pre><code class="r">

# sample data
data(rruff.sample)

# get number of measurements
n &lt;- nrow(rruff.sample)

# number of components
n.components &lt;- 6

# mineral fractions, normally we don&#39;t know these
w &lt;- c(0.346, 0.232, 0.153, 0.096, 0.049, 0.065)


# make synthetic combined pattern
# scale the pure substances by the known proportions
rruff.sample$synthetic_pat &lt;- apply(sweep(rruff.sample[,2:7], 2, w, &#39;*&#39;), 1, sum)

# add 1 more substance that will be unknown to the fitting process
rruff.sample$synthetic_pat &lt;- rruff.sample$synthetic_pat + 
(1 - sum(w)) * rruff.sample[,8]

# try adding some nasty noise
# rruff.sample$synthetic_pat &lt;- apply(sweep(rruff.sample[,2:7], 2, w, &#39;*&#39;), 1, sum) + 
# runif(n, min=0, max=100)


# look at components and combined pattern
par(mfcol=c(7,1), mar=c(0,0,0,0))
plot(1:n, rruff.sample$synthetic_pat, type=&#39;l&#39;, axes=FALSE)
legend(&#39;topright&#39;, bty=&#39;n&#39;, legend=&#39;combined pattern&#39;, cex=2)
for(i in 2:7)
    {
    plot(1:n, rruff.sample[, i], type=&#39;l&#39;, axes=FALSE)
    legend(&#39;topright&#39;, bty=&#39;n&#39;, 
    legend=paste(names(rruff.sample)[i], &#39; (&#39;, w[i-1], &#39;)&#39;, sep=&#39;&#39;), cex=2)
    }
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">


## fit pattern mixtures with a linear model
l &lt;- lm(synthetic_pat ~ nontronite + montmorillonite + clinochlore 
+ antigorite + chamosite + hematite, data=rruff.sample)

summary(l)
</code></pre>

<pre><code>## 
## Call:
## lm(formula = synthetic_pat ~ nontronite + montmorillonite + clinochlore + 
##     antigorite + chamosite + hematite, data = rruff.sample)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -3.597 -0.669 -0.153  0.424 24.002 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     1.234818   0.050994    24.2   &lt;2e-16 ***
## nontronite      0.344964   0.000804   428.8   &lt;2e-16 ***
## montmorillonite 0.231452   0.000420   551.7   &lt;2e-16 ***
## clinochlore     0.152082   0.000739   205.9   &lt;2e-16 ***
## antigorite      0.095911   0.000204   469.7   &lt;2e-16 ***
## chamosite       0.049883   0.001389    35.9   &lt;2e-16 ***
## hematite        0.074622   0.001086    68.7   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
## 
## Residual standard error: 1.47 on 2993 degrees of freedom
## Multiple R-squared: 0.997,   Adjusted R-squared: 0.997 
## F-statistic: 1.72e+05 on 6 and 2993 DF,  p-value: &lt;2e-16
</code></pre>

<pre><code class="r">
par(mfcol=c(2,1), mar=c(0,3,0,0))
plot(1:n, rruff.sample$synthetic_pat, type=&#39;l&#39;, lwd=2, lty=2, axes=FALSE, 
xlab=&#39;&#39;, ylab=&#39;&#39;)
lines(1:n, predict(l), col=2)
axis(2, cex.axis=0.75, las=2)
legend(&#39;topright&#39;, legend=c(&#39;original&#39;,&#39;fitted&#39;), col=c(1,2), lty=c(2,1), 
lwd=c(2,1), bty=&#39;n&#39;, cex=1.25)

plot(1:n, resid(l), type=&#39;l&#39;, axes=FALSE, xlab=&#39;&#39;, ylab=&#39;&#39;, col=&#39;blue&#39;)
abline(h=0, col=grey(0.5), lty=2)
axis(2, cex.axis=0.75, las=2)
legend(&#39;topright&#39;, legend=c(&#39;residuals&#39;), bty=&#39;n&#39;, cex=1.25)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAdVBMVEX9/v0AAAAAAEYAAHMAAP8ARpoAdL1GAABGAEZGAHNGRgBGRppGdHNGm95zAABzAEZzAHNzdABzvv2AgICaRgCaRkaam72a396a3/29dAC935q9/r29/v3em0bevnPevr3e/v39vnP935r9/r39/t79/v3/AABGwqYHAAAAJ3RSTlP/////////////////////////////////////////////////AP89cIUmAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAgAElEQVR4nO2di3rcNpJGBzZtZ5JIyXicXWvH2lgX4P0fcUQSKBSuLLAJNpv6z5dYrW4Sl8IhCIJs4R8agA7849oFAOcEYoEuQCzQBYgFugCxQBcgFugCxAJdgFigCxALdAFigS5kxHr+otTX+cenn/r1m/r4Y/9yNWKuXQAQkYr1cv9VP334rp8+T78+fB7/OzgKYh2NVKynqZv6qh/uxt9e/viun/959C5rFkupa5cDEPkx1luv9frX9/HVKNUoF6GIXconw4qFfus45MV6/PTz5Y9f1YfvqVgExAIVsmI9vg3Xn3/5rl/+/AGxwCpyYj1+sCK9GXVLYhmIdRwyYj3S9MKbUeXB++HEUhBrc57UXfV3xuu3YFoqFWs8B45JjKfD336WpxuOJJZBj9WHLcV6mC75vupHNc2MvtwXJkghFuAsiiUFYgEOxAJFnuaTlR4H2v+5Vx++z6e+t7OWunv+8tmeCh8+/O83t93r+Go6p0Gs0xPPYGd/z+w3S6LUOKR+/Piv8VbxJNJ411ip371Y82bj3MH80fQaYp2d+NZI/vfMjo/OlTv3ehLpzbdJKeXFmjwaf39wPdodxAIFXr/N85fPXz79fBNruvwbRZp+H1XzYt1NH/nJgseTijXPYGEe6zJe7ieBZkMe5yHUKJKdYuBjrO/u93n7tw7wnGJpiLUBXqw3cYRiuWEZxAJF1vRYD/PV4VlPhRBrC6IxFomVjrFILOviW78FsUCR8KqQxEqvCplY48tpmgtigSJ2gmrshZhYNFlVOBXazyAWKMJm3plYU5f08f+yV4WTWXfj2RJigVVUHmzIcQqxMI/Vk+cv9imXry17nUgszLz3gd9ClAOxwCIPNPSSA7FAFyAW6ALEAl2A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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">




## fitting by minimizing an objective function (not run)

# SANN is a slower algorithm, sometimes gives strange results
# default Nelder-Mead is most robust
# CG is fastest --&gt; 2.5 minutes max
# component proportions (fractions), and noise component (intensity units)
# initial guesses may affect the stability / time of the fit

## this takes a while to run
# # synthetic pattern
# o &lt;- optim(par=c(0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1), f.noise, 
# method=&#39;CG&#39;, pure.patterns=rruff.sample[,2:7], 
# sample.pattern=rruff.sample$synthetic_pat)
# 
# 
# # estimated mixture proportions
# o$par
# 
# # compare with starting proportions
# rbind(o$par[1:n.components], w)
# 
# # if we had an unkown pattern we were trying to match, compare fitted here
# # compute R value 0.1 - 0.2 considered good
# # sum(D^2) / sum(s) 
# # o$value / sum(rruff.sample$sample)
# 
# # plot estimated mixture vs sample
# # combine pure substances
# pure.mixture &lt;- apply(sweep(rruff.sample[, 2:7], 2, o$par[1:n.components], &#39;*&#39;), 1, sum)
# 
# # add in noise
# noise.component &lt;- o$par[n.components+1]
# est.pattern &lt;- pure.mixture + noise.component
# 
# 
# # plot results
# par(mfcol=c(2,1), mar=c(0,3,0,0))
# plot(1:n, rruff.sample$synthetic_pat, type=&#39;l&#39;, lwd=2, lty=2, axes=FALSE, 
# xlab=&#39;&#39;, ylab=&#39;&#39;)
# lines(1:n, est.pattern, col=2)
# lines(1:n, rep(noise.component, n), col=3)
# axis(2, cex.axis=0.75, las=2)
# legend(&#39;topright&#39;, legend=c(&#39;original&#39;,&#39;fitted&#39;,&#39;noise&#39;), col=c(1,2,3), lty=c(2,1,1), 
# lwd=c(2,1,1), bty=&#39;n&#39;, cex=1.25)
# 
# plot(1:n, rruff.sample$synthetic_pat - est.pattern, type=&#39;l&#39;, axes=FALSE, 
# xlab=&#39;&#39;, ylab=&#39;&#39;)
# abline(h=0, col=grey(0.5), lty=2)
# axis(2, cex.axis=0.75, las=2)
# legend(&#39;topright&#39;, legend=c(&#39;difference&#39;), bty=&#39;n&#39;, cex=1.25)
# 

</code></pre>


<hr><div align="center">[Package <em>aqp</em> version 1.5 <a href="00Index.html">Index</a>]</div>
</body></html>
