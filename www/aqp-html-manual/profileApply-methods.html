<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Apply a function to soil profiles within a...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for profileApply-methods {aqp}"><tr><td>profileApply-methods {aqp}</td><td align="right">R Documentation</td></tr></table>

<h2>Apply a function to soil profiles within a SoilProfileCollection object.</h2>

<h3>Description</h3>

<p>Apply a function to soil profiles within a SoilProfileCollection object, each iteration has access to a SoilProfileCollection object.</p>


<h3>Usage</h3>

<pre>
# method for SoilProfileCollection objects
profileApply(object, FUN, simplify=TRUE, ...)
</pre>


<h3>Arguments</h3>


<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>a SoilProfileCollection</p>
</td></tr>
<tr valign="top"><td><code>FUN</code></td>
<td>
<p>a function to be applied to each profile within the collection</p>
</td></tr>
<tr valign="top"><td><code>simplify</code></td>
<td>
<p>logical, should the result be simplified to a vector? see examples</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>further arguments passsed to FUN</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When simplify is TRUE, a vector of length <code>nrow(object)</code> (horizon data) or of length <code>length(object)</code> (site data). When simplify is FALSE, a list is returned.</p>


<h3>Methods</h3>



<dl>
<dt><code>signature(object = "SoilProfileCollection")</code></dt><dd></dd>
</dl>


<h3>See Also</h3>

 <p><code><a href="SPC-slab-methods.html">slab</a></code> </p>


<h3>Examples</h3>

<pre><code class="r">
data(sp1)
depths(sp1) &lt;- id ~ top + bottom

# scale properties within each profile
# scaled = (x - mean(x)) / sd(x)
sp1$d &lt;- profileApply(sp1, FUN=function(x) round(scale(x$prop), 2))
plot(sp1, name=&#39;d&#39;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAllBMVEX9/v0AAAAAAEYAAHMARkYARpoAdL1GAABGAEZGAHNGRgBGRkZGdL1Gm95zAABzAHNzRppzdABzdEZzdHNzdJpzdL1zm95zvv2aRgCaRkaaRnOadEaadHOadJqam3Oavpqa396a3/29dAC9dEa9dHO9m0a9vnO9/t69/v3em0be397e/v39vnP935r9/r39/t79/v3///9D2fDkAAAAMnRSTlP///////////////////////////////////////////////////////////////8A/7N2ihAAAAAJcEhZcwAAD2EAAA9hAag/p2kAABmzSURBVHic7Z0Ne9u21UBHu7W3xk7fbkuUdGne2kk6s6Es9f//uQmEJZIWAOLy8pKUdM4TKXmUS5CSjgAQn3/bAhjwt7kvAM4TxAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0yYRKz1bVEUP37flkVxv3153q7//pAXuvlQFDeZqT4WxSr3AjYfAqlGEr0KXGsotMq+1N2Tv4y8C8hM1X1WoQ9geqYRa+fQ89v73V+HP7tPJfRlhULL66fnt4FPKxBaXT1U1095F7D7JkJiHUduPgS+/3DoPums828fMy91965yUy1//B7+wU7OlGJVtSH+ef33/w/nWMehu1dTYr0KLRPfVid0/Y9f4mK1I5/fRjKM49Cg1bFLrVK/rO5nlRSrHboTK/hZTc+URaF/1/v3niwKu6HBQiscWoa/rePQzYfVY7wobEfuBAiLfRzqyrfcSw2/qWBolSzgu++quPrpgsTyDnV/sBGxAqG7X2V2qvHM7VVoebMNihVM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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

# compute depth-wise differencing by profile
# note that our function expects that the column &#39;prop&#39; exists
f &lt;- function(x) { c(x$prop[1], diff(x$prop)) }
sp1$d &lt;- profileApply(sp1, FUN=f)
plot(sp1, name=&#39;d&#39;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAjVBMVEX9/v0AAAAAAEYAAHMARkYARnMARpoAdL1GAABGAEZGAHNGRgBGRkZGdL1Gm95zAABzAHNzRkZzRppzdABzdHNzdL1zm95zvv2aRgCaRkaaRnOadHOadJqam3Oavpqa396a3/29dAC9dEa9dHO9m0a9/v3em0be397e/v39vnP935r9/r39/t79/v3///+n3iD+AAAAL3RSTlP///////////////////////////////////////////////////////////8A/+SDKggAAAAJcEhZcwAAD2EAAA9hAag/p2kAABT2SURBVHic7d2NdtvWsYbhUmkttbUUn7Y2lcTukRQbNSmq9395JcgktoUZekbDbwMg32dluV1eGz8SXwMgCAJ/egIE/jT2CuA0ERYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxJNwlpfLRaLV5+fusXi5um3P5/Wf72LDd3cLhaXwbneLxbL6Apsbo25OjO9MNbVGroKr+r2j/1qxFYgONf+d2X9AtprE9a2occfb7b/88d/29+K9WJZQ7sfPj3+aPy2jKGri7vVD59iK7B9JaywhiM3t8brbw/9fdah5T/dB1d1+1NF59q9+mz/g22uZVirXSH7P9d//be9xRoO3f7tobCeDe0OvFrfDF3/7Z9+WF+PfPzR2WAMh5pVe6u6OvQv69vf1cGwvh66Dcv8XbXXcle4/6l//9kP7gq/HWrutOyhnf1qDYdubpf3/q7w65HbAOywh0P7/Vt0Ve0fyhy6OriD//anWlz8/YzC2jf07T9YJyxj6PZfZXiu/sbt2dDu8skMy5ypuTc0hq4O7LWfz3V9ZQZQnKvzC2ivZVjfHmIcDOvr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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
# compute depth-wise cumulative sum by profile
# note the use of an anonymous function
sp1$d &lt;- profileApply(sp1, FUN=function(x) cumsum(x$prop))
plot(sp1, name=&#39;d&#39;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAllBMVEX9/v0AAAAAAEYAAHMARkYARpoAdL1GAABGAEZGAHNGRgBGRkZGdL1Gm95zAABzAHNzRppzdABzdEZzdHNzdL1zm95zvv2aRgCaRkaaRnOadEaadHOadJqam3Oavpqa396a3/29dAC9dEa9dHO9m0a9vnO9/t69/v3em0be397e/r3e/v39vnP935r9/r39/t79/v3///8HSqAQAAAAMnRSTlP///////////////////////////////////////////////////////////////8A/7N2ihAAAAAJcEhZcwAAD2EAAA9hAag/p2kAABaMSURBVHic7Z2LehNJkkZHZsbMgE2zOyBgG3Z9YcfViyxp3v/lVilBA6oIEenQn1UlnfO13f25ozLLquPMrLz+ZQ0g4C9D3wCcJogFEhALJCAWSEAskIBYIAGxQAJigQTEAgmIBRIQCyQgFkhALJCAWCABsUACYoEExAIJiAUSEAskIBZIQCyQgFggAbFAAmKBBMQCCYgFEhALJCAWSEAskIBYIAGxQAJigQTEAgmIBRIQCyQgFkhALJCAWCABsUACYoEExAIJiAUSEAskIBZIQCyQgFggAbFAAmKBBMQCCYgFEhALJCAWSEAskIBYIAGxQAJigQTEAgmIBRIQCyQgFkhALJCAWCABsUACYoEExAIJiAUSEAskIBZIQCyQgFggAbFAAmKBBMQCCYgFEhALJCAWSEAskIBYIAGxQAJigQTEAgmIBRIQCyQ0Eevx+Ww2+9uXdTebXa+/fl8//v0mFrp6N5tdBlO9nc3m0RtYvTNSdRK9MO7VCl2Eb3XzbXcbsRsIplo+K+sDaE8bsTYOLV9db/715z+bT8V6WFZo9+xh+cr4tIzQxcXN4tlD7AY2T8ISqx+5emc8fzv0W9Kh/Ne3wVvd/FbRVLu/fbH/YJvTUqzF1pDd98e//7ddYvVDNz89JNZeaHfgaf0U+viP//DF+jFy+copMPqhptXerS4O/WX9/FkdFOvH0I1Y5mfVnpZV4e63/va7H6wKfw41Ky07tLOfVj909W5+61eFP0ZuBLDF7oeW+i16q/YvZYYuDlbwP/9Ws4sXZyTWzqGf/2AdsYzQzV9lOFW/cNsL7S7XplhmomZtaIQu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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

# compute profile-means, and save to @site
# there must be some data in @site for this to work
site(sp1) &lt;- ~ group
sp1$mean_prop &lt;- profileApply(sp1, FUN=function(x) mean(x$prop, na.rm=TRUE))

# re-plot using ranks defined by computed summaries (in @site)
plot(sp1, plot.order=rank(sp1$mean_prop))
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAw1BMVEX9/v0AAAAAAEYAAHMARkYARpoAdL1GAABGAEZGAHNGRgBGRkZGRppGdJpGdL1Gm95zAABzAHNzRnNzRppzdABzdEZzdHNzdL1zm5pzm95zvr1zvt5zvv2aRgCaRnOadEaadJqam0aam3Oam5qam72am96avpqa372a396a3/29dAC9dEa9dHO9m0a935q93969/r29/t69/v3em0bem3Pem5re35re397e/t7e/v39vnP9vpr935r9/r39/t79/v3///8BANofAAAAQXRSTlP///////////////////////////////////////////////////////////////////////////////////8A/45z/jgAAAAJcEhZcwAAD2EAAA9hAag/p2kAABfASURBVHic7Z0Le9u4lUAreyt3Nl3LTqbxuKNJM0mb1I90M+JsZ8yVov3/v2r5cKIHL2yAlxcEyXM+j2fqXl5C0hEAgiDwhy2AAX/ouwAwThALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwIYpY67PZbPbHh202my22j7/z2WzuF/rlp6DQpV9o8av6Hx5FvfU+fxl6cuMXul3/SYh0ZfV8VdviLZDKGp84YhVv4eZiUfzr6McrNDtdbS6EN1YK/eODb9bir7enK5/I/MS7qF9+aqrqOv/6TFLQUYBcKKr8qjLxSxCfmGLllSHffvuGFn99Sqz90EIs39CizhTrlmbkM9+B/dDNhaNyk7J+kGss8Q3InhDrIHT93fdTEquus+uP/fH37Mn2ZT/UVb0LoUVTePKfklhCVu+kZav9REu0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Tt7NAjuXQ99WzsSWKd2Ell5jvrxfbe9fF/+simvr9Xm2yOcH/VUP4ollAtWQEulN2Fxtd2IVP6Vc14jVQeiEEN6EcjmdXVNY/xdiIVYYwptQLqez67xXfSzEQqxARjDcYAJiKUEsGcRSglgyiKUEsWQQSwliySCWEsSSQSwliCWDWEoQSwaxlCCWDGIpQSwZxFKCWDKIpQSxZBBLCWLJIJYSxJJBLCWIJYNYShBLBrGUIJYMYilBLBnEUoJYMoilBLFkEEsJYskglhLEkkEsJYglg1hKEEsGsZQglgxiKUEsGcRSglgyiKUEsWQQSwliySCWEsSSQSwliCXD+o9KEEuGGksJYskglhLEkkEsJYglg1hKEEsmoEeOWBKIJdPVtqlj29/SG8SS6Wrb1KMt6KYDYsl0tW3q0RZ00wGxZLraNvVoC7rpgFgyXW2berQF3XRALJmutk2lj9U1kxYLEMuBYwyhqIVO6i3nd+MIiCWBWDKOMYRCp/zHt7+/+eXtp29tHGJJIJaMYwwhKzcbv/v45uPVbhwBsSQQS8YxhlDUWOvz/If376934wjMx5JALBnHGEIl1vrlh5c3kx1H8ASxZBxjCFXnfXP5+XI12XEETxBLho6TEsSSQSwliCWDWEoQSwaxlCCWDGIpQSwZxFKCWDKIpQSxZBhOV4JYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYgFhgAmKBCYgFJiAWmIBYYAJigQmCWOVjTuuz2XJzoXnACbGmjSDW3U0+z5flshflQ+SlXtmLk3ezRVhixJo24ky2fJnNTm7uV9viJ1uuz7NFPg9d8RCx4JjNVfWrFqv4KeW6RixQsrlcPa5TUMpU/v6EWKDndjablx34uvNe9bEQC1IBscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscCE/wcmYTnZpqsONgAAAABJRU5ErkJggg==" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

## iterate over profiles, subsetting horizon data

# example data
data(sp1)

# promote to SoilProfileCollection
depths(sp1) &lt;- id ~ top + bottom
site(sp1) &lt;- ~ group

# make some fake site data related to a depth of some importance
sp1$dep &lt;- profileApply(sp1, function(i) {round(rnorm(n=1, mean=mean(i$top)))})

# custom function for subsetting horizon data, by profile
# keep horizons with lower boundary &lt; site-level attribute &#39;dep&#39;
fun &lt;- function(i) {
    # extract horizons
    h &lt;- horizons(i)
    # make an expression to subset horizons
    exp &lt;- paste(&#39;bottom &lt; &#39;, i$dep, sep=&#39;&#39;)
    # subset horizons, and write-back into current SPC
    horizons(i) &lt;- subset(h, subset=eval(parse(text=exp)))
    # return modified SPC
    return(i)
}

# list of modified SoilProfileCollection objects
l &lt;- profileApply(sp1, fun, simplify=FALSE)

# re-combine list of SoilProfileCollection objects into a single SoilProfileCollection
sp1.sub &lt;- do.call(rbind, l)

# graphically check
par(mfrow=c(2,1), mar=c(0,0,1,0))
plot(sp1)
points(1:length(sp1), sp1$dep, col=&#39;red&#39;, pch=7)
plot(sp1.sub)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAzFBMVEX9/v0AAAAAAEYAAHMARkYARpoAdL1GAABGAEZGAHNGRgBGRkZGRppGdJpGdL1Gm95zAABzAHNzRnNzRppzdABzdEZzdHNzdL1zm5pzm95zvr1zvt5zvv2aRgCaRkaaRnOadEaadHOadJqam0aam3Oam5qam72am96avpqa372a396a3/29dAC9dEa9dHO9m0a935q93969/r29/t69/v3em0bem3Pem5re35re397e/t7e/v39vnP9vpr935r9/r39/t79/v3/AAD///8kSbHLAAAARHRSTlP//////////////////////////////////////////////////////////////////////////////////////wD//+JIVHIAAAAJcEhZcwAAD2EAAA9hAag/p2kAACAASURBVHic7Z0Ldxu3tUY7dmMlaWpZbm4UN3SVq1y3dimpvQ7ZJvGUFK3//586D/E5eHznDA44I347qbqWVg4OONjCgBgM8LsVIQb87tgVIE8TikVMoFjEBIpFTKBYxASKRUygWMQEikVMoFjEBIpFTKBYxASKRUygWMQEikVMoFjEBIpFTKBYxASKRUyIiLX4crpavjqv/m/z72px9mwqjpo/ny1fTYRB5bNp+Xwmrd9qXrwQ1+/+7Xk4xhW0Tiit4OpG/KmqSxFJ5broX3yK1c8MTKyy0aL9ufjyfayyjqjqt5hYB0FzqAn2ghZffYuJtRu1fFVEdHQERaz3fqoy8pfpvOqgWLtBlViRi25HTKyzoii++NTWcF3P6F+BM+r+baThXEHzWBN0g+7fTm5iYnWjqraOid8NmhcxG52fKnYlnEFlUYQVcV6K4tnXAxWrdWj/Dy4uliOq+mNSpEK6uYOg+YtVVCxnqsjd0BFURu/vzlSLs0hjq1Kprp8dmFj7QwRUrN2oqFeuoOo+GGmEbtDf3xbNX64wFdxwewOsr1Cx9i5g5Pae7FLUHwq4W9uAiVWNh4vz9U9YrN2om7q5kQuzG1R15UXYR2f90B5rL+pGk2oevxW6osLae+sXHwMeBNXX70gdFqcbiA0Ui5hAsYgJFIuYQLGICRSLmECxiAl6sZp5k+Vlwrp42U4X/XsGP1XNWL+MNJeijE0252H5KjBL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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">



##
## helper functions: these must be modified to suit your own data
##

# compute the weighted-mean of some property within a given diagnostic horizon
# note that this requires conditional eval of data that may contain NA
# see ?slab for details on the syntax
# note that function expects certain columns within &#39;x&#39;
f.diag.wt.prop &lt;- function(x, d.hz, prop) {
    # extract diagnostic horizon data
    d &lt;- diagnostic_hz(x)
    # subset to the requested diagnostic hz
    d &lt;- d[d$diag_kind == d.hz, ]
    # if missing return NA
    if(nrow(d) == 0)
        return(NA)

    # extract depths and check for missing
    sv &lt;- c(d$featdept, d$featdepb)
    if(any(is.na(sv)))
        return(NA)

    # create formula from named property
    fm &lt;- as.formula(paste(&#39;~&#39;, prop))
    # return just the (weighted) mean, accessed from @horizons
    s &lt;- slab(x, fm, seg_vect=sv)$p.mean
    return(s)
}


# conditional eval of thickness of some diagnostic feature or horizon
# will return a vector of length(x), you can save to @site
f.diag.thickness &lt;- function(x, d.hz) {
    # extract diagnostic horizon data
    d &lt;- diagnostic_hz(x)
    # subset to the requested diagnostic hz
    d &lt;- d[d$diag_kind == d.hz, ]
    # if missing return NA
    if(nrow(d) == 0)
        return(NA)

    # compute thickness
    thick &lt;- d$featdepb - d$featdept
    return(thick)
}


# conditional eval of property within particle size control section
# makes assumptions about the SPC that is passed-in
f.psc.prop &lt;- function(x, prop) {
  # these are accessed from @site
  sv &lt;- c(x$psctopdepth, x$pscbotdepth)
  # test for missing PCS data
  if(any(is.na(sv)))
    return(NA) 

    # this should never happen... unless someone made a mistake
    # check to make sure that the lower PSC boundary is shallower than the depth
    if(sv[2] &gt; max(x))
        return(NA)

  # create formula from named property
  fm &lt;- as.formula(paste(&#39;~&#39;, prop))
  # return just the (weighted) mean, accessed from @horizons
  s &lt;- slab(x, fm, seg_vect=sv)$p.mean
  return(s)
}

</code></pre>


<hr><div align="center">[Package <em>aqp</em> version 1.5-1 <a href="00Index.html">Index</a>]</div>
</body></html>
