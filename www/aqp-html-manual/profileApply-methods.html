<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Apply a function to soil profiles within a...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for profileApply-methods {aqp}"><tr><td>profileApply-methods {aqp}</td><td align="right">R Documentation</td></tr></table>

<h2>Apply a function to soil profiles within a SoilProfileCollection object.</h2>

<h3>Description</h3>

<p>Apply a function to soil profiles within a SoilProfileCollection object, each iteration has access to a SoilProfileCollection object.</p>


<h3>Usage</h3>

<pre>
# method for SoilProfileCollection objects
profileApply(object, FUN, simplify=TRUE, ...)
</pre>


<h3>Arguments</h3>


<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>a SoilProfileCollection</p>
</td></tr>
<tr valign="top"><td><code>FUN</code></td>
<td>
<p>a function to be applied to each profile within the collection</p>
</td></tr>
<tr valign="top"><td><code>simplify</code></td>
<td>
<p>logical, should the result be simplified to a vector? see examples</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>further arguments passsed to FUN</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When simplify is TRUE, a vector of length <code>nrow(object)</code> (horizon data) or of length <code>length(object)</code> (site data). When simplify is FALSE, a list is returned.</p>


<h3>Methods</h3>



<dl>
<dt><code>signature(object = "SoilProfileCollection")</code></dt><dd></dd>
</dl>


<h3>See Also</h3>

 <p><code><a href="SPC-slab-methods.html">slab</a></code> </p>


<h3>Examples</h3>

<pre><code class="r">
data(sp1)
depths(sp1) &lt;- id ~ top + bottom

# scale properties within each profile
# scaled = (x - mean(x)) / sd(x)
sp1$d &lt;- profileApply(sp1, FUN=function(x) round(scale(x$prop), 2))
plot(sp1, name=&#39;d&#39;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAllBMVEX9/v0AAAAAAEYAAHMARkYARpoAdL1GAABGAEZGAHNGRgBGRkZGdL1Gm95zAABzAHNzRppzdABzdEZzdHNzdJpzdL1zm95zvv2aRgCaRkaaRnOadEaadHOadJqam3Oavpqa396a3/29dAC9dEa9dHO9m0a9vnO9/t69/v3em0be397e/v39vnP935r9/r39/t79/v3///9D2fDkAAAAMnRSTlP///////////////////////////////////////////////////////////////8A/7N2ihAAAAAJcEhZcwAAD2EAAA9hAag/p2kAABmzSURBVHic7Z0Ne9u21UBHu7W3xk7fbkuUdGne2kk6s6Es9f//uQmEJZIWAOLy8pKUdM4TKXmUS5CSjgAQn3/bAhjwt7kvAM4TxAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0yYRKz1bVEUP37flkVxv3153q7//pAXuvlQFDeZqT4WxSr3AjYfAqlGEr0KXGsotMq+1N2Tv4y8C8hM1X1WoQ9geqYRa+fQ89v73V+HP7tPJfRlhULL66fnt4FPKxBaXT1U1095F7D7JkJiHUduPgS+/3DoPums828fMy91965yUy1//B7+wU7OlGJVtSH+ef33/w/nWMehu1dTYr0KLRPfVid0/Y9f4mK1I5/fRjKM49Cg1bFLrVK/rO5nlRSrHboTK/hZTc+URaF/1/v3niwKu6HBQiscWoa/rePQzYfVY7wobEfuBAiLfRzqyrfcSw2/qWBolSzgu++quPrpgsTyDnV/sBGxAqG7X2V2qvHM7VVoebMNihVM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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

# compute depth-wise differencing by profile
# note that our function expects that the column &#39;prop&#39; exists
f &lt;- function(x) { c(x$prop[1], diff(x$prop)) }
sp1$d &lt;- profileApply(sp1, FUN=f)
plot(sp1, name=&#39;d&#39;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAjVBMVEX9/v0AAAAAAEYAAHMARkYARnMARpoAdL1GAABGAEZGAHNGRgBGRkZGdL1Gm95zAABzAHNzRkZzRppzdABzdHNzdL1zm95zvv2aRgCaRkaaRnOadHOadJqam3Oavpqa396a3/29dAC9dEa9dHO9m0a9/v3em0be397e/v39vnP935r9/r39/t79/v3///+n3iD+AAAAL3RSTlP///////////////////////////////////////////////////////////8A/+SDKggAAAAJcEhZcwAAD2EAAA9hAag/p2kAABT2SURBVHic7d2NdtvWsYbhUmkttbUUn7Y2lcTukRQbNSmq9395JcgktoUZekbDbwMg32dluV1eGz8SXwMgCAJ/egIE/jT2CuA0ERYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxJNwlpfLRaLV5+fusXi5um3P5/Wf72LDd3cLhaXwbneLxbL6Apsbo25OjO9MNbVGroKr+r2j/1qxFYgONf+d2X9AtprE9a2occfb7b/88d/29+K9WJZQ7sfPj3+aPy2jKGri7vVD59iK7B9JaywhiM3t8brbw/9fdah5T/dB1d1+1NF59q9+mz/g22uZVirXSH7P9d//be9xRoO3f7tobCeDe0OvFrfDF3/7Z9+WF+PfPzR2WAMh5pVe6u6OvQv69vf1cGwvh66Dcv8XbXXcle4/6l//9kP7gq/HWrutOyhnf1qDYdubpf3/q7w65HbAOywh0P7/Vt0Ve0fyhy6OriD//anWlz8/YzC2jf07T9YJyxj6PZfZXiu/sbt2dDu8skMy5ypuTc0hq4O7LWfz3V9ZQZQnKvzC2ivZVjfHmIcDOvr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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
# compute depth-wise cumulative sum by profile
# note the use of an anonymous function
sp1$d &lt;- profileApply(sp1, FUN=function(x) cumsum(x$prop))
plot(sp1, name=&#39;d&#39;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAllBMVEX9/v0AAAAAAEYAAHMARkYARpoAdL1GAABGAEZGAHNGRgBGRkZGdL1Gm95zAABzAHNzRppzdABzdEZzdHNzdL1zm95zvv2aRgCaRkaaRnOadEaadHOadJqam3Oavpqa396a3/29dAC9dEa9dHO9m0a9vnO9/t69/v3em0be397e/r3e/v39vnP935r9/r39/t79/v3///8HSqAQAAAAMnRSTlP///////////////////////////////////////////////////////////////8A/7N2ihAAAAAJcEhZcwAAD2EAAA9hAag/p2kAABaMSURBVHic7Z2LehNJkkZHZsbMgE2zOyBgG3Z9YcfViyxp3v/lVilBA6oIEenQn1UlnfO13f25ozLLquPMrLz+ZQ0g4C9D3wCcJogFEhALJCAWSEAskIBYIAGxQAJigQTEAgmIBRIQCyQgFkhALJCAWCABsUACYoEExAIJiAUSEAskIBZIQCyQgFggAbFAAmKBBMQCCYgFEhALJCAWSEAskIBYIAGxQAJigQTEAgmIBRIQCyQgFkhALJCAWCABsUACYoEExAIJiAUSEAskIBZIQCyQgFggAbFAAmKBBMQCCYgFEhALJCAWSEAskIBYIAGxQAJigQTEAgmIBRIQCyQgFkhALJCAWCABsUACYoEExAIJiAUSEAskIBZIQCyQgFggAbFAAmKBBMQCCYgFEhALJCAWSEAskIBYIAGxQAJigQTEAgmIBRIQCyQ0Eevx+Ww2+9uXdTebXa+/fl8//v0mFrp6N5tdBlO9nc3m0RtYvTNSdRK9MO7VCl2Eb3XzbXcbsRsIplo+K+sDaE8bsTYOLV9db/715z+bT8V6WFZo9+xh+cr4tIzQxcXN4tlD7AY2T8ISqx+5emc8fzv0W9Kh/Ne3wVvd/FbRVLu/fbH/YJvTUqzF1pDd98e//7ddYvVDNz89JNZeaHfgaf0U+viP//DF+jFy+copMPqhptXerS4O/WX9/FkdFOvH0I1Y5mfVnpZV4e63/va7H6wKfw41Ky07tLOfVj909W5+61eFP0ZuBLDF7oeW+i16q/YvZYYuDlbwP/9Ws4sXZyTWzqGf/2AdsYzQzV9lOFW/cNsL7S7XplhmomZtaIQu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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

# compute profile-means, and save to @site
# there must be some data in @site for this to work
site(sp1) &lt;- ~ group
sp1$mean_prop &lt;- profileApply(sp1, FUN=function(x) mean(x$prop, na.rm=TRUE))

# re-plot using ranks defined by computed summaries (in @site)
plot(sp1, plot.order=rank(sp1$mean_prop))
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAw1BMVEX9/v0AAAAAAEYAAHMARkYARpoAdL1GAABGAEZGAHNGRgBGRkZGRppGdJpGdL1Gm95zAABzAHNzRnNzRppzdABzdEZzdHNzdL1zm5pzm95zvr1zvt5zvv2aRgCaRnOadEaadJqam0aam3Oam5qam72am96avpqa372a396a3/29dAC9dEa9dHO9m0a935q93969/r29/t69/v3em0bem3Pem5re35re397e/t7e/v39vnP9vpr935r9/r39/t79/v3///8BANofAAAAQXRSTlP///////////////////////////////////////////////////////////////////////////////////8A/45z/jgAAAAJcEhZcwAAD2EAAA9hAag/p2kAABfASURBVHic7Z0Le9u4lUAreyt3Nl3LTqbxuKNJM0mb1I90M+JsZ8yVov3/v2r5cKIHL2yAlxcEyXM+j2fqXl5C0hEAgiDwhy2AAX/ouwAwThALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwIYpY67PZbPbHh202my22j7/z2WzuF/rlp6DQpV9o8av6Hx5FvfU+fxl6cuMXul3/SYh0ZfV8VdviLZDKGp84YhVv4eZiUfzr6McrNDtdbS6EN1YK/eODb9bir7enK5/I/MS7qF9+aqrqOv/6TFLQUYBcKKr8qjLxSxCfmGLllSHffvuGFn99Sqz90EIs39CizhTrlmbkM9+B/dDNhaNyk7J+kGss8Q3InhDrIHT93fdTEquus+uP/fH37Mn2ZT/UVb0LoUVTePKfklhCVu+kZav9REu0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Tt7NAjuXQ99WzsSWKd2Ell5jvrxfbe9fF/+simvr9Xm2yOcH/VUP4ollAtWQEulN2Fxtd2IVP6Vc14jVQeiEEN6EcjmdXVNY/xdiIVYYwptQLqez67xXfSzEQqxARjDcYAJiKUEsGcRSglgyiKUEsWQQSwliySCWEsSSQSwliCWDWEoQSwaxlCCWDGIpQSwZxFKCWDKIpQSxZBBLCWLJIJYSxJJBLCWIJYNYShBLBrGUIJYMYilBLBnEUoJYMoilBLFkEEsJYskglhLEkkEsJYglg1hKEEsGsZQglgxiKUEsGcRSglgyiKUEsWQQSwliySCWEsSSQSwliCXD+o9KEEuGGksJYskglhLEkkEsJYglg1hKEEsmoEeOWBKIJdPVtqlj29/SG8SS6Wrb1KMt6KYDYsl0tW3q0RZ00wGxZLraNvVoC7rpgFgyXW2berQF3XRALJmutk2lj9U1kxYLEMuBYwyhqIVO6i3nd+MIiCWBWDKOMYRCp/zHt7+/+eXtp29tHGJJIJaMYwwhKzcbv/v45uPVbhwBsSQQS8YxhlDUWOvz/If376934wjMx5JALBnHGEIl1vrlh5c3kx1H8ASxZBxjCFXnfXP5+XI12XEETxBLho6TEsSSQSwliCWDWEoQSwaxlCCWDGIpQSwZxFKCWDKIpQSxZBhOV4JYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYgFhgAmKBCYgFJiAWmIBYYAJigQmCWOVjTuuz2XJzoXnACbGmjSDW3U0+z5flshflQ+SlXtmLk3ezRVhixJo24ky2fJnNTm7uV9viJ1uuz7NFPg9d8RCx4JjNVfWrFqv4KeW6RixQsrlcPa5TUMpU/v6EWKDndjablx34uvNe9bEQC1IBscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscCE/wcmYTnZpqsONgAAAABJRU5ErkJggg==" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

## iterate over profiles, subsetting horizon data

# example data
data(sp1)

# promote to SoilProfileCollection
depths(sp1) &lt;- id ~ top + bottom
site(sp1) &lt;- ~ group

# make some fake site data related to a depth of some importance
sp1$dep &lt;- profileApply(sp1, function(i) {round(rnorm(n=1, mean=mean(i$top)))})

# custom function for subsetting horizon data, by profile
# keep horizons with lower boundary &lt; site-level attribute &#39;dep&#39;
fun &lt;- function(i) {
    # extract horizons
    h &lt;- horizons(i)
    # make an expression to subset horizons
    exp &lt;- paste(&#39;bottom &lt; &#39;, i$dep, sep=&#39;&#39;)
    # subset horizons, and write-back into current SPC
    horizons(i) &lt;- subset(h, subset=eval(parse(text=exp)))
    # return modified SPC
    return(i)
}

# list of modified SoilProfileCollection objects
l &lt;- profileApply(sp1, fun, simplify=FALSE)

# re-combine list of SoilProfileCollection objects into a single SoilProfileCollection
sp1.sub &lt;- do.call(rbind, l)

# graphically check
par(mfrow=c(2,1), mar=c(0,0,1,0))
plot(sp1)
points(1:length(sp1), sp1$dep, col=&#39;red&#39;, pch=7)
plot(sp1.sub)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAzFBMVEX9/v0AAAAAAEYAAHMARkYARpoAdL1GAABGAEZGAHNGRgBGRkZGRppGdJpGdL1Gm95zAABzAHNzRnNzRppzdABzdEZzdHNzdL1zm5pzm95zvr1zvt5zvv2aRgCaRkaaRnOadEaadHOadJqam0aam3Oam5qam72am96avpqa372a396a3/29dAC9dEa9dHO9m0a935q93969/r29/t69/v3em0bem3Pem5re35re397e/t7e/v39vnP9vpr935r9/r39/t79/v3/AAD///8kSbHLAAAARHRSTlP//////////////////////////////////////////////////////////////////////////////////////wD//+JIVHIAAAAJcEhZcwAAD2EAAA9hAag/p2kAACAASURBVHic7Z0Ldxu3tUY7dmM5aWpZbm4UN3SVq1y3dimpvQ7ZJjFLitH//0+dh/gcPL5zBgczI367qbOWVw4OONjEgBgM8Ls1IQb8ru8KkKcJxSImUCxiAsUiJlAsYgLFIiZQLGICxSImUCxiAsUiJlAsYgLFIiZQLGICxSImUCxiAsUiJlAsYgLFIiZExFq+nK5Xr8/Lf23/WS/Pnk3FUfPns9XriTBo8Wy6eD6T1m89L16I63f/7jwc4wraJJRWcH0j/lTlpYikcl30Lz7H6mcGJtai1qL5c/nyQ6yyjqjybzGxjoLmUBMcBC2//AYTaz9q9bqI6OgIiljv/VSLyDfTedVBsfaDSrEiF92OmFhnRVF88bmp4aae0W+BM+r+XaThXEHzWBO0g+7fTW5iYrWjyraOid8OmhcxG52fKnYlnEGLoggr4rwUxbOvBipW49DhFy4uliOq/DIpUiHd3FHQ/MU6KpYzVeRu6AhaRO/vzlTLs0hjq1Kprp8dmFiHQwRUrP2oqFeuoPI+GGmEdtDf3xX1N1eYCm64gwHWl6hYBxcwcntPdimqDwXcrW3AxCrHw8X55k9YrP2om6q5kQuzH1R25UXYR2f90B7rIOpGk2oevxW6osLae+sXHwMeBVXXr6cOi9MNxAaKRUygWMQEikVMoFjEBIpFTKBYxAS9WPW8yeoyYV287KaL/j2Dn6pmrF9G6kuxiE0252H1OjBL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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">



##
## helper functions: these must be modified to suit your own data
##

# compute the weighted-mean of some property within a given diagnostic horizon
# note that this requires conditional eval of data that may contain NA
# see ?slab for details on the syntax
# note that function expects certain columns within &#39;x&#39;
f.diag.wt.prop &lt;- function(x, d.hz, prop) {
    # extract diagnostic horizon data
    d &lt;- diagnostic_hz(x)
    # subset to the requested diagnostic hz
    d &lt;- d[d$diag_kind == d.hz, ]
    # if missing return NA
    if(nrow(d) == 0)
        return(NA)

    # extract depths and check for missing
    sv &lt;- c(d$featdept, d$featdepb)
    if(any(is.na(sv)))
        return(NA)

    # create formula from named property
    fm &lt;- as.formula(paste(&#39;~&#39;, prop))
    # return just the (weighted) mean, accessed from @horizons
    s &lt;- slab(x, fm, seg_vect=sv)$p.mean
    return(s)
}


# conditional eval of thickness of some diagnostic feature or horizon
# will return a vector of length(x), you can save to @site
f.diag.thickness &lt;- function(x, d.hz) {
    # extract diagnostic horizon data
    d &lt;- diagnostic_hz(x)
    # subset to the requested diagnostic hz
    d &lt;- d[d$diag_kind == d.hz, ]
    # if missing return NA
    if(nrow(d) == 0)
        return(NA)

    # compute thickness
    thick &lt;- d$featdepb - d$featdept
    return(thick)
}


# conditional eval of property within particle size control section
# makes assumptions about the SPC that is passed-in
f.psc.prop &lt;- function(x, prop) {
  # these are accessed from @site
  sv &lt;- c(x$psctopdepth, x$pscbotdepth)
  # test for missing PCS data
  if(any(is.na(sv)))
    return(NA) 

    # this should never happen... unless someone made a mistake
    # check to make sure that the lower PSC boundary is shallower than the depth
    if(sv[2] &gt; max(x))
        return(NA)

  # create formula from named property
  fm &lt;- as.formula(paste(&#39;~&#39;, prop))
  # return just the (weighted) mean, accessed from @horizons
  s &lt;- slab(x, fm, seg_vect=sv)$p.mean
  return(s)
}

</code></pre>


<hr><div align="center">[Package <em>aqp</em> version 1.5-1 <a href="00Index.html">Index</a>]</div>
</body></html>
