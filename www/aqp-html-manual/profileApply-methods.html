<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Apply a function to soil profiles within a...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for profileApply-methods {aqp}"><tr><td>profileApply-methods {aqp}</td><td align="right">R Documentation</td></tr></table>

<h2>Apply a function to soil profiles within a SoilProfileCollection object.</h2>

<h3>Description</h3>

<p>Apply a function to soil profiles within a SoilProfileCollection object, each iteration has access to a SoilProfileCollection object.</p>


<h3>Usage</h3>

<pre>
# method for SoilProfileCollection objects
profileApply(object, FUN, simplify=TRUE, ...)
</pre>


<h3>Arguments</h3>


<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>a SoilProfileCollection</p>
</td></tr>
<tr valign="top"><td><code>FUN</code></td>
<td>
<p>a function to be applied to each profile within the collection</p>
</td></tr>
<tr valign="top"><td><code>simplify</code></td>
<td>
<p>logical, should the result be simplified to a vector? see details</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>further arguments passsed to FUN</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When simplify is TRUE, a vector of length <code>nrow(object)</code> (horizon data) or of length <code>length(object)</code> (site data). When simplify is FALSE, a list is returned.</p>


<h3>Methods</h3>



<dl>
<dt><code>signature(object = "SoilProfileCollection")</code></dt><dd></dd>
</dl>


<h3>See Also</h3>

 <p><code><a href="SPC-slab-methods.html">slab</a></code> </p>


<h3>Examples</h3>

<pre><code class="r">
data(sp1)
depths(sp1) &lt;- id ~ top + bottom

# scale properties within each profile
# scaled = (x - mean(x)) / sd(x)
sp1$d &lt;- profileApply(sp1, FUN=function(x) round(scale(x$prop), 2))
plot(sp1, name=&#39;d&#39;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAllBMVEX9/v0AAAAAAEYAAHMARkYARpoAdL1GAABGAEZGAHNGRgBGRkZGdL1Gm95zAABzAHNzRppzdABzdEZzdHNzdJpzdL1zm95zvv2aRgCaRkaaRnOadEaadHOadJqam3Oavpqa396a3/29dAC9dEa9dHO9m0a9vnO9/t69/v3em0be397e/v39vnP935r9/r39/t79/v3///9D2fDkAAAAMnRSTlP///////////////////////////////////////////////////////////////8A/7N2ihAAAAAJcEhZcwAAD2EAAA9hAag/p2kAABmzSURBVHic7Z0Ne9u21UBHu7W3xk7fbkuUdGne2kk6s6Es9f//uQmEJZIWAOLy8pKUdM4TKXmUS5CSjgAQn3/bAhjwt7kvAM4TxAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0yYRKz1bVEUP37flkVxv3153q7//pAXuvlQFDeZqT4WxSr3AjYfAqlGEr0KXGsotMq+1N2Tv4y8C8hM1X1WoQ9geqYRa+fQ89v73V+HP7tPJfRlhULL66fnt4FPKxBaXT1U1095F7D7JkJiHUduPgS+/3DoPums828fMy91965yUy1//B7+wU7OlGJVtSH+ef33/w/nWMehu1dTYr0KLRPfVid0/Y9f4mK1I5/fRjKM49Cg1bFLrVK/rO5nlRSrHboTK/hZTc+URaF/1/v3niwKu6HBQiscWoa/rePQzYfVY7wobEfuBAiLfRzqyrfcSw2/qWBolSzgu++quPrpgsTyDnV/sBGxAqG7X2V2qvHM7VVoebMNihVM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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

# compute depth-wise differencing by profile
# note that our function expects that the column &#39;prop&#39; exists
f &lt;- function(x) { c(x$prop[1], diff(x$prop)) }
sp1$d &lt;- profileApply(sp1, FUN=f)
plot(sp1, name=&#39;d&#39;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAjVBMVEX9/v0AAAAAAEYAAHMARkYARnMARpoAdL1GAABGAEZGAHNGRgBGRkZGdL1Gm95zAABzAHNzRkZzRppzdABzdHNzdL1zm95zvv2aRgCaRkaaRnOadHOadJqam3Oavpqa396a3/29dAC9dEa9dHO9m0a9/v3em0be397e/v39vnP935r9/r39/t79/v3///+n3iD+AAAAL3RSTlP///////////////////////////////////////////////////////////8A/+SDKggAAAAJcEhZcwAAD2EAAA9hAag/p2kAABT2SURBVHic7d2NdtvWsYbhUmkttbUUn7Y2lcTukRQbNSmq9395JcgktoUZekbDbwMg32dluV1eGz8SXwMgCAJ/egIE/jT2CuA0ERYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxJNwlpfLRaLV5+fusXi5um3P5/Wf72LDd3cLhaXwbneLxbL6Apsbo25OjO9MNbVGroKr+r2j/1qxFYgONf+d2X9AtprE9a2occfb7b/88d/29+K9WJZQ7sfPj3+aPy2jKGri7vVD59iK7B9JaywhiM3t8brbw/9fdah5T/dB1d1+1NF59q9+mz/g22uZVirXSH7P9d//be9xRoO3f7tobCeDe0OvFrfDF3/7Z9+WF+PfPzR2WAMh5pVe6u6OvQv69vf1cGwvh66Dcv8XbXXcle4/6l//9kP7gq/HWrutOyhnf1qDYdubpf3/q7w65HbAOywh0P7/Vt0Ve0fyhy6OriD//anWlz8/YzC2jf07T9YJyxj6PZfZXiu/sbt2dDu8skMy5ypuTc0hq4O7LWfz3V9ZQZQnKvzC2ivZVjfHmIcDOvroU5X1tDtftB8vYZD//92sT/y/f5Mv/O6fnOA9bfwUHufXfyp+nX1dseNtQwr9K5wOPS+T8D/vT5/U2RVaK7AoS3W8zdl0Zl2/uHYYOiw6gMrEJzrmb0rxPkhLEgQFiQICxKEBQnCggRhQYKwIDFuWI9vn1bmJSnFmT5tfo6cfl5fTeRs4vc9/thsVY+zqHZhLQa2L+zl03+eVs9/jOHIRXKmT8bnGsbQwZL9oYkVqA81RnbLx39YZ+qNoakwjLXZL6qfS/f64oP5oUNAw7D++8xiv3EZNjAY+V//JbBnunn/yzCs4dDO2Vpac02sQHyos7k2Rv76qf8vNNRr0F6p4V/tF9Ut19fdzeoyMa9vjB/W0/r6eyO3Q3cjwzNdLYevgpmAPVtj6Havaf7TrYVlbK6dkYmwvKH2Sg3/aj99P4ttXO9mEJaxJ9i+rg93gxfXCGu3f4vP1Pos2BhqLNtegX4zsHlv7oqGQ71dkdWgfSlCZld4/LD2i+r//DiPsIzf6/Z1NS5Rrm+xnoxfrbkZiu8K78NDEw0Ym2tnZKLW6q5wv6jdMdZswwqOzIVVXr419H5pv9Gs7bWcTWZmVasH7+GRSYQVG/pwt/mpepw9bMDZZGp+Knv63PA4wooNTRy8p3aFDX8qe/rc8LhJhmUdkldnWty/JOaaOXhv+VPZ0+eGx00yrOcjcy+Bc9bdPc6vrGqxwfJIwvJ+BdanKsWwnG8TmPs35ySG5IUlLA37V/BgHLzWwrLOunvLH/vITTLT1CegpxrW5qe/D98X1cKyzrp7yz/JsLxPQO3pE2NTxgxrc7v4y/8ZZ3JqYTnfwJpkWM5xfm1VvU9A7enDI5PG3xUeOyzrrLs3dOywnDMT1cNB58cypw+PTBo7LOsUYTWs+Qx1zqXW/g14n4Da04dHJo0dVmhk/yH0yBe4JIYm1lUSlrd8e/rwyKSZhPVwtwofOJWXX/70J7yu8V3hEfba9vS54XEzCevJea8zxbAS6yo5eE85+7DGPszODC2vKydIM0phPb6xL13LfKKi+PDF3Ax560pYEqWw7hMnp8rLLw6trythZRQuWTjZ0w1HmGl8O2xPnxseN5MtVn2mcxrKFiuDsAhLYt5heZcMSPZahJUx77Csy3t2Q7nQz0ZYoaHm5T2yFSCsjJmHFf9ua30FNKfc7Olzw+MmGdbYRyOJSwamucWKfw59XmE9Hzn+Fiv1penyCpQ/J/I+Bzemjw3LI6wJDjXDzn3vI3p9MmFVZzqnoaUt1uZ28epz+FI/wqrONHHVSruwVJfNeJ+DG9MHx6WddVj1L8NrVqAclvc5uDF9bFjeCYYV/yZ04r4w9Z8qsQLlsOIIKz7T+Deh5xRWffn29LnhcacXVuKb0JPdFXKCNKEclrUzMGaa+Cb0nA7e68u3p88Nj5tPWOaZHGsrMKOLTZsu354+NzxuPmFFt1iZb0KXV3X8sLiCtBSWd9Jv7ATGDys+1J4+NzxuJmH1f01YtaH29LnhcYQ1waGElTHBM+9THUpYGYRFWBLmtSCx25w3D0tygnLsyxft6XPD40YNy7kebfywRh5KWBnmryD28CvCOsby7elzw+NGf0hTZGTrU4m1F9Z7ZixhaVgfldnXo818i+U8hJCwRIxfgXM92hS/pZMZGr9up+mq2tPnhsdxukEw1HwIIWGJnE1Y9a8gElaGJqxWR+SJofWvIBJWxtlssepDCStjimHtnkk9PNQ2N0PVI3LCEplgWP1FqQ93w0Nt88CpekROWCITDKvfYhGWxtmHtVr8+Tow1Bp2hBWQ/FQZhFWdqf+R0mrwFHH7Y83ow8YFvwDCOmCiYXWL0MG7NewIKyD5qTIIqzrTOQ0lrAzCGg7lC6tHQFjDoYm7zdSXb0+fGx5HWGMO5aYgR9AqrPXVwn7/NsGPFQnrCFqF1S0370e9hUxqXdkVljXbFd7P5/HRHLwfQSmsxKUo90v7ln5TDCs+8gh3XLIXlRseN5OwEg/wfrjb/BT6tuKBBEY+HIvvNAmrvCsMf0HBPXhXJNAsrCPc1dJeVG543FzCmtPDxstDa2F5e017UeGRSTMJq/4A7zkNre0KvaH2oqIDs2YSlvNFsdETmOLBu7dxsxcVHZg1k7DqM53TUMlZV2f66MAsnmJfHKp4Ayk56+pMP/yr/inFqeM0E1usCQ6VnHV1ph/+i+jff+/j7OfUvb74YL/NPoywJjh03DPv3eLibr877Zbr6+5mdZnYAv7hrMPq7wtjndM/77D6C2v3YfWHatu43s0urH5vHhmpegn6+8JY5/TPO6z+FgH7XWH/58c5huU8BrTdrnB3X5jhWpx3WP02fH+ctjvGmmNYnX2LskxYxTdl62vrnP55h3UcIx9jmZ/UNNti9Rt965w+YdWNfHPbccPqN/rWOf36XGvrSlgZ8ZdgiqcbdjcWNS70Mv+5OJf4jHyfQnv63PC4sz7dkBi6u7GocQ9Ic67cg5SwwkO3UVnPbrWGli/xIayMuX9WuL62nt1qfaRSvsSHsDLmvcXanTWMHefXL/EhrIxWYX05v/fS5fvvM0JbLMEvgLAOSPxeS++f+jdl1pUjY5+cIiyR6q8gPtPdsdBg4zJ2LYQl0iys7ZsywooirPBM+zdl7AqjCCs80/5N2fEP3psOJayMdsdYztCRv95MWCJjh6WZ6wS/TJFCWA1nyhbrCAirNlfCchBWba6E5SCs2lyP8UFRo+Xb0+eGxxFWba7Vj7bNawIJK0MTVvxNWWaurcJyrgkkrAzNxkWiXVjVh/wS1rzCanUu1bkmULN8e/rc8DjCqqmF5VwTyBYrg7DCQwkrg7AkYRXfvRDWRI0eFlsswiIsifix65wQlmPkLVZXvNPl6AjLMW5YzneGZ4SwHOOGNfsNFmF5xg0rfj/yqSIsx6hh2U+snBX7hTUvhyEsjXM63WBeDkNYGucUlnk5DGFpnEtYm9vFq8/W213C0jiXsPq/NS+HKd3q5AhD7elzw+MIq8b+qcyPFNhiaZxTWMWhhJVBWIQlQViEJUFYhCVBWIQlQViEJUFYhCVBWIQlQViEJUFYhCVBWIQlQViEJUFYhCVBWI3Csm5y708fHplEWDUTDMt6LIc/fXRg1hQfhDknEwzLepCQP310YFa7sE4TYTkIq2aCT6Y4t13haZrgFuvcDt5P0wTDyq1/bngcYdUQloOwagjLQVg1hOUgrBrCchBWDWE5CKuGsByEVUNYDsKqISwHYdUQloOwagjLQVg1hOUgrJpTDOvx7e6D7NSH2QOEVTP7sIbX+6yvLneX3nzcXX7T59W9vviwuMnNmLBqZh+W8XfbLVZ/seC/dhcMdsv1dXezukxc47VDWDUnH1Z/Meo2rneE1daJhvVlV7j/f4TV2omG9eXgfXeMRVjNnWJYR0FYNYTlIKyacgPrq+HZIsJCuQHjoTuEhXoD3WL4BDrCQqmB3fOcjOcXExbKDTzcERaGjnDwzq4QQ6Ofbijew4ewJipx7wTOYyEucbcXwkJc4v5UhIU4wnIQVg27Qgdh1XDw7iCsmlanG6zTXcnl24vKDY8jrJpWYT3crS6Ly7cXlRseR1g17U6QWpdBENbJahbW8BPF7PLt6XPD4wirplVYj2/sW7cT1olqFdb9YsEx1jkZ/UNowjpNhOUgrBrCchBWDWE5CKuGsByEVUNYDsKqISwHYdUQloOwagjLQVg1hOUgrBrCchBWDWE5CKuGsByEVTPRsJyrt4zpg+PSCKtmmmH1t2oPrn9wXBph1UwzLLZYsze9sHY33SKsuZteWLu/Jqy5IywHYdVMNKz4+ueGxxFWDWE5CKsmcUc9wkIcWywHYdUQloOwagjLQVg1mQbCh2OEBbZYDsKqISwHYdUQloOwagjLQVg1hOUgrBrCchBWDWE5CKuGsByEVWO9sOX70BIWjBfW+yYDYSGOLZaDsGoIy0FYNYTlIKyaWljOg8IIC7UGnEcbEhZqDTgPYyUsEJaDsGrYFToIq6bWwBEO3uNfP7Onzw2PI6waPit0EFYNYTkIq4awHIRVQ1gOwqohLAdh1ZxiWI9vn9ZXi6XzljWIsGpOMKz+erLVNqn9SbY+r+71xYfFTW7GhFUz+9sYGSu+3WJ1i4u7/ccC3XJ93d2sLs0zuQcQVs0JbrH2V2c8vt2H1X/ktI3rHWG1daJhPdw9vt3vCvs/PxJWcyca1vrq4m5/8L47xiKs5riNkYOwaqwXdvOzcSnMjLZYR0FYNdYLu/qBsAiryHhhN+9/ISzCKjJe2NXSuiqUsJBhXRa6WJhfhW4VVv+Orv9IJrb+oVEvQFg1ZgPjbrEe7laXq+infIQ1UZM8j7Va9h/JxNY/NOoFCKtmimH99pFMbP1Do16AsGomGNbjm0+7j2Ri6x8a9QKEVTPBsO63bx76A/jY+odGvQBh1Wgum1HM1Jk+NzyOsGomuMXKrX9ueBxh1RCWg7BqCMtBWDWE5SCsGsJyEFaN+Vmd/TldKayVcyqdsE6UeXVDeGh8pv9xZktYJ8q8uqG6cZFcPegsKjc8jrBqzBfW/jileIy1vq7N1FlUbngcYdWYl60IwqrP1FlUbngcYdU4F9oFh7acqbOo3PA4wqrhdIODsGoIy0FYNYTlIKya0S+b4a7Jp4ktloOwagjLQVg1hOUgrBrCchBWDWE5CKuGsByEVUNYDsKqISwHYdUQloOwagjLQVg1hOUgrBrCchBWDWE5CKuGsByEVdMyLOuqd8I6UQ3D6h/3Vlm+vajc8DjCqmGL5SCsmkZhbW4Xrz4T1hlhi+UgrBrCchBWjf3CmveG4XQD4uwX1rw3DGEhznlhrXvDEBbinDdw1r1hCAtx9gtr3huGsBDnnSSPHbzvn+cdnGli+Yn1zw2PI6yaWgPd0nw4PGGh1sCvn8xnGxIWCMtBWDXsCh2EVVNrgIN3OLiC1EFYNYTlIKwaTVg8CPPsscVyEFYNYTkIq4awHIRV0/RbOsa5CcI6UQ3DMp8rR1gnqmFY5uPqCOtEtfz6l/VtigOX7Wx+Np9w+Gz6yA/5EoRV03CLlbh68OFudek9OvPZ9N8f8jKEVdP04D2xK1wtN+9/Iaz5mt7pht+/NL1aWlfkDKb//pCXIaya6YXV/+3jm0/bY/2FcRORwfTDv+q3jP1lF86lF0GEVTPNsO53Ub1wi9UfoPUXin3cXSzW59W9vviwuPn+zL5GWDWjP1Yu3uD3FvXlL3d70V//tbu8tVuur7ub1aV5ReIBhNVMtQHJTK3h2wO0L2H1m71tXO8Ia7LmEtbuAO2PXeH+/xHWhM0lrP4A7cvB++4Yi7CmbC5hHQdhNUNYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCROIGkImZEtbZY4sFCcKCBGFBgrAgoQmr+I6AsObPCKv2VBFnprnpa4v3EVYzRgPdMnuX68BMc9OXln4AYTVjNPDbkx+OO9Pc9KWlH0BYzRAWJNgVQoKDd0hwHgsSrcIynx3tTn+EdTARVjOtwto9wj48/RHWwURYzbTbFa7iB26ENX/Nrsd6fJuY/gjrYCKsebPear5JnBojLJiMsPaPsI9Or1oxwpo3TjdAgrAgQViQICxIEBYkCAsShAUJvkyBSSIsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoKEEVb/Ff311WJZu2MJYZ03I6z+K/r9d6n391jq8+peX3xY3ORmTFjnzbyQa7XsFhd3+7vCdcv1dXezuszeyIuw8NzuK/qPb/dh9Xcc3Mb1jrBQ1H9F/+Hu8e1+V9j/+ZGwUNd/Rb8/gN8fvO+OsQgLU0FYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAWJ/wGlByXopf0M/AAAAABJRU5ErkJggg==" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
# compute depth-wise cumulative sum by profile
# note the use of an anonymous function
sp1$d &lt;- profileApply(sp1, FUN=function(x) cumsum(x$prop))
plot(sp1, name=&#39;d&#39;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAllBMVEX9/v0AAAAAAEYAAHMARkYARpoAdL1GAABGAEZGAHNGRgBGRkZGdL1Gm95zAABzAHNzRppzdABzdEZzdHNzdL1zm95zvv2aRgCaRkaaRnOadEaadHOadJqam3Oavpqa396a3/29dAC9dEa9dHO9m0a9vnO9/t69/v3em0be397e/r3e/v39vnP935r9/r39/t79/v3///8HSqAQAAAAMnRSTlP///////////////////////////////////////////////////////////////8A/7N2ihAAAAAJcEhZcwAAD2EAAA9hAag/p2kAABaMSURBVHic7Z2LehNJkkZHZsbMgE2zOyBgG3Z9YcfViyxp3v/lVilBA6oIEenQn1UlnfO13f25ozLLquPMrLz+ZQ0g4C9D3wCcJogFEhALJCAWSEAskIBYIAGxQAJigQTEAgmIBRIQCyQgFkhALJCAWCABsUACYoEExAIJiAUSEAskIBZIQCyQgFggAbFAAmKBBMQCCYgFEhALJCAWSEAskIBYIAGxQAJigQTEAgmIBRIQCyQgFkhALJCAWCABsUACYoEExAIJiAUSEAskIBZIQCyQgFggAbFAAmKBBMQCCYgFEhALJCAWSEAskIBYIAGxQAJigQTEAgmIBRIQCyQgFkhALJCAWCABsUACYoEExAIJiAUSEAskIBZIQCyQgFggAbFAAmKBBMQCCYgFEhALJCAWSEAskIBYIAGxQAJigQTEAgmIBRIQCyQ0Eevx+Ww2+9uXdTebXa+/fl8//v0mFrp6N5tdBlO9nc3m0RtYvTNSdRK9MO7VCl2Eb3XzbXcbsRsIplo+K+sDaE8bsTYOLV9db/715z+bT8V6WFZo9+xh+cr4tIzQxcXN4tlD7AY2T8ISqx+5emc8fzv0W9Kh/Ne3wVvd/FbRVLu/fbH/YJvTUqzF1pDd98e//7ddYvVDNz89JNZeaHfgaf0U+viP//DF+jFy+copMPqhptXerS4O/WX9/FkdFOvH0I1Y5mfVnpZV4e63/va7H6wKfw41Ky07tLOfVj909W5+61eFP0ZuBLDF7oeW+i16q/YvZYYuDlbwP/9Ws4sXZyTWzqGf/2AdsYzQzV9lOFW/cNsL7S7XplhmomZtaIQu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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

# compute profile-means, and save to @site
# there must be some data in @site for this to work
site(sp1) &lt;- ~ group
sp1$mean_prop &lt;- profileApply(sp1, FUN=function(x) mean(x$prop, na.rm=TRUE))

# re-plot using ranks defined by computed summaries (in @site)
plot(sp1, plot.order=rank(sp1$mean_prop))
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAw1BMVEX9/v0AAAAAAEYAAHMARkYARpoAdL1GAABGAEZGAHNGRgBGRkZGRppGdJpGdL1Gm95zAABzAHNzRnNzRppzdABzdEZzdHNzdL1zm5pzm95zvr1zvt5zvv2aRgCaRnOadEaadJqam0aam3Oam5qam72am96avpqa372a396a3/29dAC9dEa9dHO9m0a935q93969/r29/t69/v3em0bem3Pem5re35re397e/t7e/v39vnP9vpr935r9/r39/t79/v3///8BANofAAAAQXRSTlP///////////////////////////////////////////////////////////////////////////////////8A/45z/jgAAAAJcEhZcwAAD2EAAA9hAag/p2kAABfASURBVHic7Z0Le9u4lUAreyt3Nl3LTqbxuKNJM0mb1I90M+JsZ8yVov3/v2r5cKIHL2yAlxcEyXM+j2fqXl5C0hEAgiDwhy2AAX/ouwAwThALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwIYpY67PZbPbHh202my22j7/z2WzuF/rlp6DQpV9o8av6Hx5FvfU+fxl6cuMXul3/SYh0ZfV8VdviLZDKGp84YhVv4eZiUfzr6McrNDtdbS6EN1YK/eODb9bir7enK5/I/MS7qF9+aqrqOv/6TFLQUYBcKKr8qjLxSxCfmGLllSHffvuGFn99Sqz90EIs39CizhTrlmbkM9+B/dDNhaNyk7J+kGss8Q3InhDrIHT93fdTEquus+uP/fH37Mn2ZT/UVb0LoUVTePKfklhCVu+kZav9REu0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Tt7NAjuXQ99WzsSWKd2Ell5jvrxfbe9fF/+simvr9Xm2yOcH/VUP4ollAtWQEulN2Fxtd2IVP6Vc14jVQeiEEN6EcjmdXVNY/xdiIVYYwptQLqez67xXfSzEQqxARjDcYAJiKUEsGcRSglgyiKUEsWQQSwliySCWEsSSQSwliCWDWEoQSwaxlCCWDGIpQSwZxFKCWDKIpQSxZBBLCWLJIJYSxJJBLCWIJYNYShBLBrGUIJYMYilBLBnEUoJYMoilBLFkEEsJYskglhLEkkEsJYglg1hKEEsGsZQglgxiKUEsGcRSglgyiKUEsWQQSwliySCWEsSSQSwliCXD+o9KEEuGGksJYskglhLEkkEsJYglg1hKEEsmoEeOWBKIJdPVtqlj29/SG8SS6Wrb1KMt6KYDYsl0tW3q0RZ00wGxZLraNvVoC7rpgFgyXW2berQF3XRALJmutk2lj9U1kxYLEMuBYwyhqIVO6i3nd+MIiCWBWDKOMYRCp/zHt7+/+eXtp29tHGJJIJaMYwwhKzcbv/v45uPVbhwBsSQQS8YxhlDUWOvz/If376934wjMx5JALBnHGEIl1vrlh5c3kx1H8ASxZBxjCFXnfXP5+XI12XEETxBLho6TEsSSQSwliCWDWEoQSwaxlCCWDGIpQSwZxFKCWDKIpQSxZBhOV4JYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYgFhgAmKBCYgFJiAWmIBYYAJigQmCWOVjTuuz2XJzoXnACbGmjSDW3U0+z5flshflQ+SlXtmLk3ezRVhixJo24ky2fJnNTm7uV9viJ1uuz7NFPg9d8RCx4JjNVfWrFqv4KeW6RixQsrlcPa5TUMpU/v6EWKDndjablx34uvNe9bEQC1IBscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscCE/wcmYTnZpqsONgAAAABJRU5ErkJggg==" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

## iterate over profiles, subsetting horizon data

# example data
data(sp1)

# promote to SoilProfileCollection
depths(sp1) &lt;- id ~ top + bottom
site(sp1) &lt;- ~ group

# make some fake site data related to a depth of some importance
sp1$dep &lt;- profileApply(sp1, function(i) {round(rnorm(n=1, mean=mean(i$top)))})

# custom function for subsetting horizon data, by profile
# keep horizons with lower boundary &lt; site-level attribute &#39;dep&#39;
fun &lt;- function(i) {
    # extract horizons
    h &lt;- horizons(i)
    # make an expression to subset horizons
    exp &lt;- paste(&#39;bottom &lt; &#39;, i$dep, sep=&#39;&#39;)
    # subset horizons, and write-back into current SPC
    horizons(i) &lt;- subset(h, subset=eval(parse(text=exp)))
    # return modified SPC
    return(i)
}

# list of modified SoilProfileCollection objects
l &lt;- profileApply(sp1, fun, simplify=FALSE)

# re-combine list of SoilProfileCollection objects into a single SoilProfileCollection
sp1.sub &lt;- do.call(rbind, l)

# graphically check
par(mfrow=c(2,1), mar=c(0,0,1,0))
plot(sp1)
points(1:length(sp1), sp1$dep, col=&#39;red&#39;, pch=7)
plot(sp1.sub)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAzFBMVEX9/v0AAAAAAEYAAHMARkYARpoAdL1GAABGAEZGAHNGRgBGRkZGRppGdJpGdL1Gm95zAABzAHNzRnNzRppzdABzdEZzdHNzdL1zm5pzm95zvr1zvt5zvv2aRgCaRkaaRnOadEaadHOadJqam0aam3Oam5qam72am96avpqa372a396a3/29dAC9dEa9dHO9m0a935q93969/r29/t69/v3em0bem3Pem5re35re397e/t7e/v39vnP9vpr935r9/r39/t79/v3/AAD///8kSbHLAAAARHRSTlP//////////////////////////////////////////////////////////////////////////////////////wD//+JIVHIAAAAJcEhZcwAAD2EAAA9hAag/p2kAACAASURBVHic7Z0Ldxu3tUY7dmMlaWpZbm4UN3SVq1y3dimpvQ7ZJvGUFK3//586D/E5eHznDA44I347qbqWVg4OONjCgBgM8LsVIQb87tgVIE8TikVMoFjEBIpFTKBYxASKRUygWMQEikVMoFjEBIpFTKBYxASKRUygWMQEikVMoFjEBIpFTKBYxASKRUyIiLX4crpavjqv/m/z72px9mwqjpo/ny1fTYRB5bNp+Xwmrd9qXrwQ1+/+7Xk4xhW0Tiit4OpG/KmqSxFJ5broX3yK1c8MTKyy0aL9ufjyfayyjqjqt5hYB0FzqAn2ghZffYuJtRu1fFVEdHQERaz3fqoy8pfpvOqgWLtBlViRi25HTKyzoii++NTWcF3P6F+BM+r+baThXEHzWBN0g+7fTm5iYnWjqraOid8NmhcxG52fKnYlnEFlUYQVcV6K4tnXAxWrdWj/Dy4uliOq+mNSpEK6uYOg+YtVVCxnqsjd0BFURu/vzlSLs0hjq1Kprp8dmFj7QwRUrN2oqFeuoOo+GGmEbtDf3xbNX64wFdxwewOsr1Cx9i5g5Pae7FLUHwq4W9uAiVWNh4vz9U9YrN2om7q5kQuzG1R15UXYR2f90B5rL+pGk2oevxW6osLae+sXHwMeBNXX70gdFqcbiA0Ui5hAsYgJFIuYQLGICRSLmECxiAl6sZp5k+Vlwrp42U4X/XsGP1XNWL+MNJeijE0252H5KjBL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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">



##
## helper functions: these must be modified to suit your own data
##

# compute the weighted-mean of some property within a given diagnostic horizon
# note that this requires conditional eval of data that may contain NA
# see ?slab for details on the syntax
# note that function expects certain columns within &#39;x&#39;
f.diag.wt.prop &lt;- function(x, d.hz, prop) {
    # extract diagnostic horizon data
    d &lt;- diagnostic_hz(x)
    # subset to the requested diagnostic hz
    d &lt;- d[d$diag_kind == d.hz, ]
    # if missing return NA
    if(nrow(d) == 0)
        return(NA)

    # extract depths and check for missing
    sv &lt;- c(d$featdept, d$featdepb)
    if(any(is.na(sv)))
        return(NA)

    # create formula from named property
    fm &lt;- as.formula(paste(&#39;~&#39;, prop))
    # return just the (weighted) mean, accessed from @horizons
    s &lt;- slab(x, fm, seg_vect=sv)$p.mean
    return(s)
}


# conditional eval of thickness of some diagnostic feature or horizon
# will return a vector of length(x), you can save to @site
f.diag.thickness &lt;- function(x, d.hz) {
    # extract diagnostic horizon data
    d &lt;- diagnostic_hz(x)
    # subset to the requested diagnostic hz
    d &lt;- d[d$diag_kind == d.hz, ]
    # if missing return NA
    if(nrow(d) == 0)
        return(NA)

    # compute thickness
    thick &lt;- d$featdepb - d$featdept
    return(thick)
}


# conditional eval of property within particle size control section
# makes assumptions about the SPC that is passed-in
f.psc.prop &lt;- function(x, prop) {
  # these are accessed from @site
  sv &lt;- c(x$psctopdepth, x$pscbotdepth)
  # test for missing PCS data
  if(any(is.na(sv)))
    return(NA) 

    # this should never happen... unless someone made a mistake
    # check to make sure that the lower PSC boundary is shallower than the depth
    if(sv[2] &gt; max(x))
        return(NA)

  # create formula from named property
  fm &lt;- as.formula(paste(&#39;~&#39;, prop))
  # return just the (weighted) mean, accessed from @horizons
  s &lt;- slab(x, fm, seg_vect=sv)$p.mean
  return(s)
}

</code></pre>


<hr><div align="center">[Package <em>aqp</em> version 1.5 <a href="00Index.html">Index</a>]</div>
</body></html>
