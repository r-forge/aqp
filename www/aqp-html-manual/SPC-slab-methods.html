<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Slab-Wise Aggregation of SoilProfileCollection Objects</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for slab-methods {aqp}"><tr><td>slab-methods {aqp}</td><td align="right">R Documentation</td></tr></table>

<h2>Slab-Wise Aggregation of SoilProfileCollection Objects</h2>

<h3>Description</h3>

<p>Aggregate soil properties along user-defined 'slabs', and optionally within groups.</p>


<h3>Usage</h3>

<pre>
# method for SoilProfileCollection objects
slab(object, fm, slab.structure=1, strict=FALSE, slab.fun=.slab.fun.numeric.default, cpm=1, ...)
</pre>


<h3>Arguments</h3>


<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>a SoilProfileCollection</p>
</td></tr>
<tr valign="top"><td><code>fm</code></td>
<td>
<p>A formula: either &lsquo;groups ~ var1 + var2 + var3&rsquo; where named variables are aggregated within &lsquo;groups&rsquo; OR where named variables are aggregated across the entire collection &lsquo; ~ var1 + var2 + var3&rsquo;</p>
</td></tr>
<tr valign="top"><td><code>slab.structure</code></td>
<td>
<p>A user-defined slab thickness (defined by an integer), or user-defined structure (numeric vector). See details below.</p>
</td></tr>
<tr valign="top"><td><code>strict</code></td>
<td>
<p>logical: should horizons be strictly checked for self-consistency?</p>
</td></tr>
<tr valign="top"><td><code>slab.fun</code></td>
<td>
<p>Function used to process each 'slab' of data, ideally returning a vector with names attribute. Defaults to a wrapper function around <code>hdquantile</code>. See details.</p>
</td></tr>
<tr valign="top"><td><code>cpm</code></td>
<td>
<p>Strategy for normalizing slice-wise probabilities, dividing by either: number of profiles with data at the current slice (cpm=1), or by the number of profiles in the collection (cpm=2). Mode 2 values will always sum to the contributing fraction, while mode 1 values will always sum to 1.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>further arguments passsed to <code>slab.fun</code></p>
</td></tr>
</table>


<h3>Details</h3>


<p>Multiple continuous variables OR a single categorical (factor) variable can be aggregated within a call to <code>slab</code>. Basic error checking is performed to make sure that top and bottom horizon boundaries make sense. User-defined aggregate functions (<code>slab.fun</code>) should return a named vector of results. A new, named column will appear in the results of <code>slab</code> for every named element of a vector returned by <code>slab.fun</code>. See examples below for a simple example of a slab function that computes mean, mean-1SD and mean+1SD. The default slab function wraps <code><a href="../../Hmisc/html/hdquantile.html">hdquantile</a></code> from the Hmisc package.
</p>
<p>Execution time scales linearly (slower) with the total number of profiles in <code>object</code>, and exponentially (faster) as the number of profiles / group is increased.
</p>
<p>There are several possible ways to define slabs, using <code>slab.structure</code>:
</p>

<dl>
<dt>a single integer</dt><dd><p>e.g. 10: data are aggregated over a regular sequence of 10-unit thickness slabs</p>
</dd>
<dt>a vector of 2 integers</dt><dd><p>e.g. c(50, 60): data are aggregated over depths spanning 50&ndash;60 units</p>
</dd>
<dt>a vector of 3 or more integers</dt><dd><p>e.g. c(0, 5, 10, 50, 100): data are aggregated over the depths spanning 0&ndash;5, 5&ndash;10, 10&ndash;50, 50&ndash;100 units</p>
</dd>
</dl>
 


<h3>Value</h3>


<p>Output is returned in long format, such that slice-wise aggregates are returned once for each combination of grouping level (optional), variable described in the <code>fm</code> argument, and depth-wise 'slab'.
</p>
<p>Aggregation of numeric variables, using the default slab function:
</p>

<dl>
<dt>variable</dt><dd><p>The names of variables included in the call to <code>slab</code>.</p>
</dd>
<dt>groupname</dt><dd><p>The name of the grouping variable when provided, otherwise a fake grouping variable named 'all.profiles'.</p>
</dd>
<dt>p.q5</dt><dd><p>The slice-wise 5th percentile.</p>
</dd>
<dt>p.q25</dt><dd><p>The slice-wise 25th percentile</p>
</dd>
<dt>p.q50</dt><dd><p>The slice-wise 50th percentile (median)</p>
</dd>
<dt>p.q75</dt><dd><p>The slice-wise 75th percentile</p>
</dd>
<dt>p.q95</dt><dd><p>The slice-wise 95th percentile</p>
</dd>
<dt>top</dt><dd><p>The slab top boundary.</p>
</dd>
<dt>bottom</dt><dd><p>The slab bottom boundary.</p>
</dd>
<dt>contributing_fraction</dt><dd><p>The fraction of profiles contributing to the aggregate value, ranges from 1/n_profiles to 1.</p>
</dd>
</dl>

<p>When a single factor variable is used, slice-wise probabilities for each level of that factor are returned as:
</p>

<dl>
<dt>variable</dt><dd><p>The names of variables included in the call to <code>slab</code>.</p>
</dd>
<dt>groupname</dt><dd><p>The name of the grouping variable when provided, otherwise a fake grouping variable named 'all.profiles'.</p>
</dd>
<dt>A</dt><dd><p>The slice-wise probability of level A</p>
</dd>
<dt>B</dt><dd><p>The slice-wise probability of level B</p>
</dd>
<dt>...</dt><dd></dd>
<dt>n</dt><dd><p>The slice-wise probability of level n</p>
</dd>
<dt>top</dt><dd><p>The slab top boundary.</p>
</dd>
<dt>bottom</dt><dd><p>The slab bottom boundary.</p>
</dd>
<dt>contributing_fraction</dt><dd><p>The fraction of profiles contributing to the aggregate value, ranges from 1/n_profiles to 1.</p>
</dd>
</dl>



<h3>Methods</h3>



<dl>
<dt>data = &quot;SoilProfileCollection&quot;</dt><dd><p>Typical usage, where input is a <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code>.</p>
</dd>
</dl>



<h3>Note</h3>

<p>Arguments to <code>slab</code> have changed with <code>aqp</code> 1.5 (2012-12-29) as part of a code clean-up and optimization. Calculation of weighted-summaries was broken in <code>aqp</code> 1.2-6 (2012-06-26), and removed as of <code>aqp</code> 1.5 (2012-12-29).  <code>slab</code> replaced the previously defined <code>soil.slot.multiple</code> function as of <code>aqp</code> 0.98-8.58 (2011-12-21).</p>


<h3>Author(s)</h3>

<p>Dylan E Beaudette</p>


<h3>References</h3>


<p>D.E. Beaudette, P. Roudier, A.T. O'Geen, Algorithms for quantitative pedology: A toolkit for soil scientists, Computers &amp; Geosciences, Volume 52, March 2013, Pages 258-268, 10.1016/j.cageo.2012.10.020.
</p>
<p>Harrell FE, Davis CE (1982): A new distribution-free quantile estimator. Biometrika 69:635-640.
</p>


<h3>See Also</h3>


<p><code><a href="SPC-slice-methods.html">slice</a>, <a href="../../Hmisc/html/hdquantile.html">hdquantile</a></code>
</p>


<h3>Examples</h3>

<pre><code class="r">
##
## basic examples
##
library(lattice)
library(grid)

# load sample data, upgrade to SoilProfileCollection
data(sp1)
depths(sp1) &lt;- id ~ top + bottom

# aggregate entire collection with two different segment sizes
a &lt;- slab(sp1, fm = ~ prop)
b &lt;- slab(sp1, fm = ~ prop, slab.structure=5)

# check output
str(a)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    240 obs. of  10 variables:
##  $ variable             : Factor w/ 1 level &quot;prop&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ all.profiles         : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ p.q5                 : num  0.0083 0.0083 0.0332 0.1541 0.1541 ...
##  $ p.q25                : num  0.474 0.474 0.771 1.552 1.552 ...
##  $ p.q50                : num  3.44 3.44 3.52 4.53 4.53 ...
##  $ p.q75                : num  9.52 9.52 8.34 8.51 8.51 ...
##  $ p.q95                : num  13.7 13.7 16.6 16.6 16.6 ...
##  $ top                  : int  0 1 2 3 4 5 6 7 8 9 ...
##  $ bottom               : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ contributing_fraction: num  1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">
# stack into long format
ab &lt;- make.groups(a, b)
ab$which &lt;- factor(ab$which, levels=c(&#39;a&#39;,&#39;b&#39;), 
labels=c(&#39;1-cm Interval&#39;, &#39;5-cm Interval&#39;))

# plot median and IQR
# custom plotting function for uncertainty viz.
xyplot(top ~ p.q50 | which, data=ab, ylab=&#39;Depth&#39;,
             xlab=&#39;median bounded by 25th and 75th percentiles&#39;,
             lower=ab$p.q25, upper=ab$p.q75, ylim=c(250,-5),
             panel=panel.depth_function, 
             prepanel=prepanel.depth_function,
             cf=ab$contributing_fraction,
             layout=c(2,1), scales=list(x=list(alternating=1))
             )
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

##
## categorical variable example
##
library(reshape)

# normalize horizon names: result is a factor
sp1$name &lt;- generalize.hz(sp1$name, 
new=c(&#39;O&#39;,&#39;A&#39;,&#39;B&#39;,&#39;C&#39;), 
pat=c(&#39;O&#39;, &#39;^A&#39;,&#39;^B&#39;,&#39;C&#39;))

# compute slice-wise probability so that it sums to contributing fraction, from 0-150
a &lt;- slab(sp1, fm= ~ name, cpm=1, slab.structure=0:150)

# reshape into long format for plotting
a.long &lt;- melt(a, id.vars=c(&#39;top&#39;,&#39;bottom&#39;), measure.vars=c(&#39;O&#39;,&#39;A&#39;,&#39;B&#39;,&#39;C&#39;))

# plot horizon type proportions using panels
xyplot(top ~ value | variable, data=a.long, subset=value &gt; 0,
             ylim=c(150, -5), type=c(&#39;S&#39;,&#39;g&#39;), horizontal=TRUE, layout=c(4,1), col=1 )
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
# again, this time using groups
xyplot(top ~ value, data=a.long, groups=variable, subset=value &gt; 0,
             ylim=c(150, -5), type=c(&#39;S&#39;,&#39;g&#39;), horizontal=TRUE, asp=2)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
# adjust probability to size of collection, from 0-150
a.1 &lt;- slab(sp1, fm= ~ name, cpm=2, slab.structure=0:150)

# reshape into long format for plotting
a.1.long &lt;- melt(a.1, id.vars=c(&#39;top&#39;,&#39;bottom&#39;), measure.vars=c(&#39;O&#39;,&#39;A&#39;,&#39;B&#39;,&#39;C&#39;))

# group mode 1 and mode 2 data
g &lt;- make.groups(mode_1=a.long, mode_2=a.1.long)

# plot horizon type proportions
xyplot(top ~ value | variable, groups=which, data=g, subset=value &gt; 0,
             ylim=c(240, -5), type=c(&#39;S&#39;,&#39;g&#39;), horizontal=TRUE, layout=c(4,1), 
             auto.key=list(lines=TRUE, points=FALSE, columns=2),
             par.settings=list(superpose.line=list(col=c(1,2))))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

# apply slice-wise evaluation of max probability, and assign ML-horizon at each slice
(gen.hz.ml &lt;- get.ml.hz(a, c(&#39;O&#39;,&#39;A&#39;,&#39;B&#39;,&#39;C&#39;)))
</code></pre>

<pre><code>##   hz top bottom confidence
## 4  O   0      1         28
## 1  A   1     31         75
## 2  B  31    144         57
## 3  C 144    149         67
</code></pre>

<pre><code class="r">

##
## multivariate examples
##
data(sp3)

# add new grouping factor
sp3$group &lt;- &#39;group 1&#39;
</code></pre>

<pre><code>## Error: length of replacement must equal number of sites or number of
## horizons
</code></pre>

<pre><code class="r">sp3$group[as.numeric(sp3$id) &gt; 5] &lt;- &#39;group 2&#39;
sp3$group &lt;- factor(sp3$group)

# upgrade to SPC
depths(sp3) &lt;- id ~ top + bottom
site(sp3) &lt;- ~ group

# custom &#39;slab&#39; function, returning mean +/- 1SD
mean.and.sd &lt;- function(values) {
    m &lt;- mean(values, na.rm=TRUE)
    s &lt;- sd(values, na.rm=TRUE)
    upper &lt;- m + s
    lower &lt;- m - s
    res &lt;- c(mean=m, lower=lower, upper=upper)
    return(res)
    }

# aggregate several variables at once, within &#39;group&#39;
a &lt;- slab(sp3, fm=group ~ L + A + B, slab.fun=mean.and.sd)

# check the results:
# note that &#39;group&#39; is the column containing group labels
library(lattice)
xyplot(
top ~ mean | variable, data=a, groups=group, subscripts=TRUE, 
lower=a$lower, upper=a$upper, ylim=c(125,-5),
layout=c(3,1), scales=list(x=list(relation=&#39;free&#39;)),
panel=panel.depth_function, 
prepanel=prepanel.depth_function,
auto.key=list(columns=2, lines=TRUE, points=FALSE)
)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

# compare a single profile to the group-level aggregate values
a.1 &lt;- slab(sp3[1, ], fm=group ~ L + A + B, slab.fun=mean.and.sd)

# manually update the group column
a.1$group &lt;- &#39;profile 1&#39;
</code></pre>

<pre><code>## Error: replacement has 1 rows, data has 0
</code></pre>

<pre><code class="r">
# combine into a single data.frame:
g &lt;- rbind(a, a.1)

# plot with customized line styles
xyplot(
    top ~ mean | variable, data=g, groups=group, subscripts=TRUE, 
    lower=a$lower, upper=a$upper, ylim=c(125,-5),
    layout=c(3,1), scales=list(x=list(relation=&#39;free&#39;)),
    panel=panel.depth_function, 
    prepanel=prepanel.depth_function,
    sync.colors=TRUE, alpha=0.25,
    par.settings=list(superpose.line=list(col=c(&#39;orange&#39;, &#39;royalblue&#39;, &#39;black&#39;), lwd=2, lty=c(1,1,2))),
    auto.key=list(columns=3, lines=TRUE, points=FALSE)
)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">


## convert mean value for each variable into long format
library(reshape)

# note that depths are no longer in order 
a.wide &lt;- cast(a, group + top + bottom ~ variable, value=c(&#39;mean&#39;))

## again, this time for a user-defined slab from 40-60 cm
a &lt;- slab(sp3, fm=group ~ L + A + B, slab.structure=c(40,60), slab.fun=mean.and.sd)

# now we have weighted average properties (within the defined slab) for each variable, and each group
(a.wide &lt;- cast(a, group + top + bottom ~ variable, value=c(&#39;mean&#39;)))
</code></pre>

<pre><code>##     group top bottom     L     A    B
## 1 group 2  40     60 50.05 6.839 11.6
</code></pre>

<pre><code class="r">
## this time, compute the weighted mean of selected properties, by profile ID
a &lt;- slab(sp3, fm= id ~ L + A + B, slab.structure=c(40,60), slab.fun=mean.and.sd)
(a.wide &lt;- cast(a, id + top + bottom ~ variable, value=c(&#39;mean&#39;)))
</code></pre>

<pre><code>##    id top bottom     L      A      B
## 1   1  40     60 48.55 10.353 17.307
## 2  10  40     60 54.97  8.651 14.715
## 3   2  40     60 40.15 13.805 15.217
## 4   3  40     60 43.64 15.008 17.511
## 5   4  40     60 43.49 13.704 16.814
## 6   5  40     60 50.72 17.734 21.595
## 7   6  40     60 52.93  8.209 14.902
## 8   7  40     60 44.17  5.114  8.414
## 9   8  40     60 45.74  5.902  8.772
## 10  9  40     60 52.43  6.320 11.197
</code></pre>

<pre><code class="r">

## aggregate the entire collection, using default slab function (hdquantile)
## note the missing left-hand side of the formula
a &lt;- slab(sp3, fm= ~ L + A + B)

</code></pre>


<hr><div align="center">[Package <em>aqp</em> version 1.4-7 <a href="00Index.html">Index</a>]</div>
</body></html>
