<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Slab-Wise Aggregation of SoilProfileCollection Objects</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/languages/r.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for slab-methods {aqp}"><tr><td>slab-methods {aqp}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Slab-Wise Aggregation of SoilProfileCollection Objects</h2>

<h3>Description</h3>

<p>Aggregate soil properties along user-defined 'slabs', and optionally within groups.</p>


<h3>Usage</h3>

<pre>
# method for SoilProfileCollection objects
slab(object, fm, slab.structure=1, strict=FALSE, 
slab.fun=.slab.fun.numeric.default, cpm=1, weights=NULL, ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>a SoilProfileCollection</p>
</td></tr>
<tr valign="top"><td><code>fm</code></td>
<td>
<p>A formula: either &lsquo;groups ~ var1 + var2 + var3&rsquo; where named variables are aggregated within &lsquo;groups&rsquo; OR where named variables are aggregated across the entire collection &lsquo; ~ var1 + var2 + var3&rsquo;. If 'groups' is a factor it must not contain NA.</p>
</td></tr>
<tr valign="top"><td><code>slab.structure</code></td>
<td>
<p>A user-defined slab thickness (defined by an integer), or user-defined structure (numeric vector). See details below.</p>
</td></tr>
<tr valign="top"><td><code>strict</code></td>
<td>
<p>logical: should horizons be strictly checked for self-consistency?</p>
</td></tr>
<tr valign="top"><td><code>slab.fun</code></td>
<td>
<p>Function used to process each 'slab' of data, ideally returning a vector with names attribute. Defaults to a wrapper function around <code>hdquantile</code>. See details.</p>
</td></tr>
<tr valign="top"><td><code>cpm</code></td>
<td>
<p>Strategy for normalizing slice-wise probabilities, dividing by either: number of profiles with data at the current slice (cpm=1), or by the number of profiles in the collection (cpm=2). Mode 1 values will always sum to the contributing fraction, while mode 2 values will always sum to 1.</p>
</td></tr>
<tr valign="top"><td><code>weights</code></td>
<td>
<p>Column name containing weights. NOT YET IMPLEMENTED</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>further arguments passsed to <code>slab.fun</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multiple continuous variables OR a single categorical (factor) variable can be aggregated within a call to <code>slab</code>. Basic error checking is performed to make sure that top and bottom horizon boundaries make sense. User-defined aggregate functions (<code>slab.fun</code>) should return a named vector of results. A new, named column will appear in the results of <code>slab</code> for every named element of a vector returned by <code>slab.fun</code>. See examples below for a simple example of a slab function that computes mean, mean-1SD and mean+1SD. The default slab function wraps <code><a href="../../Hmisc/html/hdquantile.html">hdquantile</a></code> from the Hmisc package, which requires at least 2 observations per chunk. Note that if 'group' is a factor it must not contain NAs.
</p>
<p>Execution time scales linearly (slower) with the total number of profiles in <code>object</code>, and exponentially (faster) as the number of profiles / group is increased. <code>slab()</code> and <code>slice()</code> are much faster and require less memory if input data are either numeric or character.
</p>
<p>There are several possible ways to define slabs, using <code>slab.structure</code>:
</p>

<dl>
<dt>a single integer</dt><dd><p>e.g. 10: data are aggregated over a regular sequence of 10-unit thickness slabs</p>
</dd>
<dt>a vector of 2 integers</dt><dd><p>e.g. c(50, 60): data are aggregated over depths spanning 50&ndash;60 units</p>
</dd>
<dt>a vector of 3 or more integers</dt><dd><p>e.g. c(0, 5, 10, 50, 100): data are aggregated over the depths spanning 0&ndash;5, 5&ndash;10, 10&ndash;50, 50&ndash;100 units</p>
</dd>
</dl>
 


<h3>Value</h3>

<p>Output is returned in long format, such that slice-wise aggregates are returned once for each combination of grouping level (optional), variable described in the <code>fm</code> argument, and depth-wise 'slab'.
</p>
<p>Aggregation of numeric variables, using the default slab function:
</p>

<dl>
<dt>variable</dt><dd><p>The names of variables included in the call to <code>slab</code>.</p>
</dd>
<dt>groupname</dt><dd><p>The name of the grouping variable when provided, otherwise a fake grouping variable named 'all.profiles'.</p>
</dd>
<dt>p.q5</dt><dd><p>The slice-wise 5th percentile.</p>
</dd>
<dt>p.q25</dt><dd><p>The slice-wise 25th percentile</p>
</dd>
<dt>p.q50</dt><dd><p>The slice-wise 50th percentile (median)</p>
</dd>
<dt>p.q75</dt><dd><p>The slice-wise 75th percentile</p>
</dd>
<dt>p.q95</dt><dd><p>The slice-wise 95th percentile</p>
</dd>
<dt>top</dt><dd><p>The slab top boundary.</p>
</dd>
<dt>bottom</dt><dd><p>The slab bottom boundary.</p>
</dd>
<dt>contributing_fraction</dt><dd><p>The fraction of profiles contributing to the aggregate value, ranges from 1/n_profiles to 1.</p>
</dd>
</dl>

<p>When a single factor variable is used, slice-wise probabilities for each level of that factor are returned as:
</p>

<dl>
<dt>variable</dt><dd><p>The names of variables included in the call to <code>slab</code>.</p>
</dd>
<dt>groupname</dt><dd><p>The name of the grouping variable when provided, otherwise a fake grouping variable named 'all.profiles'.</p>
</dd>
<dt>A</dt><dd><p>The slice-wise probability of level A</p>
</dd>
<dt>B</dt><dd><p>The slice-wise probability of level B</p>
</dd>
<dt>...</dt><dd></dd>
<dt>n</dt><dd><p>The slice-wise probability of level n</p>
</dd>
<dt>top</dt><dd><p>The slab top boundary.</p>
</dd>
<dt>bottom</dt><dd><p>The slab bottom boundary.</p>
</dd>
<dt>contributing_fraction</dt><dd><p>The fraction of profiles contributing to the aggregate value, ranges from 1/n_profiles to 1.</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>data = &quot;SoilProfileCollection&quot;</dt><dd><p>Typical usage, where input is a <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code>.</p>
</dd>
</dl>



<h3>Note</h3>

<p>Arguments to <code>slab</code> have changed with <code>aqp</code> 1.5 (2012-12-29) as part of a code clean-up and optimization. Calculation of weighted-summaries was broken in <code>aqp</code> 1.2-6 (2012-06-26), and removed as of <code>aqp</code> 1.5 (2012-12-29).  <code>slab</code> replaced the previously defined <code>soil.slot.multiple</code> function as of <code>aqp</code> 0.98-8.58 (2011-12-21).</p>


<h3>Author(s)</h3>

<p>D.E. Beaudette</p>


<h3>References</h3>

<p>D.E. Beaudette, P. Roudier, A.T. O'Geen, Algorithms for quantitative pedology: A toolkit for soil scientists, Computers &amp; Geosciences, Volume 52, March 2013, Pages 258-268, 10.1016/j.cageo.2012.10.020.
</p>
<p>Harrell FE, Davis CE (1982): A new distribution-free quantile estimator. Biometrika 69:635-640.
</p>


<h3>See Also</h3>

<p><code><a href="SPC-slice-methods.html">slice</a>, <a href="../../Hmisc/html/hdquantile.html">hdquantile</a></code>
</p>


<h3>Examples</h3>

<pre><code class="r">##
## basic examples
##
library(lattice)
library(grid)

# load sample data, upgrade to SoilProfileCollection
data(sp1)
depths(sp1) &lt;- id ~ top + bottom

# aggregate entire collection with two different segment sizes
a &lt;- slab(sp1, fm = ~ prop)
b &lt;- slab(sp1, fm = ~ prop, slab.structure=5)

# check output
str(a)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    240 obs. of  10 variables:
##  $ variable             : Factor w/ 1 level &quot;prop&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ all.profiles         : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ p.q5                 : num  0.0083 0.0083 0.0332 0.1541 0.1541 ...
##  $ p.q25                : num  0.474 0.474 0.771 1.552 1.552 ...
##  $ p.q50                : num  3.44 3.44 3.52 4.53 4.53 ...
##  $ p.q75                : num  9.52 9.52 8.34 8.51 8.51 ...
##  $ p.q95                : num  13.7 13.7 16.6 16.6 16.6 ...
##  $ top                  : int  0 1 2 3 4 5 6 7 8 9 ...
##  $ bottom               : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ contributing_fraction: num  1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r"># stack into long format
ab &lt;- make.groups(a, b)
ab$which &lt;- factor(ab$which, levels=c(&#39;a&#39;,&#39;b&#39;), 
labels=c(&#39;1-cm Interval&#39;, &#39;5-cm Interval&#39;))

# plot median and IQR
# custom plotting function for uncertainty viz.
xyplot(top ~ p.q50 | which, data=ab, ylab=&#39;Depth&#39;,
             xlab=&#39;median bounded by 25th and 75th percentiles&#39;,
             lower=ab$p.q25, upper=ab$p.q75, ylim=c(250,-5),
             panel=panel.depth_function, 
             prepanel=prepanel.depth_function,
             cf=ab$contributing_fraction,
             layout=c(2,1), scales=list(x=list(alternating=1))
             )
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" style="display: block; margin: auto;" /></p>

<pre><code class="r">##
## categorical variable example
##
library(reshape)

# normalize horizon names: result is a factor
sp1$name &lt;- generalize.hz(sp1$name, 
new=c(&#39;O&#39;,&#39;A&#39;,&#39;B&#39;,&#39;C&#39;), 
pat=c(&#39;O&#39;, &#39;^A&#39;,&#39;^B&#39;,&#39;C&#39;))

# compute slice-wise probability so that it sums to contributing fraction, from 0-150
a &lt;- slab(sp1, fm= ~ name, cpm=1, slab.structure=0:150)

# reshape into long format for plotting
a.long &lt;- melt(a, id.vars=c(&#39;top&#39;,&#39;bottom&#39;), measure.vars=c(&#39;O&#39;,&#39;A&#39;,&#39;B&#39;,&#39;C&#39;))

# plot horizon type proportions using panels
xyplot(top ~ value | variable, data=a.long, subset=value &gt; 0,
             ylim=c(150, -5), type=c(&#39;S&#39;,&#39;g&#39;), horizontal=TRUE, layout=c(4,1), col=1 )
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" style="display: block; margin: auto;" /></p>

<pre><code class="r"># again, this time using groups
xyplot(top ~ value, data=a.long, groups=variable, subset=value &gt; 0,
             ylim=c(150, -5), type=c(&#39;S&#39;,&#39;g&#39;), horizontal=TRUE, asp=2)
</code></pre>

<p><img src="data:image/png;base64,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CRs1wrKTsFEjLDsJG7WhYb2APnsNwsowMKwaOw4nrEoJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwcfb55v5+cdWdPb3ZQlh2AjbOL0tKk/PyY/1mC2HZ8d847X5f3mLNv1yXW67HN9vHEJYd/41/3paSZg9xPb5Z/1q39u21fH+132mPnx/2Ma+L4LxtbXdYa9xi2UnYSFiE1QRhEVYTMx68b/5twkVL2LgqiacbniRctISNq7Dml6tnRh/fbCEsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbNcKyk7BRIyw7CRs1wrKTsFEjLDsJGzXCspOwUSMsOwkbtYFhfRjv+ws8P6YGYR3J0LCGHV6j4nDCykNYdhI2aoRlJ2GjRlh2EjZqhGUnYaNGWHYSNmqEZSdho0ZYdhI2aoRlJ2GjRlh2EjZqhGUnYaNGWHYSNmqEZSdho/Z6XzZjcXjCRUvYqBGWnYSNu3Vv3LH//e/hvO2wBn6kyYc7CJw8ktWlJ6zTYXXpCet0WF16wjodVpeesE6H1aUnrNNhdekJ63RYXXrCAkYhLDRBWGiCsNAEYaEJwkIThIUmCAtNEBaaOP2wFlfd2c3DT2efuu5r/eHLd/h8s+/YzcOXP+0uBo15dy0O7y3Y2BXg9MOanJcfxfzy6/2duphPh5e/kdeyd/jk/e3st+qzlzFTefr55fqQjV0BTj6s+Zfr9X/2d+9vl//h77/J6h2+fIe/qFus3uHlpwPGlDfyXabd748LNnYlOPmwti5guaGoPXzx7/+qS9k7vOay9w4vhZfS9/rzdn3Wqg6dvLWwpuJa9g+fXshYeoffvf+PfAS3ke1Vp7q6f8qVsNxsXhH5qKZ3+Pwft4PCWj5yV4/g+me/vKh4jEVYtjauyFR+HtY7fPJV371t3GLpR3Bb95wVpRCWq/6j3opbiKfD55er14RWP9YvbwZ8ajAwLB6823n6PF0+GbB5+H3NA/L+0w3Lu0JV7tPhi6tBd4U83WBnectTrt/ysk8qboJ6h9/XhNU7vDxBqp5+7R0+4AnScvjje8Y4/bBwFISFJggLTRAWmiAsNEFYaIKw0ARhoQnCQhOEhSYIC00QFpogLDRBWGiCsNAEYaEJwkIThDXW7JP6ctE3jbDGIqy9CGsswtqLsCo9vBa11FRek/H+tvx0cVVeNzMpL2iedvpbzbwphFVpflkimp7dTFYvTD3fDKu8Enb2ibKeEFat8iLAZUkP94DLv+mH9dBUxcsE3w7CqlWKeqiqvIBwM6yn+0k8IqxapaJyrzcpVW3dYk0f/4xmwvqJsKpNz/53ebH6pjK/3BXK7xP49hBWtdmnfy77WTW0uHoKa3G1foxFXj2EVW/y8CzDeXlyYRXW6nuU3pV/Olk29fB5Ix4QVr2He8G78jTWH++uS1jlYfz5dP08Fl31EBaaICw0QVhogrDQBGGhCcJCE4SFJggLTRAWmiAsNEFYaIKw0ARhoQnCQhOEhSYIC038H7YAIEh6uqmLAAAAAElFTkSuQmCC" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" style="display: block; margin: auto;" /></p>

<pre><code class="r"># adjust probability to size of collection, from 0-150
a.1 &lt;- slab(sp1, fm= ~ name, cpm=2, slab.structure=0:150)

# reshape into long format for plotting
a.1.long &lt;- melt(a.1, id.vars=c(&#39;top&#39;,&#39;bottom&#39;), measure.vars=c(&#39;O&#39;,&#39;A&#39;,&#39;B&#39;,&#39;C&#39;))

# combine aggregation from `cpm` modes 1 and 2
g &lt;- make.groups(cmp.mode.1=a.long, cmp.mode.2=a.1.long)

# plot horizon type proportions
xyplot(top ~ value | variable, groups=which, data=g, subset=value &gt; 0,
             ylim=c(240, -5), type=c(&#39;S&#39;,&#39;g&#39;), horizontal=TRUE, layout=c(4,1), 
             auto.key=list(lines=TRUE, points=FALSE, columns=2),
             par.settings=list(superpose.line=list(col=c(1,2))),
       scales=list(alternating=3))
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" style="display: block; margin: auto;" /></p>

<pre><code class="r"># apply slice-wise evaluation of max probability, and assign ML-horizon at each slice
(gen.hz.ml &lt;- get.ml.hz(a, c(&#39;O&#39;,&#39;A&#39;,&#39;B&#39;,&#39;C&#39;)))
</code></pre>

<pre><code>##   hz top bottom confidence pseudo.brier
## 1  O   0      2         37    0.3950617
## 2  A   2     32         75    0.1547325
## 3  B  32    145         57    0.3574667
## 4  C 145    150         71    0.1250000
</code></pre>

<pre><code class="r">## Not run: 
##D ##
##D ## multivariate examples
##D ##
##D data(sp3)
##D 
##D # add new grouping factor
##D sp3$group &lt;- &#39;group 1&#39;
##D sp3$group[as.numeric(sp3$id) &gt; 5] &lt;- &#39;group 2&#39;
##D sp3$group &lt;- factor(sp3$group)
##D 
##D # upgrade to SPC
##D depths(sp3) &lt;- id ~ top + bottom
##D site(sp3) &lt;- ~ group
##D 
##D # custom &#39;slab&#39; function, returning mean +/- 1SD
##D mean.and.sd &lt;- function(values) {
##D     m &lt;- mean(values, na.rm=TRUE)
##D     s &lt;- sd(values, na.rm=TRUE)
##D     upper &lt;- m + s
##D     lower &lt;- m - s
##D     res &lt;- c(mean=m, lower=lower, upper=upper)
##D     return(res)
##D     }
##D 
##D # aggregate several variables at once, within &#39;group&#39;
##D a &lt;- slab(sp3, fm=group ~ L + A + B, slab.fun=mean.and.sd)
##D 
##D # check the results:
##D # note that &#39;group&#39; is the column containing group labels
##D library(lattice)
##D xyplot(
##D     top ~ mean | variable, data=a, groups=group,
##D     lower=a$lower, upper=a$upper, sync.colors=TRUE, alpha=0.5,
##D     cf=a$contributing_fraction,
##D     ylim=c(125,-5), layout=c(3,1), scales=list(x=list(relation=&#39;free&#39;)),
##D     par.settings=list(superpose.line=list(lwd=2, col=c(&#39;RoyalBlue&#39;, &#39;Orange2&#39;))),
##D     panel=panel.depth_function, 
##D     prepanel=prepanel.depth_function,
##D     auto.key=list(columns=2, lines=TRUE, points=FALSE)
##D )
##D 
##D 
##D # compare a single profile to the group-level aggregate values
##D a.1 &lt;- slab(sp3[1, ], fm=group ~ L + A + B, slab.fun=mean.and.sd)
##D 
##D # manually update the group column
##D a.1$group &lt;- &#39;profile 1&#39;
##D 
##D # combine into a single data.frame:
##D g &lt;- rbind(a, a.1)
##D 
##D # plot with customized line styles
##D xyplot(
##D     top ~ mean | variable, data=g, groups=group, subscripts=TRUE, 
##D     lower=a$lower, upper=a$upper, ylim=c(125,-5),
##D     layout=c(3,1), scales=list(x=list(relation=&#39;free&#39;)),
##D     panel=panel.depth_function, 
##D     prepanel=prepanel.depth_function,
##D     sync.colors=TRUE, alpha=0.25,
##D     par.settings=list(superpose.line=list(col=c(&#39;orange&#39;, &#39;royalblue&#39;, &#39;black&#39;), 
##D   lwd=2, lty=c(1,1,2))),
##D     auto.key=list(columns=3, lines=TRUE, points=FALSE)
##D )
##D 
##D 
##D 
##D ## convert mean value for each variable into long format
##D library(reshape)
##D 
##D # note that depths are no longer in order 
##D a.wide &lt;- cast(a, group + top + bottom ~ variable, value=c(&#39;mean&#39;))
##D 
##D ## again, this time for a user-defined slab from 40-60 cm
##D a &lt;- slab(sp3, fm=group ~ L + A + B, slab.structure=c(40,60), slab.fun=mean.and.sd)
##D 
##D # now we have weighted average properties (within the defined slab)
##D # for each variable, and each group
##D (a.wide &lt;- cast(a, group + top + bottom ~ variable, value=c(&#39;mean&#39;)))
##D 
##D ## this time, compute the weighted mean of selected properties, by profile ID
##D a &lt;- slab(sp3, fm= id ~ L + A + B, slab.structure=c(40,60), slab.fun=mean.and.sd)
##D (a.wide &lt;- cast(a, id + top + bottom ~ variable, value=c(&#39;mean&#39;)))
##D 
##D 
##D ## aggregate the entire collection, using default slab function (hdquantile)
##D ## note the missing left-hand side of the formula
##D a &lt;- slab(sp3, fm= ~ L + A + B)
##D 
##D 
##D ## weighted-aggregation -- NOT YET IMPLEMENTED --
##D # load sample data, upgrade to SoilProfileCollection
##D data(sp1)
##D depths(sp1) &lt;- id ~ top + bottom
##D 
##D # generate pretend weights as site-level attribute
##D set.seed(10101)
##D sp1$site.wts &lt;- runif(n=length(sp1), min=20, max=100)
## End(Not run)
</code></pre>


<hr /><div style="text-align: center;">[Package <em>aqp</em> version 1.9.1 <a href="00Index.html">Index</a>]</div>
</body></html>
