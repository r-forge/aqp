<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Slab-Wise Aggregation of SoilProfileCollection Objects</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for slab-methods {aqp}"><tr><td>slab-methods {aqp}</td><td align="right">R Documentation</td></tr></table>

<h2>Slab-Wise Aggregation of SoilProfileCollection Objects</h2>

<h3>Description</h3>

<p>Aggregate soil properties along user-defined 'slabs', and optionally within groups.</p>


<h3>Usage</h3>

<pre>
# method for SoilProfileCollection objects
slab(object, fm, slab.structure=1, strict=FALSE, slab.fun=.slab.fun.numeric.default, cpm=1, ...)
</pre>


<h3>Arguments</h3>


<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
<p>a SoilProfileCollection</p>
</td></tr>
<tr valign="top"><td><code>fm</code></td>
<td>
<p>A formula: either &lsquo;groups ~ var1 + var2 + var3&rsquo; where named variables are aggregated within &lsquo;groups&rsquo; OR where named variables are aggregated across the entire collection &lsquo; ~ var1 + var2 + var3&rsquo;</p>
</td></tr>
<tr valign="top"><td><code>slab.structure</code></td>
<td>
<p>A user-defined slab thickness (defined by an integer), or user-defined structure (numeric vector). See details below.</p>
</td></tr>
<tr valign="top"><td><code>strict</code></td>
<td>
<p>logical: should horizons be strictly checked for self-consistency?</p>
</td></tr>
<tr valign="top"><td><code>slab.fun</code></td>
<td>
<p>Function used to process each 'slab' of data, ideally returning a vector with names attribute. Defaults to a wrapper function around <code>hdquantile</code>. See details.</p>
</td></tr>
<tr valign="top"><td><code>cpm</code></td>
<td>
<p>Strategy for normalizing slice-wise probabilities, dividing by either: number of profiles with data at the current slice (cpm=1), or by the number of profiles in the collection (cpm=2). Mode 2 values will always sum to the contributing fraction, while mode 1 values will always sum to 1.</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>further arguments passsed to <code>slab.fun</code></p>
</td></tr>
</table>


<h3>Details</h3>


<p>Multiple continuous variables OR a single categorical (factor) variable can be aggregated within a call to <code>slab</code>. Basic error checking is performed to make sure that top and bottom horizon boundaries make sense. User-defined aggregate functions (<code>slab.fun</code>) should return a named vector of results. A new, named column will appear in the results of <code>slab</code> for every named element of a vector returned by <code>slab.fun</code>. See examples below for a simple example of a slab function that computes mean, mean-1SD and mean+1SD. The default slab function wraps <code><a href="../../Hmisc/html/hdquantile.html">hdquantile</a></code> from the Hmisc package.
</p>
<p>Execution time scales linearly (slower) with the total number of profiles in <code>object</code>, and exponentially (faster) as the number of profiles / group is increased.
</p>
<p>There are several possible ways to define slabs, using <code>slab.structure</code>:
</p>

<dl>
<dt>a single integer</dt><dd><p>e.g. 10: data are aggregated over a regular sequence of 10-unit thickness slabs</p>
</dd>
<dt>a vector of 2 integers</dt><dd><p>e.g. c(50, 60): data are aggregated over depths spanning 50&ndash;60 units</p>
</dd>
<dt>a vector of 3 or more integers</dt><dd><p>e.g. c(0, 5, 10, 50, 100): data are aggregated over the depths spanning 0&ndash;5, 5&ndash;10, 10&ndash;50, 50&ndash;100 units</p>
</dd>
</dl>
 


<h3>Value</h3>


<p>Output is returned in long format, such that slice-wise aggregates are returned once for each combination of grouping level (optional), variable described in the <code>fm</code> argument, and depth-wise 'slab'.
</p>
<p>Aggregation of numeric variables, using the default slab function:
</p>

<dl>
<dt>variable</dt><dd><p>The names of variables included in the call to <code>slab</code>.</p>
</dd>
<dt>groupname</dt><dd><p>The name of the grouping variable when provided, otherwise a fake grouping variable named 'all.profiles'.</p>
</dd>
<dt>p.q5</dt><dd><p>The slice-wise 5th percentile.</p>
</dd>
<dt>p.q25</dt><dd><p>The slice-wise 25th percentile</p>
</dd>
<dt>p.q50</dt><dd><p>The slice-wise 50th percentile (median)</p>
</dd>
<dt>p.q75</dt><dd><p>The slice-wise 75th percentile</p>
</dd>
<dt>p.q95</dt><dd><p>The slice-wise 95th percentile</p>
</dd>
<dt>top</dt><dd><p>The slab top boundary.</p>
</dd>
<dt>bottom</dt><dd><p>The slab bottom boundary.</p>
</dd>
<dt>contributing_fraction</dt><dd><p>The fraction of profiles contributing to the aggregate value, ranges from 1/n_profiles to 1.</p>
</dd>
</dl>

<p>When a single factor variable is used, slice-wise probabilities for each level of that factor are returned as:
</p>

<dl>
<dt>variable</dt><dd><p>The names of variables included in the call to <code>slab</code>.</p>
</dd>
<dt>groupname</dt><dd><p>The name of the grouping variable when provided, otherwise a fake grouping variable named 'all.profiles'.</p>
</dd>
<dt>A</dt><dd><p>The slice-wise probability of level A</p>
</dd>
<dt>B</dt><dd><p>The slice-wise probability of level B</p>
</dd>
<dt>...</dt><dd></dd>
<dt>n</dt><dd><p>The slice-wise probability of level n</p>
</dd>
<dt>top</dt><dd><p>The slab top boundary.</p>
</dd>
<dt>bottom</dt><dd><p>The slab bottom boundary.</p>
</dd>
<dt>contributing_fraction</dt><dd><p>The fraction of profiles contributing to the aggregate value, ranges from 1/n_profiles to 1.</p>
</dd>
</dl>



<h3>Methods</h3>



<dl>
<dt>data = &quot;SoilProfileCollection&quot;</dt><dd><p>Typical usage, where input is a <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code>.</p>
</dd>
</dl>



<h3>Note</h3>

<p>Arguments to <code>slab</code> have changed with <code>aqp</code> 1.5 (2012-12-29) as part of a code clean-up and optimization. Calculation of weighted-summaries was broken in <code>aqp</code> 1.2-6 (2012-06-26), and removed as of <code>aqp</code> 1.5 (2012-12-29).  <code>slab</code> replaced the previously defined <code>soil.slot.multiple</code> function as of <code>aqp</code> 0.98-8.58 (2011-12-21).</p>


<h3>Author(s)</h3>

<p>Dylan E Beaudette</p>


<h3>References</h3>


<p>D.E. Beaudette, P. Roudier, A.T. O'Geen, Algorithms for quantitative pedology: A toolkit for soil scientists, Computers &amp; Geosciences, Volume 52, March 2013, Pages 258-268, 10.1016/j.cageo.2012.10.020.
</p>
<p>Harrell FE, Davis CE (1982): A new distribution-free quantile estimator. Biometrika 69:635-640.
</p>


<h3>See Also</h3>


<p><code><a href="SPC-slice-methods.html">slice</a>, <a href="../../Hmisc/html/hdquantile.html">hdquantile</a></code>
</p>


<h3>Examples</h3>

<pre><code class="r">
##
## basic examples
##
library(lattice)
library(grid)

# load sample data, upgrade to SoilProfileCollection
data(sp1)
depths(sp1) &lt;- id ~ top + bottom

# aggregate entire collection with two different segment sizes
a &lt;- slab(sp1, fm = ~ prop)
b &lt;- slab(sp1, fm = ~ prop, slab.structure=5)

# check output
str(a)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    240 obs. of  10 variables:
##  $ variable             : Factor w/ 1 level &quot;prop&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ all.profiles         : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ p.q5                 : num  0.0083 0.0083 0.0332 0.1541 0.1541 ...
##  $ p.q25                : num  0.474 0.474 0.771 1.552 1.552 ...
##  $ p.q50                : num  3.44 3.44 3.52 4.53 4.53 ...
##  $ p.q75                : num  9.52 9.52 8.34 8.51 8.51 ...
##  $ p.q95                : num  13.7 13.7 16.6 16.6 16.6 ...
##  $ top                  : int  0 1 2 3 4 5 6 7 8 9 ...
##  $ bottom               : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ contributing_fraction: num  1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">
# stack into long format
ab &lt;- make.groups(a, b)
ab$which &lt;- factor(ab$which, levels=c(&#39;a&#39;,&#39;b&#39;), 
labels=c(&#39;1-cm Interval&#39;, &#39;5-cm Interval&#39;))

# plot median and IQR
# custom plotting function for uncertainty viz.
xyplot(top ~ p.q50 | which, data=ab, ylab=&#39;Depth&#39;,
             xlab=&#39;median bounded by 25th and 75th percentiles&#39;,
             lower=ab$p.q25, upper=ab$p.q75, ylim=c(250,-5),
             panel=panel.depth_function, 
             prepanel=prepanel.depth_function,
             cf=ab$contributing_fraction,
             layout=c(2,1), scales=list(x=list(alternating=1))
             )
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

##
## categorical variable example
##
library(reshape)

# normalize horizon names: result is a factor
sp1$name &lt;- generalize.hz(sp1$name, 
new=c(&#39;O&#39;,&#39;A&#39;,&#39;B&#39;,&#39;C&#39;), 
pat=c(&#39;O&#39;, &#39;^A&#39;,&#39;^B&#39;,&#39;C&#39;))

# compute slice-wise probability so that it sums to contributing fraction, from 0-150
a &lt;- slab(sp1, fm= ~ name, cpm=1, slab.structure=0:150)

# reshape into long format for plotting
a.long &lt;- melt(a, id.vars=c(&#39;top&#39;,&#39;bottom&#39;), measure.vars=c(&#39;O&#39;,&#39;A&#39;,&#39;B&#39;,&#39;C&#39;))

# plot horizon type proportions using panels
xyplot(top ~ value | variable, data=a.long, subset=value &gt; 0,
             ylim=c(150, -5), type=c(&#39;S&#39;,&#39;g&#39;), horizontal=TRUE, layout=c(4,1), col=1 )
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
# again, this time using groups
xyplot(top ~ value, data=a.long, groups=variable, subset=value &gt; 0,
             ylim=c(150, -5), type=c(&#39;S&#39;,&#39;g&#39;), horizontal=TRUE, asp=2)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
# adjust probability to size of collection, from 0-150
a.1 &lt;- slab(sp1, fm= ~ name, cpm=2, slab.structure=0:150)

# reshape into long format for plotting
a.1.long &lt;- melt(a.1, id.vars=c(&#39;top&#39;,&#39;bottom&#39;), measure.vars=c(&#39;O&#39;,&#39;A&#39;,&#39;B&#39;,&#39;C&#39;))

# group mode 1 and mode 2 data
g &lt;- make.groups(mode_1=a.long, mode_2=a.1.long)

# plot horizon type proportions
xyplot(top ~ value | variable, groups=which, data=g, subset=value &gt; 0,
             ylim=c(240, -5), type=c(&#39;S&#39;,&#39;g&#39;), horizontal=TRUE, layout=c(4,1), 
             auto.key=list(lines=TRUE, points=FALSE, columns=2),
             par.settings=list(superpose.line=list(col=c(1,2))))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

# apply slice-wise evaluation of max probability, and assign ML-horizon at each slice
(gen.hz.ml &lt;- get.ml.hz(a, c(&#39;O&#39;,&#39;A&#39;,&#39;B&#39;,&#39;C&#39;)))
</code></pre>

<pre><code>##   hz top bottom confidence
## 4  O   0      1         28
## 1  A   1     31         75
## 2  B  31    144         57
## 3  C 144    149         67
</code></pre>

<pre><code class="r">

##
## multivariate examples
##
data(sp3)

# add new grouping factor
sp3$group &lt;- &#39;group 1&#39;
sp3$group[as.numeric(sp3$id) &gt; 5] &lt;- &#39;group 2&#39;
sp3$group &lt;- factor(sp3$group)

# upgrade to SPC
depths(sp3) &lt;- id ~ top + bottom
site(sp3) &lt;- ~ group

# custom &#39;slab&#39; function, returning mean +/- 1SD
mean.and.sd &lt;- function(values) {
    m &lt;- mean(values, na.rm=TRUE)
    s &lt;- sd(values, na.rm=TRUE)
    upper &lt;- m + s
    lower &lt;- m - s
    res &lt;- c(mean=m, lower=lower, upper=upper)
    return(res)
    }

# aggregate several variables at once, within &#39;group&#39;
a &lt;- slab(sp3, fm=group ~ L + A + B, slab.fun=mean.and.sd)

# check the results:
# note that &#39;group&#39; is the column containing group labels
library(lattice)
xyplot(
top ~ mean | variable, data=a, groups=group, subscripts=TRUE, 
lower=a$lower, upper=a$upper, ylim=c(125,-5),
layout=c(3,1), scales=list(x=list(relation=&#39;free&#39;)),
panel=panel.depth_function, 
prepanel=prepanel.depth_function,
auto.key=list(columns=2, lines=TRUE, points=FALSE)
)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAtFBMVEUAAAAAADkAAEgAAF0AAHQAQH0ASEgASJwAaJkAdJwAdL8AgP9IAABIAEhIAHRISABISJxIdHRIjLRInL9InN90AAB0AEh0AHR0SJx0aF10q8x0v/+cQACcSACcSEicSHScnEicyMyc3/+ysrK/aAC/dAC/nEi/yH2/35y/5cy////fjDnfnEjfv3Tfv7/f5czf////AP//q13/v3T/yH3/35z/5Zn/5bT/5cz//7///9/////KcJ21AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAgAElEQVR4nO2djXojTXGFlWWDYb1sQmJvCMYhsTEhi0NsjAFb939f0YyksaTpqjrVP1Jp5pxn/a2ReqpPVb871RpJw2JJUQ20OLUBapoiWFQTESyqiQgW1UQEi2oigkU1EcGimohgUU1EsKgmIlhUExEsqokIFtVEBItqIoJFNRHBopqIYFFNRLCoJiJYVBMRLKqJZgDW67cfp7Zg6HGxWHw5tYnKmj5Yb9efg4P1uLhavkyNrMmD9bJYBAfr7bpj6jG4S6/OD6yHFSn/uVqFh5/fLj7d9W3karl8v+1W5+HiafXLasTF02b069erEyyZy+Pr15vVfx9X46akswPrYbVej91J6KFbq+XDaj1W8Owu2qqpvF0PZJ3iXOD3uD5mSjo3sLoFWq1Qt2jdSvT/s/vXvrNo3eMvi5vhEAGsS5cae+z3WWM9u+Tx2FznBtZL3zE6Vh66f/Dr/7lqJrttZtntWz7W6ehnrAyPk9u7nx1Yj+iifSzU0cHye0yfr85a5wZW8mywairhz1iax4fpcXV2YPUvodb7l27R9vcv77fdovWLae+x4nh83N1sTUXnBtbOK67+RdX6FdeX9eMvi/4V11WcV4WIxzV4U9PZgdVdI7r4/WpN1ou2vUa0OhMsFl8eu0X7+e3+GySnuY6Fe+yeXYnXsQLoYe8S0J7W+5cAOgePDXVuYPX7l/W16rQCLNo5eGyucwOre+9voW12IyzaOXhsrbMDizoPESyqiQgW1UQEi2oigkU1EcGimqgiWAtqBjoFWH+PrvAOwxv8O8FKKbzD8AYJVlLhHYY3SLCSCu8wvEGClVR4h+ENnj9Yv/vH/6sZbq3K6/a7xc/qBqxr8Hf9q7h/+K+aMQlWUnXB+svXf6+8apXB+sn/dP+t65FgpVQXrD/+5L+//kvViC3A+ut1VY8EK6WqDv96/bPqLpuA9euaQQlWSlUd/nnx6/6nplq0wrr7QIKVUvV1685aNdVg876oW0iClVJNh3/p91frs0I1NThj/bnuS1eClVJNh3/cvClbd2tcM9garL/9pir7BCulig7/et0b/NtvqvpsAFblkyrBSqmiw+22/Y9Vt+9Nzlh10SdYCVV0uD0P1N2+NwCrLvkTAKvBDqbiuv1luDRa9co239JpDlYThXcY3iDBSiq8w/AGTwMWNQOdAqySOSAfpYOST0njhcd9D1eKkjuuzmG7xxEs+CmC5TkuFFhhFN5heIMEK6nwDsMbjAUWW2FplNxxdQ4L2woJVmmU3HF1DgsLVhiFdxjeIMFKKrzD8AZjgcVWWBold1ydw8K2QoJVGiV3XJ3DwoIVRuEdhjdIsJIK7zC8wVhgsRWWRskdV+ewsK2QYJVGyR1X57DjgfV+m/p/hp/QefxUCm+wMVgPX7o/VUIdVeEdhjfYFqy373fL12+jUxZbYbMouePqHHa0VthB1cG1DbHz6cKDn/t9Xd7Lehaf+Yi3OIyf+kn52B6fevRZjSa6EnOB3EiZ7Ez8bKdqmpRdwrEPkoA/SVoBLCUUmua9BlaGQ0HJZJ/VQ3KWrIrBe90XZrK+y2OesZRQaJr3BOvQIMHSQqFp3mNgNdljSQu4SGXgXrLsPZYK1sHhclXrgHWsPRa+eUfTXOl5JasG8wLrWUZromDhlxvQNDd6fk7jleMxpVSy/blSPqTxkskG9+uhHyZX9Lxa4fLtGrxAqqYpDUvglWMyIcGhtnbHW7IDg2I9PCbPDSw4lJpm8mChnA6zrla4nSxh6dSt8EDJs7kw1u3S0NFaIRzqMM1LMTfxZLIpJm7WAdbOso1dWWBJawa5MR8WgosbUdGlYFMuku42Alh4okLATS39hXA7zGo0IFq5BqVpfWT1JZf3tkUO6wx0hlITRfPcKWR9h8sUWMKBYiq11itpMB07DZZWcQMul93TgqXluM7TGrETZ2dn3aoVJrmCXtKbaGXvseRJU2QpFj+sGlWH6hYbLPO6w9mAJWZiuDkBWGbVobpNE6x6Dvd9Wp1QyaluMwwKluKwfKAnlJUhwXIa3BPByk7xnFqhsHMx3JymFeq7LKhugV8VbnI0BnwECQKWdkXL/4K+CViqyw+vxhDd1snBWtovUuz8+l+CtEIjH50uNINysCyfiFXNbgSwltZamJn1v4QBC+jw9oLpU1QBC3EKWU2ZPX+wNtq+hYGb9bxXuJ0kVUnxjcWynFST2Jw2WYBTqPxjWxMB6+BN/VZgJU9ZMcBKTUqwCsHaf8O1icPtTNAkwEpUboXCrOZH1gCnHrAMh3AqmaoNlvAZkaoOD+dSDwdWogFYGFlupwRrJ8tmn8dKgRWkFUYAa2KtkGCJ0xIsNTMjNbZCcdoqYAFkgQ7hVPKEVgXNLRxYdkLYdV+PwfSMFliY3ZxrumHAKkArXCv8eFhNCVmrxq0Qi9K7RT6sGK8VrqVVWkErMFhqWsgbh8cH6yP82G/CsWQrFFiZaMVshUhi2V9gaAyWHFj5mgvgsGhgUah0oY11qFQ+1eF4Kl9EV0I5Bh3vFxb9qzhLsLT77CjrAL3d6spIfEsnRRbUrVwJ2SbxF9b2/Qjs8KJl5bhpgCV+IyUzIwisxMUbOYYrIduk59pZxu15pgZWbiu8F7+gWcmhsE6OiK6E/AbVwqnfXfWaP8tWuCy6BI/chibT4f48eZHTGWV+FN55jVn/WrTP/iV2ZCiwFsWfnxHuQpOsgqMVHkyyHxXtVkJOOlqFlxt2CqM9e1ib9Kwjx5qtiYG1KSK0rcgG62DXUroNUtHygKUXz4OWcaXxMnHI4XGhwFrWAav8dpIusOC8vWk5DOoTWEXBs9gzrI4kWIhDNTyctzcth0F9AqsoeBZ7htWRocCq1ApBsKK0QhWseq3QA9bUWmEtsM5rj3UksLjHUoSQZdxyLMfh4Qw5IbXs/L3Qc4F0UxVjgMu/8sJQdlg6sCyUnj3wtQrzdmNuh6M5stZEzc99Oz3ksv6uZfsmbE7zu44Bh4oivKVjXyI162d/IuXgqfEkckQky4UrsfzP5OiWEzPZ3hXH4+OmBRZQQIIlzGR7VxyPjwsFll2mmmBhDoFJfNm7ErMNIim7wUKcG28aEizDITCJL3tXYrZBJOXZg8VWOArNVugQwYITiwSWZnh8XCiwCrliKxRUoxXqftUS6joGWGb2BGtkEEm5AliGX7WEuo4Alp19VbBO0wpdmQFv6SApF7dC0+74OIJlOAQmcWXpyoxguRQELMwhMIkreVdmgEEk5eJWaNpVS6iLYImTuJJ3ZQYYRFImWJbYCkfBkZTZCi0RrFFwJGWCZYmtcGQQSZmt0BLBGhlEUiZYltgKR8GRlNkKLRGsUXAkZYJlia1wZBBJma3Q0gTAcr1XCBhEUiZYhrz35dYreAYfm4naCkdux8cRLMMhMIkrS4KF1SlHvm2tlk9GAdkK03J5tjshwbIcApP4svekBhhEUiZYhtgKx8GRlJu3wsRxjcB6/bpY3CyX77eLzz/QUHbyBGscHEl5OmC9Xd8sXz7dLR++dH/AUHbybIVjg0jK02mFLxdPq7PVzdv3u+Xrt9Epi2ChqQEGkZSnA1an1Vmrg6qDCwtlJ89WOA6OpDydVtjp8eLpAKzFoO730Y+dfCWwNvNJPpZ7DoFJpCjJHxdYi95m0uH2FyRlDKxdk8bSjMAaH7ez1nXBelzt2mOfsbBkgUl8hfGkBhhEUp5SK3xcbd0JFp4mwcL02F9liL155x5LTCLsHuv1F+vTVOjLDQRLTCIsWA/9tu1m9cow8AVSLFlgEk9l2AqzB2aHspMnWGODSMoEyxBb4Tg4kvJ0WmFWKDv52YEV5f5YltvEcecEln0zbqCAZ9UKxdDHbYWmWb2EugiWOIkve1dutkEkZYKlqzJYp2mFvtxCtELTbOo4gmU4BCapkSXBqqAgYGEOgUlcyftysw0iKRe2QtOsUUJdBEucxJW8LzfbIJIywdLFVpgIjqTMVqiLYCWCIykTLF1shQmDSMpshbomDZbvzUKC5Qll5T7lViiilY5/zFaY8iocH7MVlpN11mBpaI0mOR5YaadCiKhgWVWawsdm9AT1DFMGkZTzW6Fo1OHQEMESJ3ElX5JhyiCS8uzBsr7LNPFWaGaYCo6knN8KvT7N9OE65YhgZWaYCo6kPHuw2AqDgGVGJ1ha7pBDYBJX8iUZpgwiKc8eLLbCIGBNrRUSLIJVIrbCzAxTBpGUZ98KCRbBKhFbYWaGqeBIyrNvhQSLYJWoWSu8f4bQsnvXrsPRHBnx4BT9YEFoYXVxuJ0bWOBJy0RBXbeyTVZJhkIJkYQz0fL6FBxqOodW2Ak8ad2jrRABy/NJt5IMpeBQwh60ptYKa4AFn7Tuc8ECT1lHBAsjCyzMXnivTzN9uE45atkK73GwQIfIBI7kdU9BwDIDnxlYRsoYVwRLkh8st03RIVbrQkmhrJQrg3WSVmh4CgLWwghLsDQRLHESgpVS6FZoeAoClhWWYGkCHSIT4LkbnghWiYKAxVYoTsJWmBLBEkSwvOnsi61QEFuhN519ESxBBMubzr7YCgWxFXrT2RfBEkSwvOnsi61QEFuhN519ESxBBMubzr7YCgWxFXrT2RfBEkSwvOnsi61QEFuhN519ESxBswXryB/0YysUJzFaoewSWGSsTlnKBWsKn3nXLRkJisGxhL1g+W0uRIdYrQsVBCzQITIBnrtuCT1hHaUV+l1KJVRFsJQJ8Nx1S7lggV8Ag0bZMQmWrrNrhUpwKGFnK/S7XLIVdpoSWBXJGsL7XRKsvgqgQ2QCPHfdUxSw9JBshapQh8gEeO66J4JVpCBgsRWKs7AVpkSwJBEsb0Z7YiuUxFbozWhPBEsSwfJmtCe2QkmTaIWv334sl++3i88/8FBWzgRLDA6lPAmwHjqiHr50f+BQVs5shWIJoZSn0Apffro6Y719v1ufucBQVs4ESywhlPIEwHr/7R9WQL1u4EJDWTmzFYrBoZQn0Aofr17HYC0Gdb8nfqycK4Ml+th7BplAjnT4o3uywNpx6CydYDw1yyreIp245XLX185aVwTr7VdPCbDMUFbObIViCaGUz78VPtwsCVZGigRL19t1fxK8ib155x5LnCXuHmtzHct5uaHOJis0WDoBocDK+C7F0cBanbo8F0jrnLJCt8LzAMuIifTCUG/p2OVByIoNVgFZWgmhlJ1g+U9ZmkNJxwALeNEMkBW7Feo5BgFrYQSVbB6jFeaEIlgEq0QFrbAmWKBDZAJP9vnpaSWEUq7VCkWbmkNJBEuZwJN9fnpaCaGUZwsWW2EQsKbWCgkWwSoRW2FeeloJoZRn2woJFsEqEVthXnpacCjl2bZCgkWwSsRWmJeeVkIo5dm2QoJFsErEVpiXnhYcSnm2rZBgEawSsRXmpaeVEEp5tq2QYBGsErEV5qWnBYdSnm0rJFgEq0RshXnpaSWEUp5tKyRYBKtEbIV56WnBoZRn2woJFsEqkRLKTHvarfDcv1d4rzhEal2oWYOVn51aQijlSvduOD+wFkcF6zStMD85NTiUsqsVZtkEFhmsU47mDFZ+cnpwKGUPWHk2gUXG6pSlxq3w/tn7slp3OI7viuVIsAAsqHhQZexgswULKqDD4Ti8KxieYCFYSAHtytiBzg+sOq2wl1U/PaMaYB23FaJTmJXZhs+ziTmEU3GKYOUkh5XQmmKeYFVrhRBYsEM7OJ57fnJoCWuApUchWIo8Du3geO75yaElJFipJ4yisBVaJbSmmGcrBMBCyQoKVklqUAmtOeYJVqXPzXQK2QrLUgNLWKcVZtrEHO4pCliV7sntcWgHh9IuTgwrIcFKPWEUZZ1YjTvc6hk1aIUV0kJKaM8EtULVqPxU1I/NrJ8wCnMPoRUMrBopQSW055ojWIOM2gDrEKkVmtl4sWrfClWzkMmYYC2BHYm+FmHAsvKwU0lNQLBcofRPq+D53QdqhWYe0MsRuIT2jHNshQRLsYuV0J5xjmDtyihPBbBgh3bwkjwigjW1VrgrozwEK3fGOYJVrxWC71tgDoHocgwzj4hgTa0VVgNLLR6QkQEWdMoKChZ0Kp8aWLsy8lfzU4qX4xCYoCCPWGABMc6wFe5Kz1/PDztjwQ6R+Pl5BGuF67ky7YIO4VScOvkey8zID9aYrFO1QjMW8E2TqbXC413HMjKywELICgsW/M1Lv92oYO2qJL9ORdcbaoCF5lEZLGC+QrLOsBXuqiS/TgRL0dzAqtgKAbCm2QqB+dqBFbUVVgXL3GURrDy1BevterFYXDyhR2uh0irJb62C79mbn/5Mhc7M49iXG9b+C9Bq2gpfFjer/z5+ukMPl0MJKslvK6h8gMNEZDDQKcBqfdJqCdb77VX/90PWOesorXAt9F+m7jAVGI0BTF4brMYnrZat8O36pv/78fMP9HgplPSEnV+1G89sJDtMhVWP34lhz4skApcQrZ6QA6KWYDU6Y42lZ1jl+zqDZIdYVK/9tbB/H94SIjEbgOVwKAx8/dqR9djvtNxyv8BUkiz/vg5QFSwq7vpD4GnXXUIoakCw+teEW92gIcw5dTNCmtbanAYsaEYQq8S5MChY7a9jvd8uFlf9X4ldWCZYa6UyLfnM34dkI1hUbXhCWCM/MIZWCoqbB5Zmuz1Yq83X6y/ulg9fuj9lofblS9RVPtkhFlUbvq/LS4gqpQwnAkvyneFQGtg3Q/Ey1tv3u+1fr99Gp6wCsBKpViuf7BCLqozekc0UUocTgJUwXuJQGPiyUDfvG5q6vzaM9SEGdb9n/CSyrVi+nbkOZsaibsZrU2hQpbNeCNUwSgUl7AFr17g872K3hMNaO8B6v103OOlyw8vF77tN/QFYaUaRJzZK5FuxfLIRLKo8eBB2oxagJEc/Y+06l6etcIF0fR1LukDandBePt15wbLkWylv+WSHWFR58CA/WIKCguVwmB5on7GeVmNuCNaBCJY1ENhjrcDybt7ZCtGSBAWrwuUG/VXh8mHVCldt0nm5gWChJZkuWIa6C6Q3PX6eC6SWfCvlLZ/sEIsqDx7EVlgwsGEo30p5yyc7xKLKgwcRLGPgET42k5Jvpbzlk41gUeXBg9gKjVQIFsEybGWA1e2ftrpCDxem98m3Ut7yyQ6xqPLgQWyFxsDtGStPBMuYvryEUMIBwSoTW6ExvV2SoGC1v9yQF4pgoSUhWFVD+VbKWz7ZIRZVHjyIrbBgYMNQvpXylk92iEWVBw8iWAUDC0KxFaIlCQpW1FZIsNCSEKyqoXwr5S2f7BCLKg8exFZYMLBhKN9KecsnO8SiyoMHEayCgQWh2ArRkgQFK2orJFhoSQhW1VC+lfKWT3aIRZUHD2IrLBjYMJRvpbzlkx1iUeXBgwhWwcCCUGyFaEmCghW1FWaAFe9uM/IE+negXSUhWPVDuVbLUz7ZIRZVGa19sz6rCEHBcjj0DzxGKHTRXOWTHWJRxdFpf0UFIFiuUMgcw5jR4pWWTzaCRU2OHkPly52t0KEWYN2L+61TgrVrycjxfMBSpo0Klktq8jnlkx1iUROj3Q0EVVCwHA79A48VSk0+p3yyQyxqYjTBqjiwIFRZKzwPsNgKnak4RLDw3AmWQ2yFxQoKlsOhf+CxQqnJ55RPdohFTYwmWBUHFoRiKyx8WHNcUJn7c2+FBKvwYc1xQWXuzx0sl9Tkc8onO8SiJkazFVYceKxQavI55ZMdYlETowlWxYEFoabWCi8n0woT700ZtghWqmAFYH0sxc5iADlGBmv/XVhl2qhguTROv7B8skMs6s5IAap6OiZYB2/uV3LoH3isUOMCFJWvAlijlaiSZ1LHAwv81I/boX9gQajCj80UlO+gZIVgaYtwbq3wsKrqtFFbIcEqfFhznFmZSYDlklkCT/kOStYQrDoKCpbDoX/gsUKZJfCU76BkBGvQJMBiKyx8WHOcWZlJtEKCVfiw5jizMpMAyyWzBJ7yHZSMrXDQJFqhS2YJPOU7KBnBGjQJsNgKCx/WHGdWZhKtkGAVPqw5zqzMJMByySyBp3wHJWMrHDSJVuiSWQJP+Q5KRrAGTQIstsLChzXHmZWZRCskWIUPa44zKzMJsFwyS+Ap30HJ2AoHTaIVumSWwFO+g5IRrEGTAIutsPBhzXFmZSbRCglW4cOa48zKTAIsr/QSDPVD0ZIdJoImDh8ZqZXnWEAJgYSRwkyiFXqll2CngBhassNEyMThIyO18hwLKqGdMVCYSYDlaoVLHCwQLcVIIuL48JERT451W6Hs20zjQJNohUVgGbflBtBSjCArgn1L57hgLUy0rLJMAiyHRvmb/08CzcGS3FTIdiS8hKVlGdW1tsM4YFkLmVnBmmDlfx0P1PHAyt1kNQLr9evi091y+X67+PwDD5X5IhrB6git0Hal5Ri1FbrAat4K365vlo8rpB6+dH/gUMYcYOap6tlY6UYSIc1JU77Of/N+WrBev/1Yvn2/W/3pfy0JNUhK3ObKSVXKYSqqFTRpLCv1sbASmpWpzJXfoWdgp/fbm+XLxdOGr6JQG7lWb690JlZIsqnA1swtyUJKaPoDksjmqtUea7W5unhaHoC1GNT97vnxrd1u4YzKCfMdPpKObcwtmBOyFKqykBxml8yTwigDY94dXztrXRGst+urbo/lPWNJT7gXD64caCQrtuDNl3v2HssyB6WQfv0h61h7rEqtUM9dReuUYAnGnMljBscyzGEpuMnyOPQO7FR18+5PHq8cmGxW7GmCddrrWO+3V/UuN2QkD1cONJIV2wdWyFboBav9WzqbC6Rv1xUukGYkD1cONJIVm2BBOt1bOhnJw5UDHWbFZiusO7B6qIzk4cqBDrNiE6y6AwtCsRUWPuyoGpTCVFohwSp82FE1KIWpgJVWRvJw5UCHWbHZCusOrB4qI3m4cqDDrNgEq+7AglBshYUPO6oGpTCVVkiwCh92VA1KYSpgpWUmX/C9L9BhOnierZyKmQbHMhJfZzCXVijLWsPkKuZiNXKYOlYPnjTkTxs1OJaRef85tZzvq8KJhAJLn8OowMFSmnXTZtt7Knm0FnxMFZBj1VaoZw59VHubS/phO4kzAquTXoSPFTWp0mfbfSp1uBL+0vg/9zsCWHrq4KlqyEd6wrAVCixIRh0u702sPA6TATSs8ElKpJRQr48LqnVK4jO5DjMHtg4F1AE4XaEOkwEUsByTlCgfLP1pNaVD5TrMHFgQCpnD+jA3DhbUCpMBILCcTaxaK9RzbwtW1FZIsAofFh0D1u2UDqXaCgUWJKAObIWi5tkKIQF1IFii5gkWW2Hhw6JjwLqd0qFUW+cHVvcfrQ4rnQSsfvjlpZVMaLBS4buCyrOJtkKBBUsv3v3z5aXwLs9e+RCH+OpsDsBXoUSNwTrUup61HGYOPEYovXjb6l0KfHkc4qszHHIMtI4M1louvEKBVaMVjqs3gsuerQisDVpTaYWH0uCK2grbgHV/uAG1ZysEazllsJbr9CxbocCCpRcPBAtyiK/O7vHNm+FJWuEgJD2CpTvEV2f3eIIVC6xKrXD8Dn7dVpj+hMDu8VFbofWJGSB8p7NrhRhYamng2uWClYrvSaY5WFJ9tM9hecJrigoWIAuqKqd6EaxR/IJMiuQESyjMqRzmDWwYyqJKfd5TxiRY+xPk5lBHaglNqE7uMGtgQaiME/xH+dxQ+VrhxwRgnJO1wr1S7dZFO8YRHjtuMmDpTztnS4ElxooNllGEjPDYcaHA0lQfLMghANYp1BisCiJYukOClalQYLEVlkbpVQ7W1FohwSqN0otgeVQfLMghANYpxFZYLRTB2hXBcoViKyyN0qscrKm1QoJVGqUXwfKoPliQQwCsU4itsFoogrUrguUKxVZYGqVXOVhTa4UEqzRKL4JVUd2HQ+pFSzisGb5ccAlPZnsqYHV6XqtCpKTDSGg5Slj1XxyuUGAhc9hjnkHAoFa492A6ZrhWOBrnZmtqrbAOWNtBFlx+sNJnrfhgLb2n26mBVV25TUB2GKQd+kt4bOMEKyWCVaxQYNVthUujmjmtMBXxLFqhD6yptUKCVRpFHjdrsKqLrXDQrFthdRGsQbMGi62wNIo8btatkGCVRpHHzRqs6mIrHDTrVlhdBGvQrMFiKyyNIo+bdSskWKVR5HGzBqu62AoHzboVVhfBGnT+YL1++7Fcvt8uPn/8hYZiKyyNIo87+1b4dt2h9PCl+7P9Cw1FsEqjyOPOHazHxS9XZ6y373fdmWvzV2aoCmIrHHTurfBPTx1Jr2u4Nn8NIQZ1vx/j5znzuPoRa/8crRTZBj/WuhKBMlhmKGQOyMd2EFvh8Nu5t0KClfcwwTJVAFZ1cY816Nz3WMstVNy8t9RcweLlBrbC6nP1YL1d91dGN3+hoQhWaRR53PmDddRQhtgKB51/KzxqKEMEa9CswWIrLI0ij5t1KyRYpVHkcbMGq7rYCgfNuhVWF8EaNGuw2ApLo8jjZt0KCVZpFHncrMGqLrbCQbNuhdVFsAbNGiy2wtIo8rhZt0KCVRpFHjdrsKqLrXDQrFthdRGsQbMGi62wNIo8btatkGCVRpHHzRqs6mIrHDTrVlhdBGvQrMFiKyyNIo+bdSskWKVR5HGzBqu62AoHzboVVhfBGjRrsNgKS6PI42bdCglWaRR53KzBqi62wkGzboXVRbAGzRostsLSKPK4WbdCglUaRR43a7Cqi61w0KxbYXURrEGzBoutsDSKPG7WrZBglUaRx80arOpiKxw061ZYXQRr0KzBqt4KcwfJrRB/PFgrdGlqrZBglUbJHVfnsLBghVF4h+ENEqykwjsMbzAWWGyFpVFyx9U5LGwrJFilUXLH1TksLFhhFN5heIMEK6nwDsMbjAUWW2FplNxxdQ4L2woJVmmU3HF1DgsLVhiFdxjeIMFKKrzD8AZjgcVWWBold1ydw8K2QoJVGiV3XJ3DwoIVRuEdhjdIsJIK7zC8wVhgsRWWRvjnW7oAAAXxSURBVMkdV+ewsK2QYJVGyR1X57CwYIVReIfhDRKspMI7DG8wFlhshaVRcsfVOSxsKyRYpVFyx9U5LCxYYRTeYXiDBCup8A7DG4wFFlthaZTccXUOC9sKCVZplNxxdQ4LC1YYhXcY3mADsF6//Vj95+ticbNcvt8uPv/ID3UyhXcY3mB9sN6uVyi9Xd8sXz7dLR++dH/gUGyFpVFyx9U5rGUrfFz8cnXGerl4Wp2tbt6+361PYGAoglUaJXdcncNagvWnpy1Jq7NW92sHV16oEyq8w/AGW+2xVnq8eDoAazGo+z3yz+kdmA5PbcAu4bDWdcF6XG21vGcsZA7IR+mg5FPSeOFx38NshabWYD2utu4E6+hRcsfVOewIYD32Vxm8m/cwCu8wvMFGYL3+Yn2acl5uCKPwDsMbbATWQ79tu1m9MnRdIGUrLI2SO67OYWHf0iFYpVFyx9U5LCxYYRTeYXiDBCup8A7DG4wFFlthaZTccXUOC9sKCVZplNxxdQ4LC1YYhXcY3iDBSiq8w/AGY4HFVlgaJXdcncPCtkKCVRold1ydw8KCFUbhHYY3SLCSCu8wvMFYYLEVlkbJHVfnsJO3QmoGOgFYRXMc5YzlGn+KMxaq052xms9Vew6C5RHBgucgWB4RLHgOguURwYLnIFgeESx4DoLlEcGC5yBYHhEseA6C5RHBouYqgkU1EcGimohgUU1EsKgmIlhUExEsqokIFtVEBItqotZg9TdoS98Xfn9Mdwv5iydxyPpZPdBmkB5pX6uAi6t0qE+jWxZKyezeAn/0+HJ0j7ptlOTEtpCKSod5SrM+Sruxv6rWYD10htI3atsf86IMGJ7VA20G6ZEOpr542t5NblfdDe0fR6Xs73U/9rB3C/zR8E16oyjpiW0JJrDDPKVZH6Xd2F9VY7Befrq5X2ni1pJ7Y5YP6r/f9bNGoE0IPdKeEndS7ZW8y+r6XvcjD3u3wB8N36aXiJIlwQR2mKc0vfQb+6tqC9b7b//wTbzL8t6Y9//QKr151gi0HqRH2pdUrQ6Rl8Oesb7X/cjD3i3wR8M36aWiZEkwgR3mKc0g+cb+qtqC9Xhll2E95u37P6V2NRttntUDbQbpkfb1cvH70c6o12pTkdiLCMns3AJ/NHyT3uHD4sS2ssDa/qPESzNofGN/SE3BevuV/e9rO2a14Xj7N+mf8eZZPcHtIDXSvl5WG+iXRKnfrq8SeywDrNEB/dBfPSXBEiYGVACWpzRbKTf2V9UUrIcbuwybMZ1076tn7QQ3z6JVGO+M1hImUsF6HHHS3w/4ZtT2XpNbMlgFYHVyHqbd2F9VS7DervuvOKp7v+2Y/neLGXsT6QSr33j4wEp42LkF/uHw3fR2h0sTg54zdtN5YKk39ld1lOtYxqvV/p9wd8b9Z+kSy/ZZNdBmkB7pQKuXSS+JKzTvt2IrTHjYvQX+aLhwHUuYGBBSUeEwV2n6g9Qb+6s6Cljp+8Lvj3lcaGM2z+qBNoP0SPvqrlPepCzJF0jHHnZvgT8arlwgTU1sC6modJinNJ30G/ur4ls6VBMRLKqJCBbVRASLaiKCRTURwaKaiGBRTUSwqCYiWFQTESyqiQgW1UQEi2oigkU1EcGimohgUU1EsKgmIlhUExEsqokIFtVEBItqIoKF6v32X28Xiy/dF7pulv33Eta3i+m+cNB/S/DqwXkrl0mLYKF6v10B9dJ9eaf7Ylj3Rc7Xr1f9bWNWT31ZP/127fyS1HRFsFC9364Q6sl5/XrTM9URtvp9/Uv/dI8Z1YlgoepOS/1NHTqw1vddWFPVfUWwA6s7WRGsrQgWqj2wHjf/D8k33Rbr849HgnUogoUqccZaru9Xs2mFBGtXBAvVHljrPdYKr56w91uCdSiChWoPrOVDd4u31U7+9euX7tIDwToUwUK1D1Z/HatD6aW7jPW/n+4I1r4IFtVEBItqIoJFNRHBopqIYFFNRLCoJiJYVBMRLKqJCBbVRASLaiKCRTURwaKaiGBRTUSwqCYiWFQTESyqif4f9uXyaqpiyAYAAAAASUVORK5CYII=" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

# compare a single profile to the group-level aggregate values
a.1 &lt;- slab(sp3[1, ], fm=group ~ L + A + B, slab.fun=mean.and.sd)

# manually update the group column
a.1$group &lt;- &#39;profile 1&#39;

# combine into a single data.frame:
g &lt;- rbind(a, a.1)

# plot with customized line styles
xyplot(
    top ~ mean | variable, data=g, groups=group, subscripts=TRUE, 
    lower=a$lower, upper=a$upper, ylim=c(125,-5),
    layout=c(3,1), scales=list(x=list(relation=&#39;free&#39;)),
    panel=panel.depth_function, 
    prepanel=prepanel.depth_function,
    sync.colors=TRUE, alpha=0.25,
    par.settings=list(superpose.line=list(col=c(&#39;orange&#39;, &#39;royalblue&#39;, &#39;black&#39;), lwd=2, lty=c(1,1,2))),
    auto.key=list(columns=3, lines=TRUE, points=FALSE)
)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">


## convert mean value for each variable into long format
library(reshape)

# note that depths are no longer in order 
a.wide &lt;- cast(a, group + top + bottom ~ variable, value=c(&#39;mean&#39;))

## again, this time for a user-defined slab from 40-60 cm
a &lt;- slab(sp3, fm=group ~ L + A + B, slab.structure=c(40,60), slab.fun=mean.and.sd)

# now we have weighted average properties (within the defined slab) for each variable, and each group
(a.wide &lt;- cast(a, group + top + bottom ~ variable, value=c(&#39;mean&#39;)))
</code></pre>

<pre><code>##     group top bottom     L      A     B
## 1 group 1  40     60 45.31 14.121 17.69
## 2 group 2  40     60 50.05  6.839 11.60
</code></pre>

<pre><code class="r">
## this time, compute the weighted mean of selected properties, by profile ID
a &lt;- slab(sp3, fm= id ~ L + A + B, slab.structure=c(40,60), slab.fun=mean.and.sd)
(a.wide &lt;- cast(a, id + top + bottom ~ variable, value=c(&#39;mean&#39;)))
</code></pre>

<pre><code>##    id top bottom     L      A      B
## 1   1  40     60 48.55 10.353 17.307
## 2  10  40     60 54.97  8.651 14.715
## 3   2  40     60 40.15 13.805 15.217
## 4   3  40     60 43.64 15.008 17.511
## 5   4  40     60 43.49 13.704 16.814
## 6   5  40     60 50.72 17.734 21.595
## 7   6  40     60 52.93  8.209 14.902
## 8   7  40     60 44.17  5.114  8.414
## 9   8  40     60 45.74  5.902  8.772
## 10  9  40     60 52.43  6.320 11.197
</code></pre>

<pre><code class="r">

## aggregate the entire collection, using default slab function (hdquantile)
## note the missing left-hand side of the formula
a &lt;- slab(sp3, fm= ~ L + A + B)

</code></pre>


<hr><div align="center">[Package <em>aqp</em> version 1.5 <a href="00Index.html">Index</a>]</div>
</body></html>
