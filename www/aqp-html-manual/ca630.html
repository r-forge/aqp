<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Soil Data from the Central Sierra Nevada Region of California</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for ca630 {aqp}"><tr><td>ca630 {aqp}</td><td align="right">R Documentation</td></tr></table>

<h2>Soil Data from the Central Sierra Nevada Region of California</h2>

<h3>Description</h3>

<p>Site and laboratory data from soils sampled in the central Sierra Nevada Region of California.</p>


<h3>Usage</h3>

<pre>data(ca630)</pre>


<h3>Format</h3>


<p>List containing:
</p>
<p>$site : A data frame containing site information.
</p>

<dl>
<dt><code>user_site_id</code></dt><dd><p>national user site id</p>
</dd>
<dt><code>mlra</code></dt><dd><p>the MLRA</p>
</dd>
<dt><code>county</code></dt><dd><p>the county</p>
</dd>
<dt><code>ssa</code></dt><dd><p>soil survey area</p>
</dd>
<dt><code>lon</code></dt><dd><p>longitude, WGS84</p>
</dd>
<dt><code>lat</code></dt><dd><p>latitude, WGS84</p>
</dd>
<dt><code>pedon_key</code></dt><dd><p>national soil profile id</p>
</dd>
<dt><code>user_pedon_id</code></dt><dd><p>local soil profile id</p>
</dd>
<dt><code>cntrl_depth_to_top</code></dt><dd><p>control section top depth (cm)</p>
</dd>
<dt><code>cntrl_depth_to_bot</code></dt><dd><p>control section bottom depth (cm)</p>
</dd>
<dt><code>sampled_taxon_name</code></dt><dd><p>soil series name</p>
</dd>
</dl>

<p>$lab : A data frame containing horizon information.
</p>

<dl>
<dt><code>pedon_key</code></dt><dd><p>national soil profile id</p>
</dd>
<dt><code>layer_key</code></dt><dd><p>national horizon id</p>
</dd>
<dt><code>layer_sequence</code></dt><dd><p>horizon sequence number</p>
</dd>
<dt><code>hzn_top</code></dt><dd><p>horizon top (cm)</p>
</dd>
<dt><code>hzn_bot</code></dt><dd><p>horizon bottom (cm)</p>
</dd>
<dt><code>hzn_desgn</code></dt><dd><p>horizon name</p>
</dd>
<dt><code>texture_description</code></dt><dd><p>USDA soil texture</p>
</dd>
<dt><code>nh4_sum_bases</code></dt><dd><p>sum of bases extracted by ammonium acetate (pH 7)</p>
</dd>
<dt><code>ex_acid</code></dt><dd><p>exchangeable acidity [method ?]</p>
</dd>
<dt><code>CEC8.2</code></dt><dd><p>cation exchange capacity by sum of cations method (pH 8.2)</p>
</dd>
<dt><code>CEC7</code></dt><dd><p>cation exchange capacity by ammonium acetate (pH 7)</p>
</dd>
<dt><code>bs_8.2</code></dt><dd><p>base saturation by sum of cations method (pH 8.2)</p>
</dd>
<dt><code>bs_7</code></dt><dd><p>base saturation by ammonium acetate (pH 7)</p>
</dd>
</dl>



<h3>Details</h3>

<p>These data were extracted from the NSSL database. 'ca630' is a list composed of site and lab data, each stored as dataframes. These data are modeled by a 1:many (site:lab) relation, with the 'pedon_id' acting as the primary key in the 'site' table and as the foreign key in the 'lab' table.</p>


<h3>Source</h3>

<p><a href="http://ssldata.nrcs.usda.gov/">http://ssldata.nrcs.usda.gov/</a></p>


<h3>Examples</h3>

<pre><code class="r">
library(plyr)
library(lattice)
library(Hmisc)
library(maps)
library(sp)

# check the data out:
data(ca630)
str(ca630)
</code></pre>

<pre><code>## List of 2
##  $ site:&#39;data.frame&#39;:    137 obs. of  11 variables:
##   ..$ user_site_id      : chr [1:137] &quot;90CA009101&quot; &quot;90CA009102&quot; &quot;90CA009103&quot; &quot;90CA009104&quot; ...
##   ..$ mlra              : chr [1:137] &quot;22&quot; &quot;22&quot; &quot;22&quot; &quot;22&quot; ...
##   ..$ county            : chr [1:137] &quot;CA009&quot; &quot;CA009&quot; &quot;CA009&quot; &quot;CA009&quot; ...
##   ..$ ssa               : chr [1:137] &quot;CA731&quot; &quot;CA731&quot; &quot;CA731&quot; &quot;CA731&quot; ...
##   ..$ lon               : num [1:137] -120 -120 -120 -120 -120 ...
##   ..$ lat               : num [1:137] 38.4 38.4 38.4 38.4 38.3 ...
##   ..$ pedon_key         : chr [1:137] &quot;91P0709&quot; &quot;91P0710&quot; &quot;91P0711&quot; &quot;91P0712&quot; ...
##   ..$ user_pedon_id     : chr [1:137] &quot;90CA009101&quot; &quot;90CA009102&quot; &quot;90CA009103&quot; &quot;90CA009104&quot; ...
##   ..$ cntrl_depth_to_top: int [1:137] NA 25 NA 0 25 NA 25 25 0 28 ...
##   ..$ cntrl_depth_to_bot: int [1:137] NA 100 NA 30 100 NA 97 100 30 78 ...
##   ..$ sampled_taxon_name: chr [1:137] &quot;Windy&quot; &quot;Tallac&quot; &quot;Gerle&quot; &quot;Nd&quot; ...
##  $ lab :&#39;data.frame&#39;:    571 obs. of  13 variables:
##   ..$ pedon_key          : chr [1:571] &quot;91P0709&quot; &quot;91P0709&quot; &quot;91P0709&quot; &quot;91P0709&quot; ...
##   ..$ layer_key          : chr [1:571] &quot;91P04048&quot; &quot;91P04049&quot; &quot;91P04050&quot; &quot;91P04051&quot; ...
##   ..$ layer_sequence     : int [1:571] 1 2 3 4 1 2 3 4 1 2 ...
##   ..$ hzn_top            : int [1:571] 0 30 79 119 0 25 46 71 0 25 ...
##   ..$ hzn_bot            : int [1:571] 30 79 119 218 25 46 71 107 25 58 ...
##   ..$ hzn_desgn          : chr [1:571] &quot;A&quot; &quot;Bw1&quot; &quot;Bw2&quot; &quot;C&quot; ...
##   ..$ texture_description: chr [1:571] &quot;Sandy loam&quot; &quot;Sandy loam&quot; &quot;Fine sandy loam&quot; &quot;Fine sandy loam&quot; ...
##   ..$ nh4_sum_bases      : num [1:571] 9.9 1.3 0.9 0.8 10.1 1.4 0.8 0.2 1.7 0.5 ...
##   ..$ ex_acid            : num [1:571] 21.9 18.8 13.7 12.2 11.3 18.6 18.6 12 11.6 9.3 ...
##   ..$ CEC8.2             : num [1:571] 31.8 20.1 14.6 13 21.4 20 19.4 12.2 13.3 9.8 ...
##   ..$ CEC7               : num [1:571] 25.3 13.2 10.8 9 16.7 14.1 11.6 6.5 14.9 9.7 ...
##   ..$ bs_8.2             : int [1:571] 31 6 6 6 47 7 4 2 13 5 ...
##   ..$ bs_7               : int [1:571] 39 10 8 9 60 10 7 3 11 5 ...
</code></pre>

<pre><code class="r">
# note that pedon_key is the link between the two tables

# make a copy of the horizon data
ca &lt;- ca630$lab

# promote to a SoilProfileCollection class object
depths(ca) &lt;- pedon_key ~ hzn_top + hzn_bot

# add site data, based on pedon_key
site(ca) &lt;- ca630$site

# ID data missing coordinates: &#39;|&#39; is a logical OR
(missing.coords.idx &lt;- which(is.na(ca$lat) | is.na(ca$lon)))
</code></pre>

<pre><code>## [1] 48 56
</code></pre>

<pre><code class="r">
# remove missing coordinates by safely subsetting
if(length(missing.coords.idx) &gt; 0)
    ca &lt;- ca[-missing.coords.idx, ]

# register spatial data
coordinates(ca) &lt;- ~ lon + lat

# assign a coordinate reference system
proj4string(ca) &lt;- &#39;+proj=latlong +datum=NAD83&#39;

# check the result
print(ca)
</code></pre>

<pre><code>## Object of class SoilProfileCollection
## Number of profiles: 113
## Depth range: 29-260 cm
## 
## Horizon attributes:
##     pedon_key layer_key layer_sequence hzn_top hzn_bot hzn_desgn
## 451   00P0780  00P04900              1       0       2         A
## 452   00P0780  00P04901              2       2      15       Bw1
## 453   00P0780  00P04902              3      15      30       Bw2
## 454   00P0780  00P04903              4      30      45        Cd
## 455   00P0781  00P04904              1       0      14         A
## 456   00P0781  00P04905              2      14      38       Bt1
##      texture_description nh4_sum_bases ex_acid CEC8.2 CEC7 bs_8.2 bs_7
## 451 Loamy very fine sand           1.2     8.7    9.9  9.8     12   12
## 452      Fine sandy loam           0.4    11.2   11.6  5.7      3    7
## 453      Fine sandy loam           0.4     9.2    9.6  4.0      4   10
## 454      Fine sandy loam           0.4     3.9    4.3  1.7      9   24
## 455      Fine sandy loam           2.0    12.0   14.0  8.2     14   24
## 456      Fine sandy loam           1.1    20.8   21.9 11.7      5    9
## 
## Sampling site attributes:
##   pedon_key user_site_id mlra county   ssa user_pedon_id
## 1   00P0780   00CA109001   22  CA109 CA790    00CA109001
## 2   00P0781   00CA109002   22  CA109 CA790    00CA109002
## 3   00P0783   00CA109004   22  CA109 CA790    00CA109004
## 4   00P0784   00CA109005   22  CA109 CA790    00CA109005
## 5   00P0785   00CA109006   22  CA109 CA790    00CA109006
## 6   00P0786   00CA109007   22  CA109 CA790    00CA109007
##   cntrl_depth_to_top cntrl_depth_to_bot sampled_taxon_name
## 1                 25                100          (unnamed)
## 2                 14                 64          (unnamed)
## 3                 25                100          (unnamed)
## 4                 25                100          (unnamed)
## 5                 25                100          (unnamed)
## 6                 25                100          (unnamed)
## 
## Spatial Data:
##         min     max
## lon -120.72 -119.16
## lat   37.75   38.46
## CRS arguments: +proj=latlong +datum=NAD83
</code></pre>

<pre><code class="r">
# map the data (several ways to do this, here is a simple way)
map(database=&#39;county&#39;, region=&#39;california&#39;)
points(coordinates(ca), col=&#39;red&#39;, cex=0.5)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
# aggregate %BS 7 for all profiles into 1 cm slices
a &lt;- slab(ca, fm= ~ bs_7)

# plot median &amp; IQR by 1 cm slice
xyplot(
top ~ p.q50, data=a, lower=a$p.q25, upper=a$p.q75, 
ylim=c(160,-5), alpha=0.5, scales=list(alternating=1, y=list(tick.num=7)),
panel=panel.depth_function, prepanel=prepanel.depth_function,
ylab=&#39;Depth (cm)&#39;, xlab=&#39;Base Saturation at pH 7&#39;, 
par.settings=list(superpose.line=list(col=&#39;black&#39;, lwd=2))
)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
# aggregate %BS at pH 8.2 for all profiles by MLRA, along 1 cm slices
# note that mlra is stored in @site
a &lt;- slab(ca, mlra ~ bs_8.2)

# keep only MLRA 18 and 22
a &lt;- subset(a, subset=mlra %in% c(&#39;18&#39;, &#39;22&#39;))

# plot median &amp; IQR by 1 cm slice, using different colors for each MLRA
xyplot(
top ~ p.q50, groups=mlra , data=a, lower=a$p.q25, upper=a$p.q75, 
ylim=c(160,-5), alpha=0.5, scales=list(y=list(tick.num=7, alternating=3), x=list(alternating=1)),
panel=panel.depth_function, prepanel=prepanel.depth_function,
ylab=&#39;Depth (cm)&#39;, xlab=&#39;Base Saturation at pH 8.2&#39;, 
par.settings=list(superpose.line=list(col=c(&#39;black&#39;,&#39;blue&#39;), lty=c(1,2), lwd=2)),
auto.key=list(columns=2, title=&#39;MLRA&#39;, points=FALSE, lines=TRUE)
)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

# safely compute hz-thickness weighted mean CEC (pH 7)
# using data.frame objects
head(lab.agg.cec_7 &lt;- ddply(ca630$lab, .(pedon_key), 
.fun=summarise, CEC_7=wtd.mean(bs_7, weights=hzn_bot-hzn_top)))
</code></pre>

<pre><code>##   pedon_key  CEC_7
## 1   00P0780 13.889
## 2   00P0781 11.191
## 3   00P0783 19.255
## 4   00P0784 29.825
## 5   00P0785  9.918
## 6   00P0786 11.514
</code></pre>

<pre><code class="r">
# extract a SPDF with horizon data along a slice at 25 cm
s.25 &lt;- slice(ca, fm=25 ~ bs_7 + CEC7 + ex_acid)
</code></pre>

<pre><code>## result is a SpatialPointsDataFrame object
</code></pre>

<pre><code class="r">spplot(s.25, zcol=c(&#39;bs_7&#39;,&#39;CEC7&#39;,&#39;ex_acid&#39;))

# note that the ordering is preserved:
all.equal(s.25$pedon_key, profile_id(ca))
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

<pre><code class="r">
# extract a data.frame with horizon data at 10, 20, and 50 cm
s.multiple &lt;- slice(ca, fm=c(10,20,50) ~ bs_7 + CEC7 + ex_acid)

# Extract the 2nd horizon from all profiles as SPDF
ca.2 &lt;- ca[, 2]
</code></pre>

<pre><code>## result is a SpatialPointsDataFrame object
</code></pre>

<pre><code class="r">
# subset profiles 1 through 10
ca.1.to.10 &lt;- ca[1:10, ]

# basic plot method: profile plot
plot(ca.1.to.10, name=&#39;hzn_desgn&#39;)

</code></pre>


<hr><div align="center">[Package <em>aqp</em> version 1.4-6 <a href="00Index.html">Index</a>]</div>
</body></html>
