<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Numerical Soil Profile Comparison</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/languages/r.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for profile_compare-methods {aqp}"><tr><td>profile_compare-methods {aqp}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Numerical Soil Profile Comparison</h2>

<h3>Description</h3>

<p>Performs a numerical comparison of soil profiles using named properties, based on a weighted, summed, depth-segment-aligned dissimilarity calculation. If <code>s</code> is a <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code>, site-level variables (2 or more) can also be used. The site-level and horizon-level dissimilarity matricies are then re-scaled and averaged.
</p>


<h3>Usage</h3>

<pre>
pc(s, vars, max_d, k, filter=NULL, sample_interval=NA, 
replace_na=TRUE, add_soil_flag=TRUE, 
return_depth_distances=FALSE, strict_hz_eval=FALSE,
progress='none', plot.depth.matrix=FALSE, rescale.result=FALSE,
verbose=FALSE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>s</code></td>
<td>
<p>a dataframe with at least 2 columns of soil properties, and an 'id' column for each profile. horizon depths must be integers and self-consistent</p>
</td></tr>
<tr valign="top"><td><code>vars</code></td>
<td>
<p>A vector with named properties that will be used in the comparison. These are typically column names describing horizon-level attributes (2 or more), but can also contain site-level attributes (2 or more) if <code>s</code> is a <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>max_d</code></td>
<td>
<p>depth-slices up to this depth are considered in the comparison</p>
</td></tr>
<tr valign="top"><td><code>k</code></td>
<td>
<p>a depth-weighting coeficient, use '0' for no depth-weighting (see examples below)</p>
</td></tr>
<tr valign="top"><td><code>filter</code></td>
<td>
<p>an index used to determine which horizons (rows) are included in the analysis</p>
</td></tr>
<tr valign="top"><td><code>sample_interval</code></td>
<td>
<p>use every n-th depth slice instead of every depth slice, useful for working with &gt; 1000 profiles at a time</p>
</td></tr>
<tr valign="top"><td><code>replace_na</code></td>
<td>
<p>if TRUE, missing data are replaced by maximum dissimilarity (TRUE)</p>
</td></tr>
<tr valign="top"><td><code>add_soil_flag</code></td>
<td>
<p>The algorithm will generate a 'soil'/'non-soil' matrix for use when comparing soil profiles with large differences in depth (TRUE). See details section below.</p>
</td></tr>
<tr valign="top"><td><code>return_depth_distances</code></td>
<td>
<p>return intermediate, depth-wise dissimilarity results (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>strict_hz_eval</code></td>
<td>
<p>should horizons be strictly checked for internal self-consistency? (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>progress</code></td>
<td>
<p>'none' (default): argument passed to <code>ddply</code> and related functions, see <code><a href="../../plyr/html/create_progress_bar.html">create_progress_bar</a></code> for all possible options; 'text' is usually fine.</p>
</td></tr>
<tr valign="top"><td><code>plot.depth.matrix</code></td>
<td>
<p>should a plot of the 'soil'/'non-soil' matrix be returned (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>rescale.result</code></td>
<td>
<p>should the result be rescaled by dividing by max(D) (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
<p>extra debug output (FALSE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Variability in soil depth can interfere significantly with the calculation of between-profile dissimilarity&ndash; what is the numerical &ldquo;distance&rdquo; (or dissimilarity) between a slice of soil from profile A and the corresponding, but missing, slice from a shallower profile B? Gower's distance metric would yield a NULL distance, despite the fact that intuition suggests otherwise: shallower soils should be more dissimilar from deeper soils. For example, when a 25 cm deep profile is compared with a 50 cm deep profile, numerical distances are only accumulated for the first 25 cm of soil (distances from 26 - 50 cm are NULL). When summed, the total distance between these profiles will generally be less than the distance between two profiles of equal depth. Our algorithm has an option (setting replace_na=TRUE) to replace NULL distances with the maximum distance between any pair of profiles for the current depth slice. In this way, the numerical distance between a slice of soil and a corresponding slice of non-soil reflects the fact that these two materials should be treated very differently (i.e. maximum dissimilarity). 
</p>
<p>This alternative calculation of dissimilarities between soil and non-soil slices solves the problem of comparing shallow profiles with deeper profiles. However, it can result in a new problem: distances calculated between two shallow profiles will be erroneously inflated beyond the extent of either profile's depth. Our algorithm has an additional option (setting add_soil_flag=TRUE) that will preserve NULL distances between slices when both slices represent non-soil material. With this option enabled, shallow profiles will only accumulate mutual dissimilarity to the depth of the deeper profile.
</p>
<p>Note that when the <code>add_soil_flag</code> option is enabled (default), slices are classified as 'soil' down to the maximum depth to which at least one of variables used in the dissimilarity calculation is not NA. This will cause problems when profiles within a collection contain all NAs within the columns used to determine dissimilarity. An approach for identifying and removing these kind of profiles is presented in the examples section below.
</p>
<p>A notice is issued if there are any NA values within the matrix used for distance calculations, as thes values are optionally replaced by the max dissimilarity.
</p>
<p>Our approach builds on the work of (Moore, 1972) and the previously mentioned depth-slicing algorithm.
</p>


<h3>Value</h3>

<p>A dissimilarity matrix object of class 'dissimilarity, dist', optionally scaled by max(D).</p>


<h3>Methods</h3>


<ul>
<li><p>data = &quot;SoilProfileCollection&quot; see <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code> 
</p>
</li>
<li><p>data = &quot;data.frame&quot; see <a href="profile_compare-methods.html">profile_compare</a> 
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Dylan E. Beaudette</p>


<h3>References</h3>


<dl>
<dt>1.</dt><dd><p>http://casoilresource.lawr.ucdavis.edu/</p>
</dd>
<dt>2.</dt><dd><p>Moore, A.; Russell, J. &amp; Ward, W. Numerical analysis of soils: A comparison of three soil profile models with field classification. Journal of Soil Science, 1972, 23, 194-209.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="SPC-slice-methods.html">slice</a></code>, <code><a href="../../cluster/html/daisy.html">daisy</a></code></p>


<h3>Examples</h3>

<pre><code class="r">## 1. check out the influence depth-weight coef:
require(lattice)
z &lt;- rep(1:100,4)
k &lt;- rep(c(0,0.1,0.05,0.01), each=100)
w &lt;- 100*exp(-k*z)

xyplot(z ~ w, groups=k, ylim=c(105,-5), xlim=c(-5,105), type=&#39;l&#39;, 
       ylab=&#39;Depth&#39;, xlab=&#39;Weighting Factor&#39;, 
       auto.key=list(columns=4, lines=TRUE, points=FALSE, title=&quot;k&quot;, cex=0.8, size=3),
       panel=function(...) {
         panel.grid(h=-1,v=-1) 
         panel.superpose(...)
       }
)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" style="display: block; margin: auto;" /></p>

<pre><code class="r">## 2. basic implementation, requires at least two properties
# implementation for a data.frame class object
data(sp1)
d &lt;- profile_compare(sp1, vars=c(&#39;prop&#39;,&#39;group&#39;), max_d=100, k=0.01, 
plot.depth.matrix=TRUE)
</code></pre>

<pre><code>##     id prop group
## 1 P001   17     0
</code></pre>

<pre><code class="r"># upgrade to SoilProfileCollection
depths(sp1) &lt;- id ~ top + bottom
op &lt;- par(mfrow=c(1,2))
# perform comparison on SoilProfileCollection object
# compare soil/non-soil matrix plot
d &lt;- profile_compare(sp1, vars=c(&#39;prop&#39;,&#39;group&#39;), max_d=100, k=0.01, 
plot.depth.matrix=TRUE)
</code></pre>

<pre><code>##     id prop group
## 1 P001   17     0
</code></pre>

<pre><code class="r"># plot profile collection
plot(sp1)
# annotate max depth of profile comparison
abline(h=100, col=&#39;red&#39;, lty=2)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" style="display: block; margin: auto;" /></p>

<pre><code class="r">par(op)


# more soil properties
data(sp2)
d.1 &lt;- profile_compare(sp2, vars=c(&#39;prop&#39;,&#39;field_ph&#39;,&#39;hue&#39;,&#39;value&#39;), 
max_d=100, k=0.01, plot.depth.matrix=TRUE)
</code></pre>

<pre><code>##        id prop field_ph hue value
## 1   hon-1    0       22  22    22
## 4  hon-13    0        8   8     8
## 8  hon-19    0       17  17    17
## 9   hon-2    0       17  17    17
## 10 hon-20    0       12   0     0
## 17  hon-7    0       30  30    30
## 18  hon-8    0       12  12    12
</code></pre>

<pre><code class="r"># add some missing data: 
sp2$prop[1:2] &lt;- NA
d.2 &lt;- profile_compare(sp2, vars=c(&#39;prop&#39;,&#39;field_ph&#39;,&#39;hue&#39;,&#39;value&#39;), 
max_d=100, k=0.01, plot.depth.matrix=TRUE)
</code></pre>

<pre><code>##        id prop field_ph hue value
## 1   hon-1   22       22  22    22
## 4  hon-13    0        8   8     8
## 8  hon-19    0       17  17    17
## 9   hon-2    0       17  17    17
## 10 hon-20    0       12   0     0
## 17  hon-7    0       30  30    30
## 18  hon-8    0       12  12    12
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" style="display: block; margin: auto;" /></p>

<pre><code class="r"># note small changes in D:
cor(d.1, d.2)
</code></pre>

<pre><code>## [1] 0.9987445
</code></pre>

<pre><code class="r">## 3. identify profiles within a collection that contain all NAs
require(plyr)
s &lt;- ldply(1:10, random_profile)
depths(s) &lt;- id ~ top + bottom

# replace first profile&#39;s data with NA
na.required &lt;- nrow(s[1, ])
s$p1[1:na.required] &lt;- NA
s$p2[1:na.required] &lt;- NA

# attempt profile comparison: this won&#39;t work, throws an error
# d &lt;- profile_compare(s, vars=c(&#39;p1&#39;,&#39;p2&#39;), max_d=100, k=0)

# check for soils that are missing all clay / total RF data
f.check.NA &lt;- function(i) length(which(is.na(i$p1) | is.na(i$p2))) / nrow(i) == 1
missing.too.much.data.idx &lt;- which(profileApply(s, f.check.NA))

# remove bad profiles and try again: works
s.no.na &lt;- profile_compare(s[-missing.too.much.data.idx, ], vars=c(&#39;p1&#39;,&#39;p2&#39;), 
max_d=100, k=0, plot.depth.matrix=TRUE)
</code></pre>

<p><img src="data:image/png;base64,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" title="plot of chunk unnamed-chunk-1" alt="plot of chunk unnamed-chunk-1" style="display: block; margin: auto;" /></p>

<pre><code class="r">## 4. better plotting of dendrograms with ape package:
if(require(ape) &amp; require(cluster) &amp; require(MASS)) {
h &lt;- diana(d)
p &lt;- as.phylo(as.hclust(h))
plot(ladderize(p), cex=0.75, label.offset=1)
tiplabels(col=cutree(h, 3), pch=15)

## 5. other uses of the dissimilarity matrix
# Sammon Mapping: doesn&#39;t like &#39;0&#39; values in dissimilarity matrix
d.sam &lt;- sammon(d)

# simple plot
dev.off() ; dev.new()
plot(d.sam$points, type = &quot;n&quot;, xlim=range(d.sam$points[,1] * 1.5))
text(d.sam$points, labels=row.names(as.data.frame(d.sam$points)), 
cex=0.75, col=cutree(h, 3))

}
</code></pre>

<pre><code>## Initial stress        : 0.00901
## stress after  10 iters: 0.00172, magic = 0.500
## stress after  20 iters: 0.00155, magic = 0.500
## stress after  30 iters: 0.00153, magic = 0.500
</code></pre>

<pre><code class="r">## 6. try out the &#39;sample_interval&#39; argument
# compute using sucessively larger sampling intervals
data(sp3)
d &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01)
d.2 &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01, sample_interval=2)
d.10 &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01, sample_interval=10)
d.20 &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01, sample_interval=20)

# check the results via hclust / dendrograms
oldpar &lt;- par(mfcol=c(1,4), mar=c(2,1,2,2))
plot(as.dendrogram(hclust(d)), horiz=TRUE, main=&#39;Every Depth Slice&#39;)
plot(as.dendrogram(hclust(d.2)), horiz=TRUE, main=&#39;Every 2nd Depth Slice&#39;)
plot(as.dendrogram(hclust(d.10)), horiz=TRUE, main=&#39;Every 10th Depth Slice&#39;)
plot(as.dendrogram(hclust(d.20)), horiz=TRUE, main=&#39;Every 20th Depth Slice&#39;)
par(oldpar)
</code></pre>


<hr /><div style="text-align: center;">[Package <em>aqp</em> version 1.9.1 <a href="00Index.html">Index</a>]</div>
</body></html>
