<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Numerical Soil Profile Comparison</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for profile_compare-methods {aqp}"><tr><td>profile_compare-methods {aqp}</td><td align="right">R Documentation</td></tr></table>

<h2>Numerical Soil Profile Comparison</h2>

<h3>Description</h3>


<p>Performs a numerical comparison of soil profiles using named properties, based on a weighted, summed, depth-segment-aligned dissimilarity calculation. If <code>s</code> is a <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code>, site-level variables (2 or more) can also be used. The site-level and horizon-level dissimilarity matricies are then re-scaled to [0,1] and averaged.
</p>


<h3>Usage</h3>

<pre>
pc(s, vars, max_d, k, filter=NULL, sample_interval=NA, 
replace_na=TRUE, add_soil_flag=TRUE, 
return_depth_distances=FALSE, strict_hz_eval=FALSE,
progress='none', plot.depth.matrix=FALSE, rescale.result=FALSE,
verbose=FALSE)
</pre>


<h3>Arguments</h3>


<table summary="R argblock">
<tr valign="top"><td><code>s</code></td>
<td>
<p>a dataframe with at least 2 columns of soil properties, and an 'id' column for each profile. horizon depths must be integers and self-consistent</p>
</td></tr>
<tr valign="top"><td><code>vars</code></td>
<td>
<p>A vector with named properties that will be used in the comparison. These are typically column names describing horizon-level attributes (2 or more), but can also contain site-level attributes (2 or more) if <code>s</code> is a <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>max_d</code></td>
<td>
<p>depth-slices up to this depth are considered in the comparison</p>
</td></tr>
<tr valign="top"><td><code>k</code></td>
<td>
<p>a depth-weighting coeficient, use '0' for no depth-weighting (see examples below)</p>
</td></tr>
<tr valign="top"><td><code>filter</code></td>
<td>
<p>an index used to determine which horizons (rows) are included in the analysis</p>
</td></tr>
<tr valign="top"><td><code>sample_interval</code></td>
<td>
<p>use every n-th depth slice instead of every depth slice, useful for working with &gt; 1000 profiles at a time</p>
</td></tr>
<tr valign="top"><td><code>replace_na</code></td>
<td>
<p>if TRUE, missing data are replaced by maximum dissimilarity (TRUE)</p>
</td></tr>
<tr valign="top"><td><code>add_soil_flag</code></td>
<td>
<p>The algorithm will generate a 'soil'/'non-soil' matrix for use when comparing soil profiles with large differences in depth (TRUE). See details section below.</p>
</td></tr>
<tr valign="top"><td><code>return_depth_distances</code></td>
<td>
<p>return intermediate, depth-wise dissimilarity results (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>strict_hz_eval</code></td>
<td>
<p>should horizons be strictly checked for internal self-consistency? (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>progress</code></td>
<td>
<p>'none' (default): argument passed to <code>ddply</code> and related functions, see <code><a href="../../plyr/html/create_progress_bar.html">create_progress_bar</a></code> for all possible options; 'text' is usually fine.</p>
</td></tr>
<tr valign="top"><td><code>plot.depth.matrix</code></td>
<td>
<p>should a plot of the 'soil'/'non-soil' matrix be returned (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>rescale.result</code></td>
<td>
<p>should the result be rescaled to [0,1] (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
<p>extra debug output (FALSE)</p>
</td></tr>
</table>


<h3>Details</h3>


<p>Variability in soil depth can interfere significantly with the calculation of between-profile dissimilarity&ndash; what is the numerical &ldquo;distance&rdquo; (or dissimilarity) between a slice of soil from profile A and the corresponding, but missing, slice from a shallower profile B? Gower's distance metric would yield a NULL distance, despite the fact that intuition suggests otherwise: shallower soils should be more dissimilar from deeper soils. For example, when a 25 cm deep profile is compared with a 50 cm deep profile, numerical distances are only accumulated for the first 25 cm of soil (distances from 26 - 50 cm are NULL). When summed, the total distance between these profiles will generally be less than the distance between two profiles of equal depth. Our algorithm has an option (setting replace_na=TRUE) to replace NULL distances with the maximum distance between any pair of profiles for the current depth slice. In this way, the numerical distance between a slice of soil and a corresponding slice of non-soil reflects the fact that these two materials should be treated very differently (i.e. maximum dissimilarity). 
</p>
<p>This alternative calculation of dissimilarities between soil and non-soil slices solves the problem of comparing shallow profiles with deeper profiles. However, it can result in a new problem: distances calculated between two shallow profiles will be erroneously inflated beyond the extent of either profile's depth. Our algorithm has an additional option (setting add_soil_flag=TRUE) that will preserve NULL distances between slices when both slices represent non-soil material. With this option enabled, shallow profiles will only accumulate mutual dissimilarity to the depth of the deeper profile.
</p>
<p>Note that when the <code>add_soil_flag</code> option is enabled (default), slices are classified as 'soil' down to the maximum depth to which at least one of variables used in the dissimilarity calculation is not NA. This will cause problems when profiles within a collection contain all NAs within the columns used to determine dissimilarity. An approach for identifying and removing these kind of profiles is presented in the examples section below.
</p>
<p>A notice is issued if there are any NA values within the matrix used for distance calculations, as thes values are optionally replaced by the max dissimilarity.
</p>
<p>Our approach builds on the work of (Moore, 1972) and the previously mentioned depth-slicing algorithm.
</p>


<h3>Value</h3>

<p>A dissimilarity matrix object of class 'dissimilarity, dist', optionally scaled to [0, 1].</p>


<h3>Methods</h3>



<ul>
<li><p>data = &quot;SoilProfileCollection&quot; see <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code> 
</p>
</li>
<li><p>data = &quot;data.frame&quot; see <a href="profile_compare-methods.html">profile_compare</a> 
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Dylan E. Beaudette</p>


<h3>References</h3>



<dl>
<dt>1.</dt><dd><p>http://casoilresource.lawr.ucdavis.edu/</p>
</dd>
<dt>2.</dt><dd><p>Moore, A.; Russell, J. &amp; Ward, W. Numerical analysis of soils: A comparison of three soil profile models with field classification. Journal of Soil Science, 1972, 23, 194-209.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="SPC-slice-methods.html">slice</a></code>, <code><a href="../../cluster/html/daisy.html">daisy</a></code></p>


<h3>Examples</h3>

<pre><code class="r">
## 1. check out the influence depth-weight coef:
require(lattice)
z &lt;- rep(1:100,4)
k &lt;- rep(c(0,0.1,0.05,0.01), each=100)
w &lt;- 100*exp(-k*z)

xyplot(z ~ w, groups=k, ylim=c(105,-5), xlim=c(-5,105), type=&#39;l&#39;, 
ylab=&#39;Depth&#39;, xlab=&#39;Weighting Factor&#39;, 
auto.key=list(columns=4, lines=TRUE, points=FALSE, title=&quot;k&quot;, cex=0.8, size=3),
panel=function(...) {
    panel.grid(h=-1,v=-1) 
    panel.superpose(...)
    }
)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAkFBMVEUAAAAAAEgAAHQASEgASJwAZAAAdJwAdL8AgP9IAABIAEhIAHRISABISJxIdHRInN90AAB0AEh0AHR0SJx0dHR0v/+cSACcSEicSHScnEicv5yc37+c3/+/dAC/nEi/35y//7+//9+////fnEjfv3Tfv7/f/9/f///m5ub/AAD/AP//v3T/35z//7///9////+a8bGDAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAb30lEQVR4nO3dDXvbOHYFYNpr1/Fku3K6K3fbWjNbq7tK9GH9/39Xgl+iJBAELu4lccFznsw4cZwjmHxNURRJFGcEEUgx9wCQPANYiEgACxEJYCEiASxEJICFiASwEJEAFiISwEJEAliISAALEQlgISIBLEQkgIWIBLAQkQAWIhLAQkQCWIhIAAsRCWAhIgEsRCSAhYgEsBCRABYiEsBCRAJY1GwePuYeQsoBLGoAyxnAogawnAEsagDLGcCipoJ1egMvewCLGgMLrgYDWNSUsOBqOIBFzebhf+BqOIBFzaYoiqfd3KNINoBFzaZ4+HOxmnsUyQawqME+ljOARY15VXgoXuYeRqoBLGoMrK/3Yj33OBINYFFTHSA9vj5+zj2QNANY1NRv6WzxZGgPYCEiASxEJICFiASwEJEAFiISwEJEAliISAALEQlgISIBLEQkM8L6ei9k32jrPUD32+P3iR/y+Cp9PuDVchT+/vwzI6zNi/k1zQO0vz29yVq+f8iD+HuJ/eUo/f35Zz5Ypx8fsj9fvQdof7st/iL6E215yM1K8PFuHlP8+wvIfLDMwjALZYoHaH/7z53sU8X9Q379p/Q5pv3lKP39BSRBWN8cIT7A5bf2Bb93JO4hTz/+XNjPX352hPiYg9/fL0dCHisgCcISeIAxWHIPefzt43z6j4ke84yd9/NSYJnfin6XgHWbOXbepRe89SGFYV0vR8Ca53CD9IK/e8hD+fL/+O+ix7GuliNgmWMuwgdImwcwL/i7xxJe8PcPuS2Ev8v+YwIWknsACxEJYCEiASxEJICFiASwEJEAFiISwEJEAliISAALEQlgISIBLEQkgIWIBLAQkQAWIhLAQkQCWIhIAAsRCWAhIgEsRCSAhYgEsBCRABYiEsBCRAJYiEjEYUk9gLZedQOO7AWsiXrVDRiwdPSqGzBg6ehVN2DA0tGrbsCApaNX3YABS0evugEDlo5edQNOB1aBLCBzwLJ+9iffA6juVTdgey9gpdarbsCApaNX3YABS0evugEDlo5edQMGLB296gYMWDp61Q0YsHT0qhswYOnoVTdgwNLRq27AgKWjV92AAUtHr7oBA5aOXnUDBiwdveoGDFg6etUNeA5YX++2WUMBa5binGDZZ3MGrFmKM4I1MP88YM1SnBEsg8rgaiva/ESyj/cpygyw3FV5/KAmXJzvFstdlcfyTLgYsHijrVfdgLHzrqM3gQH/Mrn/9PPz8+2n9uV/36wdONyQWu9sA/7V5f7vnp8tqmpXs8A6veEAaTLFA70OTibPA6bK7CtXs8AKqdIGQDcs1+apzTCpKvvmI2Dp6BUdsAenKiOmTFpXgKWkV6TY05OJhymTzhVgKenlLL7aQHn0+pkyubgCLCW9HMXWDZS713ND1aTnCrCU9MYUO5/xBnvDTJn0XQGWkl5KsdculK033JTJlSvAUtIbUhywT37fSzJlcu0KsJT0+hQHgbL00jZUTW5cAZaSXmcxBdR1b5Qpk1tXgKWk114cI6rrjTVlcucKsJT03hQziKrCgepscwVYSnrbYi5R5xYVx4AtrgBLSS+nqKtdKoYB21wBVvq9tSi24ptnv/heqyvASrj3aiPFUmzZpYrt3dtdAVaSvcHv6XlkYD89sneAFWCl1ju4JxVT7DpKFTfgQVeAlUzvyM45tXjsgELUghh2BVgJ9Hq93qMU+xylilkQDleANWtvxJvFY/E99BmxIFyuAGuu3tCjUkEDDjieTl8QTleANUMv6Uin94AD36UhLwi3K8CatDf6LISREN76oy6IEVeANVVv7BsyowMmvp9MXBBjrgBrgl6WN/lGL3oQ6R3KqCvAku3le+N4eMBxp76QFsS4K8CS6+U7GeGmuJf486koC8LDFWCJ9DKe4XJd3A/PSXqEBeHjCrC4ewVM1cXXf+Q58/O+1yNergCLM0KmqvQHzKbqTFgQfq4AiysNKvFz3pnOUr/r9Y2nK8DiSG9LJQuLGVXX6x9fV4AVm5unP0FYAqrOoQP2dgVYMbHsUwmNl/sJ8JKgAfu7AixqBE70HArbZVq2hPQGuAIsShyv/rjH222qElgQIa4AKzjuQwqs4+0//82/IIJcAVZQxg9U8Y33Zq9q9gUR5gqw/ON19JNpvPzX/w3FtzfQFWD5RezUdFusrwBnXhChrgDLIyFv1ESPd+i4wrwLItgVYI0l8O2/uPE6jlbNuiDCXQGWK4Q3lSPG6z4GOueCILgCrMHQzlSgjnf0yPqMsCiuAMse8vkvpPH6vF8zHyySK8CyJOasqvDxyl+xHNdLcwVYd4m9V2xYvN9bngsW0RVgXSf6FNCg8YacsjATLKorwOqF48Ri//EGnggzDyyyK8BqwnW6ut94J7wUPqqX7gqwzrzXQIyPd9pL4aN6I1wBFvOFNSPjnfpS+KjeGFdLh8V+uZZzvJNfCh/VG+Vq2bAErgIcHm/kWeuTw4pztWRYU1yw3CX6WoipYUW6WiwsqWuWrePluMRmYlixrhYKi3EGkZtYenku3JoWVrSrRcIyG6up1tOMN++I6I13tUBY9XPgNOtpzpt3RPQyuFocLNY5jyzp9fJevDwhLA5XC4N12WMXX0/cl8RPB4vF1aJg9V8ICq+n2e8KQ+/lcbUgWNfHF0TXk8QNPKaCxeRqObBuDlvJrSeh+8JMBIvL1VJgTXW7IZGNVZVpYLG5WgYsy1F2mfX0/Cy1/qeBxedqCbAmvI+V3PoHLHKkYNnfE+RfT/WToGpYjK6mhXV8LYr1+fz1Xjx+elbFLs+h95q511O7b6UZFqerSWGd3tbnw8PHefNifvlVRS7PwVMYeNfTZZddMSxWV5PCOjztyq3V+vTj43z8frfJEoAlMHe3Lf1Xgnph8bqafB+r3GoZVAZXW9HmJ3d+sTda8ly+Eswhe+a+b9bPdiubHdb2aXcDy11F/0F1n8nHtAGY7MZ70lss5u3V5FusbbnXPg2sKe4VajkaqhQWu6uJYW3LXfdJYI2eeMywnqwH2QGryaSwttVRhgl23sfPZ49fT9Pe0VEWFr+rSWEdf6s3U+KHGya4u/HQe4IqYQm4mhTWpno9sC5fGYoeIPW6/iZuPU1/q1BJWBKuMnxLR/622a4zGBTCEnGVHyzPywUj1pPzxBh9sGRcZQfL9zJU8noaOeFKHSwhV5nB8r+8mbieRs/j0wZrLzXgrGAFXDVPWp4z3txYqHgvNuCcYIXcjYGyPH3OOtYFay834IxgCU9NMu9ds0WK90K9JvnACrt7TOjy9L1IQhOsvVBvlWxgBd6VKGx5+l97A1hNcoElOplSwCVdimDthXrrZAIr+C5qAcsz6FJBPbD2Qr1N8oAVfnc+7+UZeAWqGljtgVHAcoRw10fP5ZnMff4Bixw6LLl5BcOvl9cCq3snB7AGQ7pLrc/ypNyHQQmsyzuEgDUU2t2PPZYn6fYeOmD13nkGrKEIwSLeNkYFrP4ZDYA1EKEpdlOb8oaz+OpMGcCyhzoNgLuXfpcrBbCuz8ACLGvI00s4exOcS4mv+ObMPsCyRgJW1E35AKuJblgSs83H3esxeVi3pyIDliUR8ywN9kbeQzR1WHenuAPWfWLm7xroTXb2N6bi+0snAOs+/LDSnf2Np9hySQ5g3SVqwkFrL8OttJOGZbvUC7BuEzeRpaWX5RbtKcOyXkIIWDeJnCD1vpfnzv8Jw7JfmgpYN2GGlfp8lYBFThis2Bmdb3rZJipJF9bAtfSAdZXomcKve9OfCDW6eOgeDYB1FVZYnBMrpQpr8N4fgNVPtKt+L+t8XYDVBLB454FLFNbwzYoAq5d4V12vlqmb44odN8ECrF74YKmZujmq2HVzNcC6hMFV08s/HWqKsJw37QOsLhyu6l5Fc4JHFLtvBglYXbhgiUzfnB6skZuMAlYbFldlr8ys4MnBGrt5LWC1YYIlNNt8arBGb4oMWE14XAltr5KDNX6zbcBqwgPrWWp5pgXL4ybugFWHyZXY8gSsJouE9Sy3PJOC5TPrBGDV4YD1bOnlSkqwvGYzAawqDK7qw1cLgOU3Sw5gVYmH9WztZQtgNVkarPYwQ/6wPKf1AiwTNlf5w/KdLg6wTGJhXQ6L5g7LexpCwDpzbrAAi9jrnUXB6r2Pkzks/3lTAescDav//mDesALm4wUsVld5wwqZ5xmwYmFdn88AWITekCwG1s15MjnDCpqYHrDiYN2ef5UxrCBXgMXrKmNYYa4AKwrW/fmigBXaG5hFwLKch5wtrEBXgBUBy3Z+e66wQl0BFq+rXGEFuwIswPIJYPlWxcOyX+iVJ6xwV4BFhTVwAWGWsAiuAIvXVZawKK4AC7BGs2RYx++f5/PXe/H46VkVCWvwSvoMYZFc5QJrY0RtXswvv6o4WMN3aMgPFs1VJrAOfyq3WKcfH/WWy6eq/b6ZXeUHi+gqD1hff/+jBHVscHlVAZZn8aJhbVfHe1hFm5+u/HL+rT3PhH+jNfu5B3Cbb9bPdiubFdbprzsLLHdVxBbLeQuszLZY1O1VHluszfpMhcXtKjNYdFc5wDq9VRvBNWXnHbAAy5kKFOFwQziskXtBZgUrwlVWsMpNV+gB0mBYY/cYzQlWjKtcYAVX1d83u6ucYEW5AqywAFZ8b1zyhDV+s+18YMW5AqyQeNzEPRtYka4AKyA+kwPkAivWFWAFBLDie6OTISyv2UwygRXtCrC84zdLTh6w4l0tGxb/BisPWAyuAMs3ntN6AZajlyOAxZspYXG4AizP+M5DmAEsFlc6YH2916cHWt5iDq1qEwjLe35L/bB4XOmAtSGJcj4mYA0VLwjW1/sqYiQcsPwn5FUPi8mVClint1XESBhgBUz0rB0WlysVsGznhfpnGJbABks7LDZXOmAdX1f0kcTDCpmZHrCsvXxhg9VcKiHxqhCwbov5XKUPKzrRsEJc6YbF6AqwxgNYsb2c4X1VuK4+bmd5KgxypRoWpyvAGkuYK82wWF2lD6t9O8dkRRnJICyJDZZiWLyu0od1vmyxaImDFegKsO56maNg5x2w+sXMrpTAqg5mPe1II4mCFepKLSxuVzpgHQrzXLh9uLtFUXhVG8C6KmZ3pQJWe3bDhrTNioEV7Aqwrnv5o+BwA2B1xfyuVMCabYsV7konLAFXKmA1ZzdsC9JRB8AaLV4qrP4JDuG46LAIrlTCknClAlZcAGusGLBIIcOiuNIIS8SVEljlk+HTv4iXVACWu1jGlQ5Yh4eP7dOOeIIyFRbJFWB1vTK1zIcbXs4lrOq/8ACWM0KuVMAyl39VsCY9QLoMWHttA5bYYvEeIBVxpQ3WXtuA2d+ELmExHyAFrPPiYdWHSGknNwCWI3ttA9ZwHMsNi+hK13raSxUL9gIWbwCrCf97hcQTSGmwqK5Urae9VLFkLyOsTb3TvqVdpANYg1k4rEO70358ne5V4RJg7aWKRXvZYJmDWE1odzOiwCK7UrSe9lLFsr1ssHp3XeM98g5YQsWyvYDFG/be9j1CNQNuohoW3ZWa9dS996xlwG0AizfMvZdzGpQMuItmWBGutKwnwJK7VeSSYfVOwtIx4Es0v6WTPaz+yX0qBtxL8rBkXOlYT4DFEcC6zdXZyBoG3A9g8QawmuiFFeVKw3q6vnxCwYCvAli84eu9uSwn/QFfRy2sOFcK1hNgMQWwrnJ7HWHyA74JYPGGq/fu+tTUB3wbrbAiXSW/ngCLLYDVy/0F9YkP+C6AxRvAagJYvOHptdwBJO0B30cprFhXaa8n251lkh6wJYDFG8BqMiksM0PYqvpgOWMLsNpYb4WV8oBtmRTW5ml3/O3DXB5muUIMsJrYb7GW8ICtmRLW6cdH++H4/W6TFQIr2lXK6wmwQr7QpNFkPjTGxquWB2vgnpDpDtieKWEdnn43EwvcwOrOlP9pzS/bJ5/tX5tF9nMPgCffrJ/tVjYvrHLP/fDwgS2WK0M3sU12wAOZdou1K18RruNhxbtKdz0BVtgXmhhRJaz4nfeMYQ3edTvVAQ9l2sMN5VPh42f84QbA4ksWsMwB0nV1bWvcAdJ8YQ1PE5DogAej8S0dBleJrifH9BNpDng4gMUbwGoCWLyJ6nXNl5PkgB0BLN7E9DrnYUpxwK4ohMXhKsn1BFiEL6RWLQiWe+K4BAfsDGDxht47MiFhegN2Rx8sFlcJrifAIn0htWoxsMZmUE1uwCMBLN4AVhPA4g21d3TK59QGPBZ1sHhcpbaexqcST2zAowEs3gBWE8DiDa133FViAx4PYPGG1OvhKq0BeyR1WEKu0lpPgEX/QmrVEmD5uEpqwD4BLN4AVhPA4g2h18tVSgP2ijJYXK5SWk+AFfOF1Kr8Yfm5SmjAfgEs3gBWE8DiTXCvp6t0BuwZwOJNaK+vq2QG7BvA4g1gNQEs3gT2ertKZcDeASzehPX6u0pkwP7RBYvNVSLrCbCGAlgxvQGu0hhwQACLN4DVBLB4E9Ib4iqJAYdEFSw+V0msJ8AaDmDRe4NcpTDgoAAWbwCrCWDxxr83zFUCAw4LYPEGsJoAFm+8ewNdzT/gwAAWbwCrCWDxxrc31NXsAw6NJliMrmZfT4DlDmDReoNdzT3g4AAWbwCrCWDxxq833BVgkTMKi9MVYEn3AhZvvHoJrgCLHMCKL06oF7B449NLcQVY5CwGFskVYJEDWLHFSfUCFm/Ge2muAIuchcAiugIscsZgsboCLOlewOLNWC/VFWCRA1hRxan1AhZvRnrJrgCLHMCKKU6uF7B44+6luwIscgAroji9XsDijbM3whVgkTMCi9cVYEn3AtZ0vTGuAIscwCIXp9gLWJP1RrkCLHIAi1qcZC9gTdUb5wqwyAEsYnGavYA1UW+kK8Aixw2L2RVgSfcC1jS9sa4Ay5Xja/HwcT5/vRePn55VmcCKdgVYjpze1udtSWrzYn75VQGWuzjZ3ilhHb9/nk8/Pspf1W+9qvKAFe8KsBz5el+fD0+7xldX0eanLb+aj8/Wv9WS/dwDmD7frJ/tVjYrLLNz9bQ738ByV2WxxWLYYGGL5cjpbWX2sQCLrTjh3hn2sRYHi8MVYDmy1J13wOoitfO+WuLhBhZXgOVKc4D09BZ8gJTbFWBJ9yp5S0cxLB5XgEUOYAUWp90LWMK9TK4AixzACitOvBewZHu5XAEWOYAVVJx6L2CJ9rK5AixyXLDYXQGWdC9gSfbyuQIscgAroDj9XsAS7GV0BVjkAJZ/sYJewJLr5XQFWOQAlnexhl7AkusFrLsAFkMvqyvAIgewfItV9AKWWC9g3Qew4nt5XQEWOYDlWayjF7CEepldARY5gOVXrKQXsGR6uV0BFjkOWPyuAEu6F7BEetldARY5gOVTrKYXsCR6+V0BFjmA5VGspxewBHoFXAEWOYA1XqyoF7D4eyVcARY5gDVarKkXsNh7RVwBFjmANVasqhewuHtlXAEWOYA1UqyrF7CYe4VcARY5gOUuVtYLWMy9gFVHAywBV2LLU8oVYJEDWM4AFjWA5QxgUZMFrL3UegIscgDLGcCiJgdYe7H1BFjkAJYzgEVNBrD2cusJsMgBLGcAixr9sPZCvVUAixrAcgawqAEsZwCLGvWw9kK9dQCLGsByBrCoASxnAIsa7bD2Qr1NAIuaQVgSrgBLuhewmLIX6m0DWNTohtWehwVYTQCLJ4B1E8BiSXfiKGA1ASyWANZtAIsjlzPdAasJYHEEsO4CWAzpXZoDWE0AiyGAdR/AYghg3Qew4tO/SBWwmgBWfADLEsCKD2BZMhWs4/fP8/nrvXi8fPCqUgDr6nYNgNVkIlinN0Np82J+tR+8qgBLuFg3rG3xl3KLdfrxYbZczQe/qvRhXd9fBrCaTAPrnzsj6Vjjaj50FW1+2vLr589n618kk/3cA0gz36yf7VY2E6x6H8sOy12l7QcVWyxnr8zOO2AlWAxYvNHWq27AU8Ki7LznsTwTLs4BFuVwQx7LM+HiLGCd3qojo80Hr6o8lmfCxdphUavyWJ4JFwMWb7T1qhswYOnoVTdgwNLRq27AgKWjV92AAUtHr7oBA5aOXnUDBiwdveoGDFg6etUNGLB09KobMGDp6FU3YMDS0atuwIClo1fdgBOChSwgM8Ca9gG09aobcGQvYE3Uq27AgKWjV92AAUtHr7oBA5aOXnUDBiwdveoGDFg6etUNGLB09KobcOqwkGUGsBCRABYiEsBCRAJYiEgACxEJYCEiASxEJICFiEQWln2mgcgcX4tiLdLdnySBMWVjsRIoLhfEwwd77/hMEV6RhWW/9V9cTm/r86FcoALdm94kCZy1T7vjb/wDNgtiW46Yt9djpgiviMIauFlpXA5Pu/InaS3QffjT5T6rjLXNfYDZi5u7wvL2+swU4RVRWAO3V45P+cPK3/319z8ud4Zm7G1WDXtx+dNlfsp4e10zRQRFJ6wt9/KsSldHEViHp9/NTqHAT8J7UW69uXuXDMvsWbB3n/66E4JV7rmXO4X8A35bmSUBWGzZmtdC7N2b9Vlqi1XtFLIXM6z9odrUYYnsvFfbK/7u01t1PabAiwLTJvFqQ2Tn3WemCK/oO9xgXrkLdfcnSWDMpnwqZD8sYHaxVgKHGzxmivCKLCz7TANx2dRbFonu/iQJjDEHSNcCxc0BUube8ZkivIK3dBCRABYiEsBCRAJYiEgACxEJYCEiASxEJICFiASwEJEAFiISwEJEAliISAALEQlgISIBLEQkgIWIBLAQkSwc1qY+QXJTVCfgnt565+Funnbd77/e27/Yrq7/5ravnsnowXYBgvmny8nCYR3MOcPdGbj1nyzpYJlLrlzZDJ/JO/ZPM8vCYR1fV+X/Dw///WpIbYdYAFZwFg7r6908rW0f/9fIaf5QVPeGqZ/wyqe2x/96/Px6/7f3onjamRvdPH6Wf/P1vtqYT5y7L6n7erDMs2L1BdvqqbH+p5f2stD6hJlLFg6r2kiZ7ZERUW2+thWCVQ1rU1EwsKrLgl7qzU4Fq/lE9yV13QXWprpM9aUuNI9S/9OuveKVcZYO61g+B5r/zI2RDu1ary/XMxuoldmOGVjV5utpd4HVfKL7krpu0+67H9vn1kqf+Wfmv6bd3ISJ/75haWXpsJobIFQfzUbmUD0/GRbln+o/bA0ss491Bav5RPcldV3fi7mc8PGzFtY80lX7lN/m9Fk6rHIN/6tBUn3cNlMfV6t+Ow5rOwTL7Hp9bgFrsTk8/qN6uXZ4/MMQOHR71HFbrEO1D2WHdSgAK/8cX//WbEb+ZlC0xx8+6h2odbuPNQSr+5K67QKrvjtos49lvvxmHwuwMk9997LqY3Wsyrxuq1/uXb0qHII19Krw+Fo9r5q/bF4W9F4VvjiP3ueRxcMq1/6q+bhuPhZFq8bsKT393ne0bY9j3X5JXXbZxzqYw1j/Z7Zb2+Ytnu3VcSzAWnw8DGTPJDyA5Ui1A9XtfVO/ZJkBLFcO9ZGHyC9ZZAALEQlgISIBLEQkgIWIBLAQkQAWIhLAQkQCWIhIAAsRCWAhIgEsRCSAhYgEsBCR/D/C74HNNXabSgAAAABJRU5ErkJggg==" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
## 2. basic implementation, requires at least two properties
# implementation for a data.frame class object
data(sp1)
d &lt;- profile_compare(sp1, vars=c(&#39;prop&#39;,&#39;group&#39;), max_d=100, k=0.01, 
plot.depth.matrix=TRUE)
</code></pre>

<pre><code>## Error: cannot compute site-level dissimilarity with fewer than 2 variables
</code></pre>

<pre><code class="r">
# upgrade to SoilProfileCollection
depths(sp1) &lt;- id ~ top + bottom
op &lt;- par(mfrow=c(1,2))
# perform comparison on SoilProfileCollection object
# compare soil/non-soil matrix plot
d &lt;- profile_compare(sp1, vars=c(&#39;prop&#39;,&#39;group&#39;), max_d=100, k=0.01, 
plot.depth.matrix=TRUE)
</code></pre>

<pre><code>## Error: cannot compute site-level dissimilarity with fewer than 2 variables
</code></pre>

<pre><code class="r"># plot profile collection
plot(sp1)
# annotate max depth of profile comparison
abline(h=100, col=&#39;red&#39;, lty=2)
par(op)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAACDVBMVEX9/v0AAAAAACAAACsAADUAAEYAAFYAAGUAAHMAFF4AIAAAIFYAIHMANY4ARjUARkYARnMARpoARqYASDUASKYAVlYAV1YAV70AZr0AdJoAdL0UKz4UK4cgAAAgAHMgFF4gNZogX8MgdN4rAAArFAArK2UrPporZr0riN41AAA1ACA1ADU1AHM1K4c1NVY1SAA1SD49LyE+SDU+Xz4+m94/LiNDLBtGAABGACtGAEZGAHNGFABGNQBGRgBGRkZGRodGRppGVlZGdGVGdL1GiIdGm95VRjZWAABWVnNWvv1YRTdZRDlaRSxdQy9eFABePgBePnNeiEZfQjJiQSZkQCtlACBlAHNlSCBldEZlvv1yXU5zAABzACBzACtzAD5zAEZzAHNzIABzRppzVzVzXVBzZgBzdABzdHNzdL1zj3Nzm71zm95zp5pzvr1zvt5zvv1z371z3/11XUF4XER6XDeAWECHKwCHRgCHiEaONQCPd1uaNQCaPgCaRgCaRkaaRnOadCCam3Oap3OaxJqa372a3/2mRgCmm0apkXS9VwC9ZgC9dAC9dCC9dD69dEa9dHO9m0a9m3O9vla9vnO933O935q9/qa9/r29/v3DXxTD/v3emzXem0bem3PevnPe35re/r3e/v39jzX9p0b9vlb9vmX9vnP933P934f935r9/r39/sP9/t79/v3/AAA8Ev7kAAAAr3RSTlP//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/wZIRfgAAAAlwSFlzAAAPYQAAD2EBqD+naQAAFQJJREFUeJzt3Y2bJEdBx3EqsnoqGqMIshrFqAiKRok4gBJflklEQSO+wmouni+5sAntuwg5jxBG1NO9w9cR59T1ZbDHa/9G+62qZ3q2MzN38+uq6vl+ns0mtT27m3vu+1TX9HT3vC4DBF7n+38Aw0RYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkOghrPS9k9fcPjPmeJfHb9L+eYXFqUke6IdiR7KwTC3/i35+vDJubZ/nFdxK1h6ftR6/9Xh+bJZVoc2SxbWLMq/Zk0evmLHqTw1LF9ZPl8zcPPS71/71ytS8u2TS0ZXfMUeTzI6z80l26wMnmfmFklmcftc//kjzgDyUK9PZ0nhx+shF9Qt+sJBvNw/9fLm9+n3Z3/xcntMbLprtRbg/Nc1uT7NZkp7MxvPjIjJo7TusfFIo5CHVYd14IR++0IR1I/lnY970yIUdV4//8mkTVj786Nw+wNy78eJ73nbRjBenT+Y/PXNh3bvxq7/yFdNiex3Wn77d/Nmr7zp2YeXhZun3l2HlH0VcZ4Slt/cZKx1V+xm7K7r620n6E29qwrr62byqv/rWqd2+OP2a7Nbjza5w8fRjs588Tt83tSFd/eRvfn22ND59oi63Cmfx7DN/+5VfLLbX3/9r32Rmj7/4vulKWO8qd4XFDvEOYfVi/7vCeTmfuF3hy2+9yP7re5dmrB/I/6L/8w0X5odL+Rroz415Y/74D5fMlx415ut++fNuhspuffXff9sXZ0sz1hvLNZmbsT6d1/TBZsbKZzBj3jx34VW7wpfKxXu5xiKsXsjXWOVzPDfh5Gus7/m9LH3Pd2dNWPkqadyEVfz1X/mH9y6tsYp5KF9X2bCefnv+806aNdZfmiufWV5jpSNzfO9G0izuL3uWCDV5WG5sF+v2WWATVrXdhbXyDaZ4bPEtblzu2k7cvjb98fzZ3nPTzIWV/1f1/XV48GLvYd27Ua6AXFhu/G67GC/X6i4st92GtfoNJv2xP1kZZ//9VfX4qYJp/cKlMWH5tO+w7t0o1u4zu+TJnxXacc2N67DcuA7rXusbmrEN84niuFQ+rsJq/cJibKoxYfm098MNV4vD5sWaqg7Ljf+g1IzrsK5O8lVYMa7DWlx9NV9guS+Y5gfWz/rcuAqr9QuLsanGhOVTDzNWHk4xrsNan7Fmz49XZqwnnh83U9jSjGSPW9kxM1bI+ltj1WG5cdca639/dvkL62smN952jfWgrz3ifuifFd67+U/FYSMblttunxUWhxOSpWeF9diF5b6hNQPZsFZ/4SXPCuvXHtEr/Yz16Q0z1m/UzxJtWLd+dMcZ6+XWjPVy6/FV2OiXfo31eJLNv6F7jfXyt1xki19q1lj/850/lC2e+/wOayy7JrO73ifMeHmNZWdA9Er+rPDX35aHc/Wdr/GssB67Z4UrX1ga168Ntp8VPvtMPiMtPSt89hlTjeuw7AFW9Kq/41huxqqfJW48jtU1Y30gX4wvzVjFrjZZmrHcuHq8OzKPXoX3rHD1C5essf54dY3l1mT1GsuNOdzgU3+vFdpnhfZZ4sbXCjueFdrFeB1W+7XCfGyqMWH5tPew5vW5BM0ZpPW4Dqs8WSFpwnLblw43LH1haVyH8h/2cEQ9Y63+wvXHw4v9n0E6Tkfl33sdlhvXYZ0+/uLohePmREC33Z34Z79QL97duF68P/1YOnpz5sJq/cJibJYfv+c/H7a0/7CS/CNbCsuObVhv/ffTl55r1lhu+8dKpvkBNiw7rkL50qMfXZy+c7oU1sovLMbmlLC804VlZ6R2WHZ8n2E1401h2RP94IPuYooPlYwb27Ds2IZlxy4s+wUblh3bsOzYhmXHNqzVx+/5z4ct6Z4V1mG5cddrhXZch9X8gH29VggfIgirPjthLazWro6wghJBWF1XRrdDI6yQhB+WOyC6esCVsMIWflju/KxNYbkZjbAC0F9YrV3Z1mG5y782heUW+62wOIPUh/7C+q3SzmFdct1gvb0rrNSsLvY5g9SH4MNqxtuGNavuUsQZpF4NL6x7N0212OcMUp8CDMset9oyrJkp7txwyWKfM0h9CjAse9xq27DycJav6rmVmGqxzxmkPvkPq55xXFjuuNX2M9by5WKc6BeGAMKqZhwXVud1hd0zVnHzme7DDfAhgLDqM0ptWO641a5hcYA0JB7Cqm6Etjxjlbe7qsNqjlvtunjnJZ2Q9B9WMR3Nks6wmh+w6+EGwgpJ/2HdrV5g6Vy8u2940LA4g9Qn/2HZ7XsPq3UiIHrlaVc4JqyB8794t9sJa1D8H26wY8IaFMKCRA9hVS8q7x5W58USm7YTVgB6CKt+W7mdw/pI4TXC2nT5F2H5pA/L3l2GsA6KPix789pNYa3t2rrCsudrEVbI9GHVLypvDKu1vTsse74WYYVMHpZ9UXnjVTrbhtW68dradsIKQjiHG7YNy52vRVghiy8sd74WYYXMX1jtXeOWYTXnaxFWyPyF9TOl+1i82zFhhSy8sNwZoXVY62eI1t9AWCELMCx7OZcNy44JKyYBhmWf9TUz1uV3myGskAUYlr3qppmxqjFhxYSwIBFgWCzehyC8sNwXONwQs/jD6rxglbB8GkBYa4cjCCsAAwhr7XAEYQXAf1j2SuitT/Sz42bGaj1rJKwABBBWfRujXywR1kAEEFZ96vJ9h8XiPUT+roRemrHKu83cb1jt7S40wvLJ322MNoa16brCrrASM7/sDFP0yt/dZtqL97Ww/qhwXzPWpacuo1f+w7Lb9xZWYqrFvN3OW5744O82Rr2FxVue+OB/8W6373FXuLJ45y1PvPB/uMGO9xVW+3ADb3nihS6sDVfh7B5W+1nilmGVl4ulI5MsTgmsP7qwnlr9i+9zxmo8VV8u9ndJcYxjke8Ti7xmTx69Ylh4SQ0yrPXts3zddXua5R+zJD2ZjefHCxZeUuGF5Rbf+wwryxbXq7DyjyKuM8LS0odlD4BuHZY9v2qfYZ1PFterXWHx+Q5hyfUQVn32wg4zltl7WOnoaFIt3ss1FmHJ9TJjXXrjtfazxqUZqzrAud9dIfrVy4xVvsjcDusjq2cvENawBBjWpsU7t4qMgb/Fe1dY7gt1WGsn8tlbRXI77pD5O9ywdVitq3DcrSLbu0bCCkkEYbWuwpmbjpuEEFZI/L1WuMOMtXKxhLtVJGGFTBdW6w0B9hVWc6tIwgqZ/7A2nZrceVMQwgpZf2G1d40urK7rCjcdxyKskPUW1tr2pRnr8usKCStmAYTVdfkXYcWMsCARQFj3e10hYYXMf1h2vPYSDWHFLJiw1h+w6WIKwgpZRGExY8WEsCBBWJCIPyxuvBakAYTFXZND5C+s9rO8tQdsP2Nx1+TweAtr8w/Yfsbi5rbhCTisLY9bubDc4wkrAOGGtfYDNy3ef79AWIGIPyw3JqyQDDisDU8OIDXgsFbvKIh+ERYk9GHZxfUD/0DCikkPYdVHxh/4BxJWTHqZsfZyU1nCikovM1Z5APOBfyBhxYSwIBHh4t3eH4uwQhbh4QZ7fyzCCll8YXXeH4uwQhJfWJ33xyKskMQXlrs/Vvu0GsIKSXRhNffHciHV2wkrJNGF1YwJK2SEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAg0V9Ys/VLddKzXX7gfYa1r1OjsRN9WHffb5J0dPS50yvTLLs7Sc/m+V90OroyTUcP9xLWnq5rxE70b4Q5S+bj80l6Us5YRVh38/kj/8LZ+WQ+3uUH3v+MtZfrGrETWVhO3tLHb04X12efuGEe+UIeVDoyyS1j3nJz2s+ucE+Xn2EnvYR15mYsO32dl7PWbjNW56nI7TFhBaCfsPI11mRerLHm5uFykM9a477WWCzefdCHtS8cbogKYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkDiUsBbXs8WpSYp/evx/PmB7Duv/Cqp/512tjPOOLh0bY1b+bbcni2vVeHFa/vsVM7bbsW8HNGPdnma3n58W/5ol6clsPD9elHfJhcJBhpV/FHGdEZbOAYU1y3eFd5Iipuq/CEvpgMJqFu/FZ2YsrUMJCz0jLEgMIKyZMccZYQUm/rCKt6koLi0jrKDEH9bdyeqYsIJAWJCIP6xyVzgmrMDEHxaL9yANIKy1cR1W614P6FWEYa3NUPX2dlit7ehVfGGtH16otxNWSOILa/1ZYHtMWAEgLEjEF9b64YV6O2GFJL6wWLxHIcKw7LgjLHsHP8LyaoBhJaa8/TZheTXAsOrbbxOWVwMMKzHlXZIJyyvCgsQAw2LxHoLhhcXhhiAQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCxPDD4s3GvTiAsJJszpsG9O4AwqpPVUavDiCsJCvPKEWvCAsSBxAWi3cfhh8WvCAsSEQUVusOfYQVtIjC+nCBsCJBWJAgLEhEHFbnmouwAhBxWJ8qEFagCAsShAUJwoIEYUGCsCBBWJAgLEhEGJZ9AwHCCll8Ybl3/yKskMUXlnuTJsIKGWFBIr6w3Lt/EVbI4gtrbfHe9WbjhOVThGHZcR3W+lv5ElYA4g9r/R1XCSsAhAWJ+MNafytfwgpA/GF1Lt5bpy6jVwMIy47bYX2oQFieEBYkCAsShAUJwoLEoYS1uJ6lI5MsTrltZD8OJKx0dFze4naWLK5dZEVesyePXjHjPv8AhyWisNqX1HeH1ViesWbmaHJ7muUfsyQ9mY3nx0Vk0IgorPaN13bdFRafqrDyjyKuM8LSOaCwzieL69WusPh8h7CkDiisdHQ0qRbv5RqLsKQiDmvTbYw43OBThGGtvehcbyeskMQX1voZo/V2wgpJfGGtn9jXHhNWAAgLEvGFtX7GaL29K6x6TYZexRfWrot3uyZDryIMy463DOsu79DkA2FBYvhh2TUZejX8sFi8exFRWJve/ctt53BDACIKa9OM5V6UJqwAEBYkCAsShAUJwoJEhGF1vaTTvkkIYfkUX1id52O52xqZajth+RRfWJ2nzbgbsbErDABhQSK+sDrPx1reFY4Jy7P4wmLxHoUIw7JjDjeEjLAgQViQiCisXU+b4a7JPkUU1scKrxHWHxaWwmptR68ICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgMcCwOk5dRq+GF5a7rpCwfBpeWO7yL8LyibAgMbyw3HWFhOXT8MJi8R6ECMPqumCVww0hiS+szrvNEFZI4gur86YghBUSwoJEfGF13m2GsEISX1gs3qMQYVh2XIdz9/0mSUdHn6vDSs/m5miSjq4QllfxhzVL5uPzSXriwrqbPyb/AmF5FX9Ydyfpx29OF9ddWKkxyS1jCMurQYR1tjRj5dOXSU/OJ6yx/BpGWPkaa1KH9XA+YxVrLGYsv+IPy415VhgSwoLEgMJq39GPsHwaUFjMWCEhLEgQFiQGGBZnkIZgeGFx+VcQhhcWV+kE4XDCKmaxlvRM+P974IYXVvvyL3tazemVaVa+/lOfVjNNRw8Tlszwwmov3u1pNeWMVYRVnNt8Xr5yPR/3/8c4FAMMq3W4wZ5WM/vEDfPIF8pXrMvTat5yc8quUOcgwjo7f3X0+k++dGqSf3mHeayYvs7LWYsZS+cwwkrfcfTZb3zog4trf22+9vv+bfT6kXnUfPOXfYf59r7/EIcjorC2f1u5RrN9ntyeZrefz/+Z5suufMk1nh8vrl30+kc4JPGE1dZ9nOqyww2L61kTVv5RxHVGWDoHEtbiuWKeWly7kxQxVf9FWEoHElb+LPB4kS/ei3/yzPLPzFhaBxIW+kZYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCRMRhtW4dubSl+kxYPkUc1l8UCCtQhAUJwoIEYUFiwGF1Lu7RgwGEVb8p09KW6vOnCoTlSfxhzY/b70VIWAGIP6ziXeJaW6rPhOUTYUEi/rDKXeHK+8MRVgDiD4vFe5AGENb6luozYfl0OGHxLva9Gn5YvIu9F8MPi3ex9yLisDadj2VnLN7F3od4w+q2FtaZm7Hs9MW72KsdRlj5GmsyL9ZYc/NwOchnrTFrLKXhhwUvCAsShAUJwoIEYUGCsCBBWJAYcFhcTOHTcMOCV4QFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBxIGHVV+Yki1OzfqU9BA4krPPJ/HieFNcVLq5dZEVesyePXjFcVygzyLAazRfnycwcTW5Ps/xjlqQns/H8uIgMGkMM6zKL6+WnKqz8o4jrjLB0DiSsxXPTfHe4uF7tCovPdwhL6kDCumXMcbGArxbv5RqLsKQOJCz0jbAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxKEBQnCggRhQYKwIEFYkCAsSBAWJAgLEoQFCcKCBGFBgrAgQViQICxIEBYkCAsShAUJwoIEYUGCsCBBWJAgLEgQFiQICxL/D5HQxwbd+frMAAAAAElFTkSuQmCC" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

# more soil properties
data(sp2)
d.1 &lt;- profile_compare(sp2, vars=c(&#39;prop&#39;,&#39;field_ph&#39;,&#39;hue&#39;,&#39;value&#39;), 
max_d=100, k=0.01, plot.depth.matrix=TRUE)
</code></pre>

<pre><code>##        id prop field_ph hue value
## 1   hon-1    0       22  22    22
## 4  hon-13    0        8   8     8
## 8  hon-19    0       17  17    17
## 9   hon-2    0       17  17    17
## 10 hon-20    0       12   0     0
## 17  hon-7    0       30  30    30
## 18  hon-8    0       12  12    12
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAkFBMVEX9/v0AAAAAAEYAAHMARkYARpoAdJoAdL1GAABGAEZGAHNGRgBGRkZGRppGdL1Gm95zAABzAEZzAHNzdABzdHNzvr1zvv2aRgCaRkaadACam3Oavpqa372a396a3/29dAC9m0a9/r29/t69/v2+vr7em0bevnPe35re/r3e/t7e/v39vnP935r9/r39/t79/v3kfi8/AAAAMHRSTlP//////////////////////////////////////////////////////////////wBipdB4AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAabklEQVR4nO2dDXujPHaG10lTp9sPZ7dt0u1HvG9T2neGJP7//65IGMcZIxlkHetBvu/rmhlPMDoH6Q4cBMZ/2AEY8IfSCUCdIBaYgFhgAmKBCYgFJiAWmIBYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYgFhgAmKBCYgFJiAWmIBYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYgFhgAmKBCYgFJiAWmIBYYAJigQm1i9WsOu7ffvnpx9Pq4af/6/CjdrXev9qu+pftarXJF6EZ3tX98LTh93/6ZdUJgbWpW6zPl1XP8/efj4jVHAa7E+vudTdRrMkRmuFN74+nYjUHq3eItQSa/aif7lF2vwxgJ8igRieWH+dJYk2O4N+4OX7xRefaelcZVYvldieb/uDzfLr0m1gfTwcznFhulzVFrOkROp/+5tHps73/Z8RaON2we10GRdphZ3F6KGy/Xjux3ECfrNUtuX/bfjvsTY/QifW3L917P18e/tK/xR8TncE+YBdxu7r7z87Qf3VrdQu7N3cN+KPyAqlaLDdkX4eooRzqxvpUrK8Sy43vv7vx7GU5Wsst+ftfCqrJETqx1tuu1ffH9dY33Pbv7X70JZZf+Xe/VuPe1Ew7f1CkbrH8TmHwoPH7If/3ybAflVhOn/966d7Ui3W01t6iZnV04Jocwf207d7XrjZerC7ioM9wKNxL2q/l9oW/LbiMr1usYdzduO1H2R+8Tob9qMRyYr22/k836MdruZF//vWsbWoEJ1a3t+r+fT7aD/VKfYm12R2aaff7s4VSuVj7aSM3YkOF3A3r88mwH5VYXqxOjnX761p+yX7g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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
# add some missing data: 
sp2$prop[1:2] &lt;- NA
d.2 &lt;- profile_compare(sp2, vars=c(&#39;prop&#39;,&#39;field_ph&#39;,&#39;hue&#39;,&#39;value&#39;), 
max_d=100, k=0.01, plot.depth.matrix=TRUE)
</code></pre>

<pre><code>##        id prop field_ph hue value
## 1   hon-1   22       22  22    22
## 4  hon-13    0        8   8     8
## 8  hon-19    0       17  17    17
## 9   hon-2    0       17  17    17
## 10 hon-20    0       12   0     0
## 17  hon-7    0       30  30    30
## 18  hon-8    0       12  12    12
</code></pre>

<pre><code class="r">
# note small changes in D:
cor(d.1, d.2)
</code></pre>

<pre><code>## [1] 0.9987
</code></pre>

<pre><code class="r">
## 3. identify profiles within a collection that contain all NAs
require(plyr)
s &lt;- ldply(1:10, random_profile)
depths(s) &lt;- id ~ top + bottom

# replace first profile&#39;s data with NA
na.required &lt;- nrow(s[1, ])
s$p1[1:na.required] &lt;- NA
</code></pre>

<pre><code>## Error: argument of length 0
</code></pre>

<pre><code class="r">s$p2[1:na.required] &lt;- NA
</code></pre>

<pre><code>## Error: argument of length 0
</code></pre>

<pre><code class="r">
# attempt profile comparison: this won&#39;t work, throws an error
# d &lt;- profile_compare(s, vars=c(&#39;p1&#39;,&#39;p2&#39;), max_d=100, k=0)

# check for soils that are missing all clay / total RF data
f.check.NA &lt;- function(i) length(which(is.na(i$p1) | is.na(i$p2))) / nrow(i) == 1
missing.too.much.data.idx &lt;- which(profileApply(s, f.check.NA))

# remove bad profiles and try again: works
s.no.na &lt;- profile_compare(s[-missing.too.much.data.idx, ], vars=c(&#39;p1&#39;,&#39;p2&#39;), 
max_d=100, k=0, plot.depth.matrix=TRUE)
</code></pre>

<pre><code>## Error: invalid &#39;times&#39; argument
</code></pre>

<pre><code class="r">

## alternate approach for visualizing missing data
# 10 random profiles
s &lt;- ldply(paste(&#39;soil&#39;, 1:10), random_profile)

# randomly sprinkle some missing data
s[sample(nrow(s), 5), &#39;p1&#39;] &lt;- NA
s[sample(nrow(s), 5), &#39;p2&#39;] &lt;- NA
s[sample(nrow(s), 5), &#39;p3&#39;] &lt;- NA

# set all p4 and p5 attributes of `soil 1&#39; to NA
s[which(s$id == &#39;soil 1&#39;), &#39;p5&#39;] &lt;- NA
s[which(s$id == &#39;soil 1&#39;), &#39;p4&#39;] &lt;- NA

# upgrade to SPC
depths(s) &lt;- id ~ top + bottom

# slice into regular segments
# note: this will compute slice-wise missing data
s.sliced &lt;- slice(s, 0:100 ~ .)

# however, when all data are missing, then NA is retured
# convert these into 1
s.sliced$.pctMissing[is.na(s.sliced$.pctMissing)] &lt;- 1


# symbolize missing data fraction
if(require(RColorBrewer)) {
  cols &lt;- rev(brewer.pal(8, &#39;Spectral&#39;))
  cr &lt;- colorRamp(cols)
  # assign color based on fraction of data NOT missing
  s.sliced$soil_color &lt;- rgb(cr(s.sliced$.pctMissing), max=255)
  # leave out horizon (slice boundaries)
  plot(s.sliced, divide.hz=FALSE)
  # legend
  legend.divs &lt;- c(0, .25, .50, .75, 1)
  legend(&#39;bottom&#39;, legend=legend.divs, pt.bg=rgb(cr(legend.divs), max=255), horiz=TRUE, pt.cex=2, pch=22, bg=&#39;white&#39;, title=&#39;Percent Missing&#39;)
}
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAABj1BMVEX9/v0AAAAAABQAACAAACsAADUAAEYAAEgAAFYAAHMAAHQANY4ARpoASJwAV70AdHQAdJwAdL0AdL8UAAAgAAArAAArZr0yiL01NY41V701dL01j941j/1GAABGAEZGAHNGRgBGRkZGZr1GdL1Gm95Gp/1IAABIAHRISEhInN9WdL1Wvv1exP1xxqRzAABzAHNzIDVzNTVzRppzV1ZzdABzdEZzdHNzdL1zm95zvt5zvv1z3/10AAB0AEh0AHR0dAB0v/+ONQCONRSO/v2Z1qSaPiuaPkaaRgCaRkaaRlaaRnOadHOadJqam3Oap3Oavpqa372a396a3/2cSACcnEicnHSc3/+mZgCmZj69VyC9ZSu9Ziu9dAC9dDW9dEa9dHO9m0a9vnO93/29/v2+5aC/dAC/nEi//7+////VPk/edCDeiCvem0bexIfe36be/v3fnEjf///y6pH6nVn9jzX9p0b9vlb9vnP933P934f935r93739/o79/r39/t79/v3/v3T/35z//7///9////9bpLKRAAAAhXRSTlP/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP//////pK4aAwAAAAlwSFlzAAAPYQAAD2EBqD+naQAAHu5JREFUeJztnY+fHLdZxjuUXElpgDMNBco1Nb6mGFoXXGicJWlToCSUmh9nSCgY2+VqKO2C3QI9WDiv49wfzs7O7I/RK2m0I72jmd3v93P22atnpNPoOT2zWs3ux+YACnws9w8A+wnGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhV6Ntbsc2eLr9U/wzTTojhtUT57tyiOAxq9XxSTkJ/t2buBtR05+rAtuwj62Ra9dPbTaDSgtvKEuHvaB/3PWPUJmp24B6Wh2Rpvp3L68vnlLd+JrGQXR2cXL5+3/2yLUXYP3lr27F2nD7Zl/p9/q9H5/YCfbdGFkNqmn3ril6nTg7Hq6WT5q7Y+y7PP/eV2xz2ai6ZprMoFhrFcsmlz8Oyy2Wu/3zSWVXZ5y5w8rDJpZcfPdmH8pjnOiWksq2xhLP9vmjo9GGvR1f/9p2pSOXVFoUdjnCOH0gwvh2xqDJ5V9uzdyf2A2hZGMAbPKiszLuRnE/Frl12YGefoQnH0+X03VvnL9PJ5OVT3j53XWG6NMWPZlYuTGtSoObFZZdPjuWEsV21mGtpk5s/vqm12YhohpjbZ057p5xpr0Un/jOXRyMlfKqWvrLLFf+XwCVmZLUXxqSdttVnG2CabvRYkM0M6qgvlz+a/mlSnp2usxTCZlxQNt/g0zWeFVuX90griGkvIygebDnS0a85Ydtn9sNqmtksxi8y0srPRgNoO8VkhHAQYC1TAWKACxgIVMBaogLFABYwFKmAsMLi8lWIJLJ+xLibLP5dvJJElru5wZJLp5PL2k6W9pteP7rq38vjpzViFQd3x2cmxV1YEyuzVITNPnGdYVg89PC+/ppPZjenpxXFpsi70Z6zvNyjKl+nLlx2M36jiy00Kh+wzTRzVhcrMRodUW1KZHBb5UGWsxVdprjvjM9Z//sa8/PN/v9qUmaPikInzaNWFyoQVBlRbUpkcFvlQFYXl349GbKzZyc83ZXZjCZnjPBq6UJnDCoOoLalMDot8qLp4X15jjdNY5VQdMGPZZfI82nShMmmF4dSWVCaHxVsaQe4ZiyhM1IUwmRwWb2kEuY1FFCbqQphMDou3NAKi0NbokGpLKpPD4i2NIPeMRRQm6kKYTA6LtzSC3MYiChN1IUwmh8VbGgFRaGt0SLUllclh8ZZGkHHl3fpallx5t8vEebTqQmXCCgOqLalMDou3NILcUcg1VqIuhMnksHhLI8htLK6xEnUhTCaHxVsaAS9C2xodUm1JZXJYvKUR5J6xiMJEXQiTyWHxlkaQ21hEYaIuhMnksHhLI2C5wdbokGpLKpPD4i2NIPeMRRQm6kKYTA6LtzSC3MYiChN1IUwmh8VbGgFRaGt0SLUllclh8ZZGkHvGIgoTdSFMJofFWxpBbmMRhYm6ECaTw+ItjYAotDU6pNqSyuSweEsjyD1jEYWJuhAmk8PiLY0gt7GIwkRdCJPJYfGWRkAU2hodUm1JZXJYvKUR5J6xiMJEXQiTyWHxlkaQ21hEYaIuhMnksHhLIyAKbY0OqbakMjks3tII2Jpsa3RItSWVyWHxlkaQOwq5xkrUhTCZHBZvaQS5jcU1VqIuhMnksHhLI2Brsq3RIdWWVCaHxVsaQe4ZiyhM1IUwmRwWb2kEuY1FFCbqQphMDou3NAKWG2yNDqm2pDI5LN7SCHLPWIFRODt5qfGRhUQhUVgTF4UP/uqrzTcJdpzHQYQXUTgfTxRefrXxpvZEIVFY45yxjIzrJQqN6sYYhWYXwmqTw+ItjaA/Y/2kwarjIuPsxvrH176XMgqNVscYhWYXwmqTw+ItjSCjsewZZ4/C+0XxCw2ZPI87BUSz1VFGodGFsNrksHhLI8g9YxGFiboQVpscFm9pBLmNJTKulyg0qhtjFJpdCKtNDou3NILcUSgyrpcoNKobYxSaXQirTQ6LtzSC3DPWPkShbrAGNhpWmxwWb2kEuY21D1Go+xwzsAthtclh8ZZGQBTaGh3Sc8zALoTVJofFWxpBPmOxNTlpF8Jkcli8pRHkjsL//vRRyDWWkMlf0F0uUIzqIq+K0tbWsdGw2uSweEsjyG2sbxaF/7m6Q+Y4j4EXKEZ1kVdFaWvr2GhYbXJYvKURZIzCauvscsrekokotMvEedxtw26zutjNxGlr69ZoWG1yWLylEeSesVhuSNSFsNrksHhLI8htrH1YbtBdxw9sNKw2OSze0ghYbrA1OqR1/MBGw2qTw+ItjSD3jNWacZXsohhRFA5JdrDGas24SvbvX/le2w7S4UShQxa4gypQRhTWhEahMNZK1naNNZwodP1sgTuowmREYU1sFP7sr3hlcTlCFCYnt7ECo/Dvzn76a15ZXI70EoVZZEThSiaMtZTNTj7+h15ZXI70EoVZZB1mrNnJ0dnlrWIiS3Yh94xFFOrKOhjrwdnF8XRyefvJvLTX9PrR3eLUW4eV3MZKHIUdc+SAo3DD5sGLycPz+eJrOpndmJ5eHJcm25U9i8KOOUIUbnP5xrwy1uKrNNedkRmLKOxB1sFYl18p56rSTOXfj0ZqLKJQV9bhWWG5ZlhdvC+vscZnLKKwB9nBrmMNOgqHnHEskNaMMQrTvmw3lihMA1E490Rh0pftiEIVQu/SMU9QLZvPbnhle3tfTVqZHBZvaQS5o7D19ptK9t3ipd/0yuzVhcocUdixtiHJDnDGqjr+zbbbbyrZv518/Atemb26UJnDWB1rG5LsAK+xAm+/qWUXL597ZTveuxJ4X0232gYlO9QoZLlBV3awUTjo5YYhryOw3FAzxuWGIa8jsNxQQxQShSoQhUShCkQhUahCP1Fo3NhKFB6ssbpGocMKxo2tRCFRuJIJY9mj0B1eLaebKGwOi7c0gtwzVtcodMwxho4oPFhjJY5CQ0cUEoUrmTDWTlFo6IjCg52xiEJd2cEaiyjUlRGFK5kwFlEYIzvAGStua7KwglVn2aXE1uTm+faWRpA7CrtuTXaEl6FzBUTgvt6fFsPdc8zW5JrEW5MdxjJ0rtMduK/3g9a4YWuyi7FuTZbhZdNZAmKnfb1pa2NrsgaDXm5wyNLWpitznBDz/Iph8RXGkNtYw1hucMjS1qYrc5wQ42ZuOSy+whhYbvDI0tamK3OcEONmbjksvsIYcs9YRGEiGVFIFKrIHCfEPL9iWHyFMRCFHtkeRKF5fsWw+ApjyD1jEYWJZEQhUagiIwqJQhUZUTiEKAy8mSdLFKreaCSHxVcYQ25jKUehQxZ4M0+WKFS90UgOi68whj2PQndAhNzMkysK9W40ksPiK4wh94ylHIWxiZklChV3V8th8RXGkNtYeaIwMOOyRKHq7mo5LL7CGA4zCgMzLksUqu6ulsPiK4xhz7cmB8rE4EVtdI6Uae6ulsPiLY0gdxQqb00OlMlZQWGjc6CsY6OOnprnVwyLrzCG3MZS3pocKHMMXtqNzoGyjo06emqeXzEsvsIY9nxrcqBMDF7OrcndGnX11Di/Ylh8hTHknrEClxvmz/701xsyxy8oyw1GT1luWMnsxnrwFz/32w2Z4zyy3GD0lOWGlUwYayn7n1dZbvDX5ujpAS437Lby/ubv/nFDNqQo7PiycVyjRGFNXBROmy+gDSsKO75sHNcoUVgTF4XPvvN7bTNW1ijs8rJxdKNEYcmgotB4khkdhQPYD00U9hqFjlExnmRGptIg9kMThb1GoRwV25PMyFQaxH5oorDXKHT8uhvVEYXpyW2sPFE4bb3cJgojOcwoNKojChs8+/b55a3C+xJjO7lnLKKwc6NqUXjx8vl0cnn7yby01/T60d3i1FeFndzGIgo71mauynaNwg2rh55958/PH57PF1/TyezG9PTiuDTZrhCFHtnAo7DlGqtrFF5MHtbGWnyV5rozLmPttDW57GxDJs7jTvt6jepidwmn3cHcrVHXCdl9a3I5nVdRWP79aPDG+n6D1VRtvDFxbBQG7usNjMIsO5g7Nuo4IZ22Jj+sL96X11gjNdYHrVFYvQZz8VLQxXvgvl6jushdwml3MHds1HFCvrn/W5NNYzn2HJvnsZKVF5QNmZz5d9nXa1QXu0s4y1s1B27C3v+tyfYZq/UzeR3LDY7f49BXl/dhuSHo5fYDWHm3G6v14+kd11iO0x346vIeLDcE7jw7gJV3YSzbk+vg5QZ5und5dXkPlhvC3/5k31+E7iUKQzOOKFwd5yuMIbexEkdhYMYRhevjfIUx7FkUBmYcUbg+zlcYQ+4ZiyhM1ChRSBSqNEoUEoUqjRKFRKFKo0QhUajSKFFIFKo0ShQShSqNEoVEoUqjRCFRqNIoUbgyluPtkM3z6NiaLE73TnuO2Zq8Ps5bGkHuKBRvh2yex5xRmHaXsLELu59GD+Bdk+3GEm+HbDeW2JrsON2Be451tyY7xviD1ihka3IHEm9NFqd7pz3HuluTZSppbHRma3LFAS03OCaP1O9PyXLDkgNabnCMcdrFC5Ybag5ouUGOscLiBcsNNUQhUagCUUgUqkAUEoUqEIVEoQpEIVGoAlFIFKpAFGaJQuMdJeWw+ApjyG0sojBRow6Z8Y6Sclh8hTEQhR7ZmKLQITPeUVIOi68whtwzFlGYqNEwmRwWX2EMuY1FFCZqNEwmh8VXGANR6JHtQRSa51cMi68whtwzFlGYqNEwmRwWX2EMuY1FFCZqNEwmh8VXGANR6JERhd3hLh2PLPENM2nv+ekkk8PiK4whdxQe0F06aT+OoJtMDouvMIbcxjqgu3TSfhxBN5kcFl9hDNyl45GN6S6dMJkcFl9hDLlnrGEsN/xrk+DrGJYbnOQ21jCWGxzGenDWuEGd5YYdYLlh7jbW7KTtpniWG1zknrEGGoX2LrhqIwoluY010Ci0d8FRG1FogSicxxiLKHSRe8YiCttqSyqTffIVxpDbWERhW21JZbJPvsIYiMI5UahB7hmLKGyrLalM9slXGENuYxGFbbUllck++QpjIArnRKEGuWcsotCsLfTz0onCCqIwUBb4eelEYQ1RGCgL/Lx0orBm0FuTuxoramuyQ6a6bVr2ST40Oykml7cK75357eSOwmFsTY6Lwgd//WeN8HJkXOAOZtVt07JPG1YPPTibz6eTy9tP5qW9pteP7hanvirs5DbWMLYmxxmrPeN22cGsum1a9kk88uy9zx+dLSbNxdd0MrsxPb04Lk22K2xNnsdEobU2mXG77GBW3TYt+yQeefbe2eUblbHKTF6Y6864jLVHyw1GbY6pKHRVQvMubdkn+VC5b7aKwvLvRyM11j4sN5i1ORwTuNygepe27JN8qNw3W128L6+xxmesvVluMGuTjtlluUH1Lm3ZJ19hDLlnLKJwcFGYhtzGIgoHF4VpIArnRKEGuWesPFH4X58ufmdbRhQmJ7ex8kThD4nC1XG+whgOMwqnRTNHiMLk5J6x8kTh7KRo/LoThcnJbaw8UfjdLzTflIEoTM5hRuGPip/50raMKExO7hkrcRSaT/ccMqJwfZyvMIbcxkochebTPYeMKFwf5yuMYc+i0Hy655ARhevjfIUx7NnW5Pm85a3S7LKuxrJvJhaOGdfW5DTkjsLArck/Mj7P0TXz/8OrRUhAmLJeonCYW5N9hTHkNlbg1uT2GWt18d72HnxWWZyxzM3EDseMZGtyIkayNXlaNJzg3Ilr6EJlnaNwD7cmJyL3jBW43GCsDwSvIwTKWG5ITm5jBS43GOsDwesIgTKWG5IzkuUGY30geB0hUMZyQ3Jyz1hEIVEYB1FIFKpAFBKFKhCFRKEKRCFRqAJRSBSqQBSmjcJu7ygp++QrjCG3sYjCjlHY7R0lZZ98hTEQhfNxRmG3d5SUffIVxpB7xjJm9IOOwsD9WDFPHmWffIUx5DaWMaMfUhSKRitjdXz7CYfsYKPQmNEPKQodxprP22asiCePsk++whhyb01u3cFn3Uu8F1uT0zbq7OmBbk1uvf3Gupd42FuTHTLzzZV7afRgtya3vh2ydS/xsLcmO2StUajR6MFuTW59O+QRbk0OlPXS6OFuTW67xXmEyw2Bsn4aPdTlhsBrrFEtNwTKemn0YJcbWm9xHuFyQ6Csl0YPcLlhhFEoZFFr5b1EofnKhqjeVxhDbmONKgodxhpyFJqvbIjqfYUxEIXzaGN1XCvvJQrNVzZE9b7CGHLPWOOOQrvM0WieZ4XG+RXV+wpjyG2scUehXeZoNEsUmudXVO8rjIEonPdgrHxRaJ5fUb2vMIbcMxZRSBTGQRQShSoQhUShCkQhUagCUUgUqkAUEoUq7MPW5K5WsL+kmLa2MJms3lcYw0iicBhbk4nCcHIba1Rbk+OsYG4mTltbmExW7yuMga3J8x6iMN/WZPP8iup9hTHknrGMT1UKXm4QoxJ4jdXHcoPjZ0t1jcVyQwOHsX7YcbnBMXgPzgaw3OD42bjGUsGx3GB8qlLwcoNj8GYnbddYPSw3OH42c9tWZ2MpLzcspvPTy1vFxHdYO7lnrNYl9dAotDfq+D3uOQqjZI4upIrCDauHposLs0eTy9tP5qW9pteP7hanvirs5DZW65J6aBTaG3Wc7p6jMErm6IJiFN4/OlvMrYuv6WR2Y3p6cVyabFdyR2HrknpoFNoblac7RxRGyRxd0IvC+5Nn3/7a0lhldC/MdWdkxiIKY7qg96zwwdmz9/5gGYXTxd+PRmosorBjF/SicHPxvrzGGp+xiMKYLvAidA1R2FHm6AILpDVEYUeZowsskNYQhR1lji4QhTVEYUeZowtEYQ1R2FHm6AJRWEMUdpQ5ukAU1hCFHWWOLhCFNURhR5mjC0RhDVHYUeboAlFY47hLp/X2G4es66j0cZeOsrG4S6eBIwpbb79xyDr/uvdwl46ysYjCBs497y13SThkcaOie5dOL8biLp0ax106rbffOGRdR6WPu3SUjcVdOg1Ybugoc3SB5YYalhs6yhxd4BqrhuWGjjJHF1huqCEKO8ocXSAKa4jCjjJHF4jCGqKwo8zRBaKwhijsKHN0gSisIQo7yhxdIApriMKOMkcXiMIaorCjzNEForCGKOwoc3SBKKwhCjvKHF0gCmuIwo4yRxeIwhqisKPM0QWisIYo7ChzdIEorGFrckeZowtsTa5ha3JHmaMLRGENW5M7yhxdYGtyDVuTO8ocXWBrck2e5QYh24NrLJYbGuRZbnAYy/ycgREai2usmjzLDQ5jmZ8zMC5jsdywzUCicHwyotDPQKJwfDKi0M9AonB8MqLQD1HYUeaYiozP4yMKicIdZV9usjpxPyQKK4jCjjJprOUZMT6PjygkCneUOWYsc0sZUUgU7iZzGMvcUkYUEoW7yRxRaG4pIwqJwt1kcVFofpi7qN5XGENuY4mMM89jJfujLxGF/igMe/Ioq/cVxjC4KBTGKmWf/dYvE4X+KHTIzA9zF9X7CmMY3NZk8wQtZW++d8aMtXKMfedPmExW7yuMIXcUij3H9ijsujV5D2SOjDN3V4fJZPW+whhyG0vsObYb6+9f7baDdA9kDseYu6vDZLJ6X2EMg9uaLKKwlL353ucx1jrjrLurw2Syel9hDLlnLLGOYJ2xPvstotCYiszlhjCZrN5XGENuY7Hc0NFYgcsN5vkV1fsKY2C5Yegy6ZhdlhvM8yuq9xXGkHvGIgp3NxZRuA1R2FFGFPohCjvK+o/ChRUvbxWT8o/vUD+5ZyyicHdjKUfh7OR4Pp1c3n60+PNkabHp9aO7xamvGkluYxGFHY2VKgo3rB9bHPHwfP7wa+flt+lkdmN6enFcmmwXiMKhy7JE4cZY5bsgLcx1ZzzG4kXojsZSfxF6ccQmCqt/DdlYBvZ3URCyIlAW1uheyOxvPxEmk9VbHmtcvC+vsYZsLIH1XRQ6yw6IpCdu/MsNMEgwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQ4UCNJTaDwM60nGGtoRu4sa4gEoxlA2NFg7FsYKxoMJYNjBUNxrKBsaLBWDYwVjQYywbGigZj2cBY0WAsG30Z63G1lvjKj3c56OnN6vuLt4rqX0+La4uqLJXYHusLjGWjN2N98gdXpUN2McCLtzbGqo57XBpraGAsG/0a6+rpJ94PP2bLWL/49aUvv/4NjLUGY5XUxnpevFMGWrGMtse/dK9YGG3x38pu9eMf3bv5uAzND18viuqoF29de/xOefS1x3UUrspW3xePrQ67WubuJ/+mOrQHMJaNDDNW+efD12+W439z9VBZunr8o3sL9y28tD1jXXteTlWP36mNVck23ytj1Yct23paYKys9GusD1+/VnlqaaXlY0srlBZaP750SmmVbWN9+MUfXL14+/3aWM/rRF19r4xVH7as6KN7GCsrPT8rvLYyw4evv1M9lSv/sWT9+Ef3lrNT01gf3Xvn6vkrP66NtXqauH66uDRWfVhV0VOMlZWeo/CqupIqMY21ftxqrKun164e37xaXWMtjVoeWH/fNtZTjDUA+jfWOr6sM9ZVmWI2Y334xX95+/2Nsa6qS7HVd2asodG/saprqXL0lw5ZXmOVplg/bjfWi7f/trxI31ogXVmyTtX1YcvHucbKTP/Gunq88FT17G3pkDK5lpPM6nG7sarnkKuL9+WqxSfeX31vGItnhUMgg7GWV1MrE1T/3axjXduKwrU7lsZammg1Yz0vqoNW3xvGKi+8Xvnn3l7kwVg29vZF6P5ePcRYNvbQWMtrrPVzAn0wlo09NNYyH4vefIWxrOyjsXoGY9nAWNFgLBsYKxqMZQNjRYOxbGCsaDCWDYwVDcaygbGiwVg2MFY0GMsGxooGY9nAWNFgLBtrYzXfpG73s3u4h2MsGxtjfWaLDmPzJ1t0OPwnW3Q4/D+26HB44wN+dz665QxrDd3IjfW83jzVdnYdxmoevtqJ9eKtolmty1iNw8VRm8Mdxto+vLwFsXp1WrbuNFZ5c1Br11vOsNbQjdtYz1c367WdXbuxmoc/LW4uHrm2ve99dbjdWM3DxVGbw+3Gkj/88h5/2brLWC/eCtiHirFstBir2pbpHtHN2bUaq3l4NcblXQ7iTge7sYzW3fdH2I1l+eHL7c+W1h3Gel6EbHDGWDZajFXd4VD97T+7VmM1D6823y23qJtToN1YRuviqM3hVmPJH776t2zdbqyFOuReH4xlo9VYpRfWdzV4zq7DWPLwx+W9zr9Vv33D+nCHsbYPl0dtDncYy2x9ufPe0rrzGgtjdaXFWMs7GEIusuzGshxeXmetb/naHG41VvNwedTmcKuxROvVPy2tY6zk9G2s55tnY9sXPyHGkkdtDg8z1vabKDVax1jJ6TkKn25F0POtfekhUSiP2hweFoXbd+40Wu/bWJdvzGcnR2eXt4pJ96EbubFurkfIf3a9F++rwx9vX9qEGEu2vpOxmoc3pr6cxpqdHM8fnF0cTyeXt5/MS3tNrx/dLU53G7pRGyvpcsNivtrcFN8ctJDlBnnU5vCg5YbaYpbWVY1l+TSnxYw1n19MHp7PF1/TyezG9PTiuDTZLozaWEkXSNdP/Jcj/tG9rdkrZIFUHrU5PGiBtLaYpXVNY9kojbX4Uxlr8VWa686+GsvxQmzoSzoth5djXL9R0fKWeOPOv5DD5VE7Hr6+dg9tXdNYl18p56rSTOXfj/bXWNCVbsa6XxTH1cX78hoLY4GJ2npCCxhrz8FYNjBWNBjLBsaKBmPZwFjRYCwbGCsajGUDY0WDsWxgrGgwlg2MFQ3GsoGxosFYNjBWNBjLBsaKBmPZKCCaTEM3bGPBaMFYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVMBYoALGAhUwFqiAsUAFjAUqYCxQAWOBChgLVPh/6XXKNehBKakAAAAASUVORK5CYII=" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

## 4. better plotting of dendrograms with ape package:
require(ape)
require(cluster)
h &lt;- diana(d)
p &lt;- as.phylo(as.hclust(h))
plot(ladderize(p), cex=0.75, label.offset=1)
tiplabels(col=cutree(h, 3), pch=15)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
## 5. other uses of the dissimilarity matrix
require(MASS)
# Sammon Mapping: doesn&#39;t like &#39;0&#39; values in dissimilarity matrix
d.sam &lt;- sammon(d)
</code></pre>

<pre><code>## Initial stress        : 0.36870
## stress after  10 iters: 0.21186, magic = 0.018
## stress after  20 iters: 0.14388, magic = 0.043
## stress after  30 iters: 0.12245, magic = 0.491
## stress after  40 iters: 0.12049, magic = 0.500
## stress after  50 iters: 0.11988, magic = 0.500
## stress after  60 iters: 0.11975, magic = 0.500
## stress after  70 iters: 0.11973, magic = 0.500
</code></pre>

<pre><code class="r">
# simple plot
dev.off() ; dev.new()
plot(d.sam$points, type = &quot;n&quot;, xlim=range(d.sam$points[,1] * 1.5))
text(d.sam$points, labels=row.names(as.data.frame(d.sam$points)), 
cex=0.75, col=cutree(h, 3))


## 6. try out the &#39;sample_interval&#39; argument
# compute using sucessively larger sampling intervals
data(sp3)
d &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01)
d.2 &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01, sample_interval=2)
d.10 &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01, sample_interval=10)
d.20 &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01, sample_interval=20)

# check the results via hclust / dendrograms
oldpar &lt;- par(mfcol=c(1,4), mar=c(2,1,2,2))
plot(as.dendrogram(hclust(d)), horiz=TRUE, main=&#39;Every Depth Slice&#39;)
plot(as.dendrogram(hclust(d.2)), horiz=TRUE, main=&#39;Every 2nd Depth Slice&#39;)
plot(as.dendrogram(hclust(d.10)), horiz=TRUE, main=&#39;Every 10th Depth Slice&#39;)
plot(as.dendrogram(hclust(d.20)), horiz=TRUE, main=&#39;Every 20th Depth Slice&#39;)
par(oldpar)

</code></pre>


<hr><div align="center">[Package <em>aqp</em> version 1.4-7 <a href="00Index.html">Index</a>]</div>
</body></html>
