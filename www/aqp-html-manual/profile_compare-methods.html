<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Numerical Soil Profile Comparison</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for profile_compare-methods {aqp}"><tr><td>profile_compare-methods {aqp}</td><td align="right">R Documentation</td></tr></table>

<h2>Numerical Soil Profile Comparison</h2>

<h3>Description</h3>


<p>Performs a numerical comparison of soil profiles using named properties, based on a weighted, summed, depth-segment-aligned dissimilarity calculation. If <code>s</code> is a <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code>, site-level variables (2 or more) can also be used. The site-level and horizon-level dissimilarity matricies are then re-scaled to [0,1] and averaged.
</p>


<h3>Usage</h3>

<pre>
pc(s, vars, max_d, k, filter=NULL, sample_interval=NA, 
replace_na=TRUE, add_soil_flag=TRUE, 
return_depth_distances=FALSE, strict_hz_eval=FALSE,
progress='none', plot.depth.matrix=FALSE, rescale.result=FALSE,
verbose=FALSE)
</pre>


<h3>Arguments</h3>


<table summary="R argblock">
<tr valign="top"><td><code>s</code></td>
<td>
<p>a dataframe with at least 2 columns of soil properties, and an 'id' column for each profile. horizon depths must be integers and self-consistent</p>
</td></tr>
<tr valign="top"><td><code>vars</code></td>
<td>
<p>A vector with named properties that will be used in the comparison. These are typically column names describing horizon-level attributes (2 or more), but can also contain site-level attributes (2 or more) if <code>s</code> is a <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>max_d</code></td>
<td>
<p>depth-slices up to this depth are considered in the comparison</p>
</td></tr>
<tr valign="top"><td><code>k</code></td>
<td>
<p>a depth-weighting coeficient, use '0' for no depth-weighting (see examples below)</p>
</td></tr>
<tr valign="top"><td><code>filter</code></td>
<td>
<p>an index used to determine which horizons (rows) are included in the analysis</p>
</td></tr>
<tr valign="top"><td><code>sample_interval</code></td>
<td>
<p>use every n-th depth slice instead of every depth slice, useful for working with &gt; 1000 profiles at a time</p>
</td></tr>
<tr valign="top"><td><code>replace_na</code></td>
<td>
<p>if TRUE, missing data are replaced by maximum dissimilarity (TRUE)</p>
</td></tr>
<tr valign="top"><td><code>add_soil_flag</code></td>
<td>
<p>The algorithm will generate a 'soil'/'non-soil' matrix for use when comparing soil profiles with large differences in depth (TRUE). See details section below.</p>
</td></tr>
<tr valign="top"><td><code>return_depth_distances</code></td>
<td>
<p>return intermediate, depth-wise dissimilarity results (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>strict_hz_eval</code></td>
<td>
<p>should horizons be strictly checked for internal self-consistency? (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>progress</code></td>
<td>
<p>'none' (default): argument passed to <code>ddply</code> and related functions, see <code><a href="../../plyr/html/create_progress_bar.html">create_progress_bar</a></code> for all possible options; 'text' is usually fine.</p>
</td></tr>
<tr valign="top"><td><code>plot.depth.matrix</code></td>
<td>
<p>should a plot of the 'soil'/'non-soil' matrix be returned (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>rescale.result</code></td>
<td>
<p>should the result be rescaled to [0,1] (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
<p>extra debug output (FALSE)</p>
</td></tr>
</table>


<h3>Details</h3>


<p>Variability in soil depth can interfere significantly with the calculation of between-profile dissimilarity&ndash; what is the numerical &ldquo;distance&rdquo; (or dissimilarity) between a slice of soil from profile A and the corresponding, but missing, slice from a shallower profile B? Gower's distance metric would yield a NULL distance, despite the fact that intuition suggests otherwise: shallower soils should be more dissimilar from deeper soils. For example, when a 25 cm deep profile is compared with a 50 cm deep profile, numerical distances are only accumulated for the first 25 cm of soil (distances from 26 - 50 cm are NULL). When summed, the total distance between these profiles will generally be less than the distance between two profiles of equal depth. Our algorithm has an option (setting replace_na=TRUE) to replace NULL distances with the maximum distance between any pair of profiles for the current depth slice. In this way, the numerical distance between a slice of soil and a corresponding slice of non-soil reflects the fact that these two materials should be treated very differently (i.e. maximum dissimilarity). 
</p>
<p>This alternative calculation of dissimilarities between soil and non-soil slices solves the problem of comparing shallow profiles with deeper profiles. However, it can result in a new problem: distances calculated between two shallow profiles will be erroneously inflated beyond the extent of either profile's depth. Our algorithm has an additional option (setting add_soil_flag=TRUE) that will preserve NULL distances between slices when both slices represent non-soil material. With this option enabled, shallow profiles will only accumulate mutual dissimilarity to the depth of the deeper profile.
</p>
<p>Note that when the <code>add_soil_flag</code> option is enabled (default), slices are classified as 'soil' down to the maximum depth to which at least one of variables used in the dissimilarity calculation is not NA. This will cause problems when profiles within a collection contain all NAs within the columns used to determine dissimilarity. An approach for identifying and removing these kind of profiles is presented in the examples section below.
</p>
<p>A notice is issued if there are any NA values within the matrix used for distance calculations, as thes values are optionally replaced by the max dissimilarity.
</p>
<p>Our approach builds on the work of (Moore, 1972) and the previously mentioned depth-slicing algorithm.
</p>


<h3>Value</h3>

<p>A dissimilarity matrix object of class 'dissimilarity, dist', optionally scaled to [0, 1].</p>


<h3>Methods</h3>



<ul>
<li><p>data = &quot;SoilProfileCollection&quot; see <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code> 
</p>
</li>
<li><p>data = &quot;data.frame&quot; see <a href="profile_compare-methods.html">profile_compare</a> 
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Dylan E. Beaudette</p>


<h3>References</h3>



<dl>
<dt>1.</dt><dd><p>http://casoilresource.lawr.ucdavis.edu/</p>
</dd>
<dt>2.</dt><dd><p>Moore, A.; Russell, J. &amp; Ward, W. Numerical analysis of soils: A comparison of three soil profile models with field classification. Journal of Soil Science, 1972, 23, 194-209.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="SPC-slice-methods.html">slice</a></code>, <code><a href="../../cluster/html/daisy.html">daisy</a></code></p>


<h3>Examples</h3>

<pre><code class="r">
## 1. check out the influence depth-weight coef:
require(lattice)
z &lt;- rep(1:100,4)
k &lt;- rep(c(0,0.1,0.05,0.01), each=100)
w &lt;- 100*exp(-k*z)

xyplot(z ~ w, groups=k, ylim=c(105,-5), xlim=c(-5,105), type=&#39;l&#39;, 
ylab=&#39;Depth&#39;, xlab=&#39;Weighting Factor&#39;, 
auto.key=list(columns=4, lines=TRUE, points=FALSE, title=&quot;k&quot;, cex=0.8, size=3),
panel=function(...) {
    panel.grid(h=-1,v=-1) 
    panel.superpose(...)
    }
)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
## 2. basic implementation, requires at least two properties
# implementation for a data.frame class object
data(sp1)
d &lt;- profile_compare(sp1, vars=c(&#39;prop&#39;,&#39;group&#39;), max_d=100, k=0.01, 
plot.depth.matrix=TRUE)
</code></pre>

<pre><code>##     id prop group
## 1 P001   17     0
</code></pre>

<pre><code class="r">
# upgrade to SoilProfileCollection
depths(sp1) &lt;- id ~ top + bottom
op &lt;- par(mfrow=c(1,2))
# perform comparison on SoilProfileCollection object
# compare soil/non-soil matrix plot
d &lt;- profile_compare(sp1, vars=c(&#39;prop&#39;,&#39;group&#39;), max_d=100, k=0.01, 
plot.depth.matrix=TRUE)
</code></pre>

<pre><code>##     id prop group
## 1 P001   17     0
</code></pre>

<pre><code class="r"># plot profile collection
plot(sp1)
# annotate max depth of profile comparison
abline(h=100, col=&#39;red&#39;, lty=2)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArwAAAK8CAMAAAA6ZJxxAAAB8lBMVEX9/v0AAAAAACAAADUAAEYAAFYAAGUAAHMAIAAAIHMAK4cANZoAPl4ARkYARpoAV1YAV70AZXMAdI4AdJoAdKYAdL0UAAAUAD4UX8MgAAAgADUgAD4gAGUgAHMgK4cgdN4rIDUrKwAriN41AAA1AHM1IAA1NVY1NZo1RgA1V701dL01m94+SDU+Xz4+dL1GAABGADVGAD5GAEZGAHNGFABGIABGNQBGPppGRgBGRkZGRppGdGVGdI5GdJpGdL1GiIdGm95Gp/1WAABWADVWdL1Wvv1ePgBlSDVldEZlvv1zAABzAEZzAFZzAHNzNUZzRgBzRnNzRppzVzVzV1ZzZnNzdABzdEZzdFZzdGVzdHNzdL1zj3Nzm5pzm95zp5pzvr1zvt5zvv1z3/2ONQCaNQCaPgCaRgCaRkaaRlaaRmWaRnOadACadEaadJqamzWam0aam3Oam5qam72ap3OavpqaxJqa372a396a3/2mRgCmdACmm0a9ZQC9dAC9dEa9dHO9m0a9vla9vnO933O935q93969/qa9/r29/t69/v2+vr7Dm0bedCDemzXemz7em0bem3PevnPe35re397e/r3e/t7e/v39p0b9vlb9vmX9vnP9vpr933P934f935r9/o79/qb9/r39/t79/v3/AAD///+DPbqMAAAApnRSTlP/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP//1fF2SAAAAAlwSFlzAAAPYQAAD2EBqD+naQAAIABJREFUeJztnYuf5Nh11yPc0LzSgZCC8EoIBgIE08kur7GhUxhISJshOwQDO/awKx6NM8ngXVgmxaN6NmAY1xJHjr3TJgIUqgr+T+6VVJJKdVV1de+RdM6t3/cz29Orx1HP7W/fPrrP79sCIJTvm/oLAMAVyAvEAnmBWCAvEAvkBWKBvEAskBeIBfICsUBeIBbIC8QCeYFYIC8Q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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">par(op)


# more soil properties
data(sp2)
d.1 &lt;- profile_compare(sp2, vars=c(&#39;prop&#39;,&#39;field_ph&#39;,&#39;hue&#39;,&#39;value&#39;), 
max_d=100, k=0.01, plot.depth.matrix=TRUE)
</code></pre>

<pre><code>##        id prop field_ph hue value
## 1   hon-1    0       22  22    22
## 4  hon-13    0        8   8     8
## 8  hon-19    0       17  17    17
## 9   hon-2    0       17  17    17
## 10 hon-20    0       12   0     0
## 17  hon-7    0       30  30    30
## 18  hon-8    0       12  12    12
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArwAAAK8CAMAAAA6ZJxxAAAAkFBMVEX9/v0AAAAAAEYAAHMARkYARpoAdJoAdL1GAABGAEZGAHNGRgBGRkZGRppGdL1Gm95zAABzAEZzAHNzdABzdHNzvr1zvv2aRgCaRkaadACam3Oavpqa372a396a3/29dAC9m0a9/r29/t69/v2+vr7em0bevnPe35re/r3e/t7e/v39vnP935r9/r39/t79/v3kfi8/AAAAMHRSTlP//////////////////////////////////////////////////////////////wBipdB4AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAfHElEQVR4nO2dDVvjSnJGV0wIZPNhdpNANh94NxMle0eA//+/i1qyjQFL7e62eLtK5zzPncsF7HpLOldTbkvy73YARvmdOgBALsgLZkFeMAvyglmQF8yCvGAW5AWzIC+YBXnBLMgLZkFeMAvyglmQF8yCvGAW5AWzIC+YBXnBLMgLZkFeMAvyglmQF8yCvGAW5AWzIC+YBXnBLMgLZkFeMAvyglmQF8yCvGAW5AWzIC+YBXk/0zY9P35++u7rQ3P7a/jj+K2uudt/tW3GL7um2VyvQnv4rf6bX5/45Z8+PfSCwt5A3o+8PTUjjx+/f0be9ihUL+/N8+5CeS+u0B5+6eX+q7zt8f+cHfLCSLs36+uRcfdJkl7Cg369vINLF8l7cYXhFzenX7zT+3y3Wz3I+4FwWNyMf1E/fv3pB3lfH472BXnDofcSeS+v0Dv7N/dB0e2Pf0becyDvB3q1BiUPGnaHg97XsaF7/zrIG2T68qj+Jz9+bj+MCJdX6OX926f+d9+ebv80/sowP4T/S4aCfcVtc/Of/f8F/xoe1f+w/+X+CYYJZhUg70e2p3+dH8bT3qev8r6PvMGhfw/OjEKePCr85O8/DbgXV+jlvdv2z/pyf7cdnrgbf7f/1ru8w4P/OjyqDb/UXvaa0QfI+5Hh4HZwrR2Op8OfX9Q6GXmDov/11P/SKO/Jo/amts3JX/IXVwjf7frf65rNIG9f8aDoYWzY/48wPioc0/+yqpduyPuJvVvBjb1Jw1/0X9Q6GXmDvM/d8E8v1umjgl2Pn1cDLq0Q5O2Puv2/H0+Op6O27/Judsen6fbH5dWAvF8YllWDFYdX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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
# add some missing data: 
sp2$prop[1:2] &lt;- NA
d.2 &lt;- profile_compare(sp2, vars=c(&#39;prop&#39;,&#39;field_ph&#39;,&#39;hue&#39;,&#39;value&#39;), 
max_d=100, k=0.01, plot.depth.matrix=TRUE)
</code></pre>

<pre><code>##        id prop field_ph hue value
## 1   hon-1   22       22  22    22
## 4  hon-13    0        8   8     8
## 8  hon-19    0       17  17    17
## 9   hon-2    0       17  17    17
## 10 hon-20    0       12   0     0
## 17  hon-7    0       30  30    30
## 18  hon-8    0       12  12    12
</code></pre>

<pre><code class="r">
# note small changes in D:
cor(d.1, d.2)
</code></pre>

<pre><code>## [1] 0.9987
</code></pre>

<pre><code class="r">
## 3. identify profiles within a collection that contain all NAs
require(plyr)
s &lt;- ldply(1:10, random_profile)
depths(s) &lt;- id ~ top + bottom

# replace first profile&#39;s data with NA
na.required &lt;- nrow(s[1, ])
s$p1[1:na.required] &lt;- NA
s$p2[1:na.required] &lt;- NA

# attempt profile comparison: this won&#39;t work, throws an error
# d &lt;- profile_compare(s, vars=c(&#39;p1&#39;,&#39;p2&#39;), max_d=100, k=0)

# check for soils that are missing all clay / total RF data
f.check.NA &lt;- function(i) length(which(is.na(i$p1) | is.na(i$p2))) / nrow(i) == 1
missing.too.much.data.idx &lt;- which(profileApply(s, f.check.NA))

# remove bad profiles and try again: works
s.no.na &lt;- profile_compare(s[-missing.too.much.data.idx, ], vars=c(&#39;p1&#39;,&#39;p2&#39;), 
max_d=100, k=0, plot.depth.matrix=TRUE)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArwAAAK8CAMAAAA6ZJxxAAAAkFBMVEX9/v0AAAAAAEYAAHMARkYARpoAdJoAdL1GAABGAEZGAHNGRgBGRkZGRppGdL1Gm95zAABzAEZzAHNzdABzdHNzvr1zvv2aRgCaRkaadACam3Oavpqa372a396a3/29dAC9m0a9/r29/t69/v2+vr7em0bevnPe35re/r3e/t7e/v39vnP935r9/r39/t79/v3kfi8/AAAAMHRSTlP//////////////////////////////////////////////////////////////wBipdB4AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAcGUlEQVR4nO2di3bbSHZFB1IUKpMHNZNEyuQhpuNGMm1I4v//XVAASfHpLtUFeHhce6/VtloWCueytuHLwoN/WAOY8gd1AIBSkBdsQV6wBXnBFuQFW5AXbEFesAV5wRbkBVuQF2xBXrAFecEW5AVbkBdsQV6wBXnBFuQFW5AXbEFesAV5wRbkBVuQF2xBXrAFecEW5AVbkBdsQV6wBXnBFuQFW5AXbEFesAV5wRbkPaZteu6/HX33/al5+D78svtW1yw2X62a8cuuaZbT7aHd/lT/zdOB3/7paNOMHf9sIO8hHy/NyPPh98/I2+6E6uW9e11nypu9h3b7Q2+Pp/K2u785a+SFkXZj1umRcX0kSS/hVr9e3sGlLHmz9zD84HL/i096nxfr6kHeA9JhcTn+Q/18+qcH8r4/7exL8qZDb468+Xvonf2bx6To6v6fkfccyHtAr9ag5FbDbnvQO20bus+vk7xJppOt+j+5/7Y6aBHy99DL+7cv/c9+vDz8ZfyRoX9If0uGHfZ7XDV3/9n/LfjXtFX/h/0P9wMMHUwVIO8hq/1/zrftae/TqbyfLW9y6N+TM6OQe1ulP/n7owY3ew+9vItVP+rb42I1DNyNP9t/61PeYeO/Dlu16YfavPeMPwfIe8hwcNu61g7H0+HXE7X2Wt6k6H+99D80yru31cbUttn7Rz57D+m7Xf9zXbMc5O33uFV02zZs/iKMW6Vj+i9VvXVD3iM2biU3NiYN/9CfqLXX8iZ5X7vhv16s/a2SXc/HqwG5e0jy9kfd/vfnvePpqO2nvMv1bphuc1yuBuQ9YVhWTVZs3xX16jyfqLXX8g7y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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

## alternate approach for visualizing missing data
# 10 random profiles
s &lt;- ldply(paste(&#39;soil&#39;, 1:10), random_profile)

# randomly sprinkle some missing data
s[sample(nrow(s), 5), &#39;p1&#39;] &lt;- NA
s[sample(nrow(s), 5), &#39;p2&#39;] &lt;- NA
s[sample(nrow(s), 5), &#39;p3&#39;] &lt;- NA

# set all p4 and p5 attributes of `soil 1&#39; to NA
s[which(s$id == &#39;soil 1&#39;), &#39;p5&#39;] &lt;- NA
s[which(s$id == &#39;soil 1&#39;), &#39;p4&#39;] &lt;- NA

# upgrade to SPC
depths(s) &lt;- id ~ top + bottom

# slice into regular segments
# note: this will compute slice-wise missing data
s.sliced &lt;- slice(s, 0:100 ~ .)

# however, when all data are missing, then NA is retured
# convert these into 1
s.sliced$.pctMissing[is.na(s.sliced$.pctMissing)] &lt;- 1


# symbolize missing data fraction
if(require(RColorBrewer)) {
  cols &lt;- rev(brewer.pal(8, &#39;Spectral&#39;))
  cr &lt;- colorRamp(cols)
  # assign color based on fraction of data NOT missing
  s.sliced$soil_color &lt;- rgb(cr(s.sliced$.pctMissing), max=255)
  # leave out horizon (slice boundaries)
  plot(s.sliced, divide.hz=FALSE)
  # legend
  legend.divs &lt;- c(0, .25, .50, .75, 1)
  legend(&#39;bottom&#39;, legend=legend.divs, pt.bg=rgb(cr(legend.divs), max=255), horiz=TRUE, pt.cex=2, pch=22, bg=&#39;white&#39;, title=&#39;Percent Missing&#39;)
}
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArwAAAK8CAMAAAA6ZJxxAAABg1BMVEX9/v0AAAAAABQAACAAACsAADUAAEYAAEgAAHMAAHQANY4ARpoASJwAV70AdHQAdJwAdL0AdL8UAAAgAAArAAArZr0yiL01NY41V701j941j/1GAABGAEZGAHNGRgBGRkZGZr1GdL1Gm95Gp/1IAABIAHRISEhInN9WdL1Wvv1exP1xxqRzAABzAHNzIDVzNTVzRppzV1ZzdABzdEZzdHNzdL1zm95zvt5zvv1z3/10AAB0AEh0AHR0dAB0v/+ONQCONRSO/v2Z1qSaPiuaRgCaRkaaRlaaRnOadHOadJqam3Oavpqa372a396a3/2cSACcnEicnHSc3/+mZgCmZj69VyC9ZSu9Ziu9dAC9dDW9dEa9dHO9m0a9vnO93/29/v2+5aC/dAC/nEi//7+////VPk/edCDeiCvem0bexIfe36be/v3fnEjf///y6pH6nVn9jzX9p0b9vlb9vm/9vnP933P935r93739/o79/r39/t79/v3/v3T/35z//7///9////98YYOIAAAAgXRSTlP///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A//////9bDqcOAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAgAElEQVR4nO2di58cWVlAKZFhEdCJIooDxAyLixg0KhvGRdcHuyBRJrq+YjYYoyCtCT5wHJ10Nps/3a7q6emeqe/eru8+ur6v5pxfdrMMt+5U3zmpOXPT3fWROYBTPjL2CQCkgrzgFuQFtyAvuAV5wS3IC25BXnAL8oJbkBfcgrzgFuQFtyAvuAV5wS3IC25BXnAL8oJbkBfcgrzgFuQFtyAvuAV5wS3IC25BXnAL8oJbkBfcgrzgFuQFtyAvuAV5wS3IC25BXnAL8oJbkBfcgrzgFuQFtyAvuAV5wS3IC25BXnAL8oJbkBfcgrzgFuQFtyAvuAV5wS3IC25BXnAL8oJbkBfcgrzgFuQFtyAvuAV5wS3IC25BXnAL8oJbkBfcgrzgFuQFtyAvuAV5wS3I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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

## 4. better plotting of dendrograms with ape package:
require(ape)
require(cluster)
h &lt;- diana(d)
p &lt;- as.phylo(as.hclust(h))
plot(ladderize(p), cex=0.75, label.offset=1)
tiplabels(col=cutree(h, 3), pch=15)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAArwAAAK8CAMAAAA6ZJxxAAAAeFBMVEX9/v0AAAAAAEYAAHMARpoAdHMAdL0AzQBGAABGAEZGAHNGRppGdL1Gm95zAABzAEZzAHNzdABzdJpzvt5zvv2aRgCaRkaaRnOam0aa396a3/29dAC9/r29/v3em0be/t7e/v39vnP935r93739/r39/t79/v3/AABpMEyCAAAAKHRSTlP//////////////////////////////////////////////////wD/AIw85wAAAAlwSFlzAAAPYQAAD2EBqD+naQAAElFJREFUeJzt3HFz00iex+E15DxsuATuLswdMTGJ1/G8/3d4kiwG2HEZ1FHQ75t5nj/ctqdqLbo/1dVytvyPA4T6x9IXAK3ESyzxEku8xBIvscRLLPESS7zEEi+xxEss8RJLvMQSL7HESyzxEku8xBIvscRLLPESS7zEEi+xxEss8RJLvMQSL7HESyzxEku8xBIvscRLLPESS7zEEi+xxEss8RJLvMQSL7HESyzxEku8xBIvscRLLPESS7zEEi+xxEss8RJLvMQSL7HESyzxEku8xBIvscRLLPESS7zEEi+xxEss8RJLvMQSL7HESyzxEku8xBIvscRLLPESS7zEEi+xxEss8RJLvMQSL7HESyzxEku8xBIvscRLLPESS7zEEi+xxEss8RJLvMQSL7HESyzxEku8xBIvscRLLPESS7zEEi+xxMsT/Tb6/t3Nqrcenr26/XPYvVld3M/1yeLliU7G+/jhani8OWzWh93l3Tjsr7s3rub6ZPHyRCfj3b/rd9su1D7c7sU4bNeHw8NsW694eaKT8faxDjtvt+P21X4Zul1391a8LGH1VyfjfVj3j5uLz93Boav243EY4t3aeVnE6q9vnYx3O96vDceH3eWn43C3fX23e7Oe62LEyxQ/G+/m5jgOx4ftehz67xxe/5cbNhZxIt5Txvu17sn7u/7kOw79O7t/3s51MeJlip+M98+bsv4rs+6QOw5d08fv0OYhXqb4yXiP92u9/fXwV4lxeDj+3WIm4mWKn4z31xAvU4iXWOIllniJJV5iiZdY4iWWeIklXmKJl1jiJZZ4iSVeYomXWOIllniJJV5iiZdY4iWWeIklXmKJl1jiJZZ4CfJvvwm59OV8S7yctzrzamHi5Tzx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jPdh3T9uLj53B4eu2o/HoY93f3011yeLlyc6Ge92vF8bgt1dfjoOd32769k+Wbw80cl4NzfHcQh2ux6HWfdd8fIsxuNt9+T9XX/yHYfD7s2M7YqX57B7O34d1n9ltr24/2aYkXh5Bsf7td7+etV/r3scdm+6g/Cr27k+RbzEEi+xxEss8RJLvMQSL7HESyzxEku8xBIvscRLLPESS7zEEi+xxEss8RJLvMQSL7HESyzxEku8xBIvscRLLPESS7zEEi+xxEss8RJLvMQSL7HESyzxEku8xBIvscRLLPESS7zEEi+xxEss8RJLvMQSL7HESyzxEku8xBIvscRLLPESS7zEEi+xxEss8RJLvMQSL7HESyzxEku8xBIvscRLLPESS7zEEi+xxEss8RJLvMQSL7HESyzxEku8xBIvscRLLPESS7zEEi+xxEss8RJLvMQSL7HESyzxEku8xBIvscRLLPESS7zEEi+xxEss8RJLvMQSL7HESyzxEku8xBIvscRLLPESS7zEEi+xxEss8RJLvMQSL7HESyzxEku8xBIvscRLLPESS7zEEi+xxEus/wdltDyq5Wc/VwAAAABJRU5ErkJggg==" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
## 5. other uses of the dissimilarity matrix
require(MASS)
# Sammon Mapping: doesn&#39;t like &#39;0&#39; values in dissimilarity matrix
d.sam &lt;- sammon(d)
</code></pre>

<pre><code>## Initial stress        : 0.00901
## stress after  10 iters: 0.00172, magic = 0.500
## stress after  20 iters: 0.00155, magic = 0.500
## stress after  30 iters: 0.00153, magic = 0.500
</code></pre>

<pre><code class="r">
# simple plot
dev.off() ; dev.new()
plot(d.sam$points, type = &quot;n&quot;, xlim=range(d.sam$points[,1] * 1.5))
text(d.sam$points, labels=row.names(as.data.frame(d.sam$points)), 
cex=0.75, col=cutree(h, 3))


## 6. try out the &#39;sample_interval&#39; argument
# compute using sucessively larger sampling intervals
data(sp3)
d &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01)
d.2 &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01, sample_interval=2)
d.10 &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01, sample_interval=10)
d.20 &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01, sample_interval=20)

# check the results via hclust / dendrograms
oldpar &lt;- par(mfcol=c(1,4), mar=c(2,1,2,2))
plot(as.dendrogram(hclust(d)), horiz=TRUE, main=&#39;Every Depth Slice&#39;)
plot(as.dendrogram(hclust(d.2)), horiz=TRUE, main=&#39;Every 2nd Depth Slice&#39;)
plot(as.dendrogram(hclust(d.10)), horiz=TRUE, main=&#39;Every 10th Depth Slice&#39;)
plot(as.dendrogram(hclust(d.20)), horiz=TRUE, main=&#39;Every 20th Depth Slice&#39;)
par(oldpar)

</code></pre>


<hr><div align="center">[Package <em>aqp</em> version 1.4-6 <a href="00Index.html">Index</a>]</div>
</body></html>
