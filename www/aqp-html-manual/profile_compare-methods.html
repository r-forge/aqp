<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Numerical Soil Profile Comparison</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for profile_compare-methods {aqp}"><tr><td>profile_compare-methods {aqp}</td><td align="right">R Documentation</td></tr></table>

<h2>Numerical Soil Profile Comparison</h2>

<h3>Description</h3>


<p>Performs a numerical comparison of soil profiles using named properties, based on a weighted, summed, depth-segment-aligned dissimilarity calculation. If <code>s</code> is a <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code>, site-level variables (2 or more) can also be used. The site-level and horizon-level dissimilarity matricies are then re-scaled to [0,1] and averaged.
</p>


<h3>Usage</h3>

<pre>
pc(s, vars, max_d, k, filter=NULL, sample_interval=NA, 
replace_na=TRUE, add_soil_flag=TRUE, 
return_depth_distances=FALSE, strict_hz_eval=FALSE,
progress='none', plot.depth.matrix=FALSE, rescale.result=FALSE,
verbose=FALSE)
</pre>


<h3>Arguments</h3>


<table summary="R argblock">
<tr valign="top"><td><code>s</code></td>
<td>
<p>a dataframe with at least 2 columns of soil properties, and an 'id' column for each profile. horizon depths must be integers and self-consistent</p>
</td></tr>
<tr valign="top"><td><code>vars</code></td>
<td>
<p>A vector with named properties that will be used in the comparison. These are typically column names describing horizon-level attributes (2 or more), but can also contain site-level attributes (2 or more) if <code>s</code> is a <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>max_d</code></td>
<td>
<p>depth-slices up to this depth are considered in the comparison</p>
</td></tr>
<tr valign="top"><td><code>k</code></td>
<td>
<p>a depth-weighting coeficient, use '0' for no depth-weighting (see examples below)</p>
</td></tr>
<tr valign="top"><td><code>filter</code></td>
<td>
<p>an index used to determine which horizons (rows) are included in the analysis</p>
</td></tr>
<tr valign="top"><td><code>sample_interval</code></td>
<td>
<p>use every n-th depth slice instead of every depth slice, useful for working with &gt; 1000 profiles at a time</p>
</td></tr>
<tr valign="top"><td><code>replace_na</code></td>
<td>
<p>if TRUE, missing data are replaced by maximum dissimilarity (TRUE)</p>
</td></tr>
<tr valign="top"><td><code>add_soil_flag</code></td>
<td>
<p>The algorithm will generate a 'soil'/'non-soil' matrix for use when comparing soil profiles with large differences in depth (TRUE). See details section below.</p>
</td></tr>
<tr valign="top"><td><code>return_depth_distances</code></td>
<td>
<p>return intermediate, depth-wise dissimilarity results (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>strict_hz_eval</code></td>
<td>
<p>should horizons be strictly checked for internal self-consistency? (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>progress</code></td>
<td>
<p>'none' (default): argument passed to <code>ddply</code> and related functions, see <code><a href="../../plyr/html/create_progress_bar.html">create_progress_bar</a></code> for all possible options; 'text' is usually fine.</p>
</td></tr>
<tr valign="top"><td><code>plot.depth.matrix</code></td>
<td>
<p>should a plot of the 'soil'/'non-soil' matrix be returned (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>rescale.result</code></td>
<td>
<p>should the result be rescaled to [0,1] (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
<p>extra debug output (FALSE)</p>
</td></tr>
</table>


<h3>Details</h3>


<p>Variability in soil depth can interfere significantly with the calculation of between-profile dissimilarity&ndash; what is the numerical &ldquo;distance&rdquo; (or dissimilarity) between a slice of soil from profile A and the corresponding, but missing, slice from a shallower profile B? Gower's distance metric would yield a NULL distance, despite the fact that intuition suggests otherwise: shallower soils should be more dissimilar from deeper soils. For example, when a 25 cm deep profile is compared with a 50 cm deep profile, numerical distances are only accumulated for the first 25 cm of soil (distances from 26 - 50 cm are NULL). When summed, the total distance between these profiles will generally be less than the distance between two profiles of equal depth. Our algorithm has an option (setting replace_na=TRUE) to replace NULL distances with the maximum distance between any pair of profiles for the current depth slice. In this way, the numerical distance between a slice of soil and a corresponding slice of non-soil reflects the fact that these two materials should be treated very differently (i.e. maximum dissimilarity). 
</p>
<p>This alternative calculation of dissimilarities between soil and non-soil slices solves the problem of comparing shallow profiles with deeper profiles. However, it can result in a new problem: distances calculated between two shallow profiles will be erroneously inflated beyond the extent of either profile's depth. Our algorithm has an additional option (setting add_soil_flag=TRUE) that will preserve NULL distances between slices when both slices represent non-soil material. With this option enabled, shallow profiles will only accumulate mutual dissimilarity to the depth of the deeper profile.
</p>
<p>Note that when the <code>add_soil_flag</code> option is enabled (default), slices are classified as 'soil' down to the maximum depth to which at least one of variables used in the dissimilarity calculation is not NA. This will cause problems when profiles within a collection contain all NAs within the columns used to determine dissimilarity. An approach for identifying and removing these kind of profiles is presented in the examples section below.
</p>
<p>A notice is issued if there are any NA values within the matrix used for distance calculations, as thes values are optionally replaced by the max dissimilarity.
</p>
<p>Our approach builds on the work of (Moore, 1972) and the previously mentioned depth-slicing algorithm.
</p>


<h3>Value</h3>

<p>A dissimilarity matrix object of class 'dissimilarity, dist', optionally scaled to [0, 1].</p>


<h3>Methods</h3>



<ul>
<li><p>data = &quot;SoilProfileCollection&quot; see <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code> 
</p>
</li>
<li><p>data = &quot;data.frame&quot; see <a href="profile_compare-methods.html">profile_compare</a> 
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Dylan E. Beaudette</p>


<h3>References</h3>



<dl>
<dt>1.</dt><dd><p>http://casoilresource.lawr.ucdavis.edu/</p>
</dd>
<dt>2.</dt><dd><p>Moore, A.; Russell, J. &amp; Ward, W. Numerical analysis of soils: A comparison of three soil profile models with field classification. Journal of Soil Science, 1972, 23, 194-209.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="SPC-slice-methods.html">slice</a></code>, <code><a href="../../cluster/html/daisy.html">daisy</a></code></p>


<h3>Examples</h3>

<pre><code class="r">
## 1. check out the influence depth-weight coef:
require(lattice)
z &lt;- rep(1:100,4)
k &lt;- rep(c(0,0.1,0.05,0.01), each=100)
w &lt;- 100*exp(-k*z)

xyplot(z ~ w, groups=k, ylim=c(105,-5), xlim=c(-5,105), type=&#39;l&#39;, 
ylab=&#39;Depth&#39;, xlab=&#39;Weighting Factor&#39;, 
auto.key=list(columns=4, lines=TRUE, points=FALSE, title=&quot;k&quot;, cex=0.8, size=3),
panel=function(...) {
    panel.grid(h=-1,v=-1) 
    panel.superpose(...)
    }
)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
## 2. basic implementation, requires at least two properties
# implementation for a data.frame class object
data(sp1)
d &lt;- profile_compare(sp1, vars=c(&#39;prop&#39;,&#39;group&#39;), max_d=100, k=0.01, 
plot.depth.matrix=TRUE)
</code></pre>

<pre><code>##     id prop group
## 1 P001   17     0
</code></pre>

<pre><code class="r">
# upgrade to SoilProfileCollection
depths(sp1) &lt;- id ~ top + bottom
op &lt;- par(mfrow=c(1,2))
# perform comparison on SoilProfileCollection object
# compare soil/non-soil matrix plot
d &lt;- profile_compare(sp1, vars=c(&#39;prop&#39;,&#39;group&#39;), max_d=100, k=0.01, 
plot.depth.matrix=TRUE)
</code></pre>

<pre><code>##     id prop group
## 1 P001   17     0
</code></pre>

<pre><code class="r"># plot profile collection
plot(sp1)
# annotate max depth of profile comparison
abline(h=100, col=&#39;red&#39;, lty=2)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAACRlBMVEX9/v0AAAAAACAAADUAAEYAAFYAAGUAAHMAFF4AIAAAIFYAIHMAKysANUYANY4APl4APpoARkYARnMARpoARqYASDUASKYAVlYAV1YAV70AZr0AdJoAdL0PAAAUAAAUK4cgAAAgAHMgFF4gNUYgNZogV70gdN4rFAArK2UrPporZr0riN41AAA1ACA1ADU1AHM1NVY1NZo1SAA1SD41m94+AAA+ACA+SDU+Xz4+m95GAABGACtGADVGAEZGAFZGAHNGFABGNQBGRgBGRkZGRodGRppGVlZGdGVGdI5GdL1GiIdGm95WAABWAHNWVnNWVwBWdL1Wm95Wvv1eFABePgBePnNeiEZlAABlACBlAHNlSABlSCBldEZldL1lvv1zAABzACBzACtzAD5zAEZzAHNzIABzRnNzRppzVzVzZgBzdABzdEZzdHNzdL1zj3Nzm5pzm95zp5pzvr1zvt5zvv1z371z3/2HKwCHRgCHXxSHiEaONQCOdEaO/v2aNQCaPgCaRgCaRkaaRnOadACadCCadEaadJqam0aam3Oam5qap3OavpqaxJqa372a396a3/2mRgCmSBSmdEamm0a9VwC9ZUa9ZgC9dAC9dD69dEa9dHO9m0a9vla9vnO933O935q9/qa9/r29/t69/v2+vr7DXxTD/v3eiCvemzXem0bem3Pem5revnPe35re397e/r3e/t7e/v39jzX9p0b9vlb9vmX9vnP9xF7931b933P934f935r9/r39/sP9/t79/v3/AAD////T3jywAAAAwnRSTlP//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD//0E9AlYAAAAJcEhZcwAAD2EAAA9hAag/p2kAACAASURBVHic7Z2Nn+RIWcctGBwVfGMUAVs9FVEE306UY/A8dT11aHwXFUVG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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">par(op)


# more soil properties
data(sp2)
d.1 &lt;- profile_compare(sp2, vars=c(&#39;prop&#39;,&#39;field_ph&#39;,&#39;hue&#39;,&#39;value&#39;), 
max_d=100, k=0.01, plot.depth.matrix=TRUE)
</code></pre>

<pre><code>##        id prop field_ph hue value
## 1   hon-1    0       22  22    22
## 4  hon-13    0        8   8     8
## 8  hon-19    0       17  17    17
## 9   hon-2    0       17  17    17
## 10 hon-20    0       12   0     0
## 17  hon-7    0       30  30    30
## 18  hon-8    0       12  12    12
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAkFBMVEX9/v0AAAAAAEYAAHMARkYARpoAdJoAdL1GAABGAEZGAHNGRgBGRkZGRppGdL1Gm95zAABzAEZzAHNzdABzdHNzvr1zvv2aRgCaRkaadACam3Oavpqa372a396a3/29dAC9m0a9/r29/t69/v2+vr7em0bevnPe35re/r3e/t7e/v39vnP935r9/r39/t79/v3kfi8/AAAAMHRSTlP//////////////////////////////////////////////////////////////wBipdB4AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAabklEQVR4nO2dDXujPHaG10lTp9sPZ7dt0u1HvG9T2neGJP7//65IGMcZIxlkHetBvu/rmhlPMDoH6Q4cBMZ/2AEY8IfSCUCdIBaYgFhgAmKBCYgFJiAWmIBYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYgFhgAmKBCYgFJiAWmIBYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYgFhgAmKBCYgFJiAWmIBYYAJigQm1i9WsOu7ffvnpx9Pq4af/6/CjdrXev9qu+pftarXJF6EZ3tX98LTh93/6ZdUJgbWpW6zPl1XP8/efj4jVHAa7E+vudTdRrMkRmuFN74+nYjUHq3eItQSa/aif7lF2vwxgJ8igRieWH+dJYk2O4N+4OX7xRefaelcZVYvldieb/uDzfLr0m1gfTwcznFhulzVFrOkROp/+5tHps73/Z8RaON2we10GRdphZ3F6KGy/Xjux3ECfrNUtuX/bfjvsTY/QifW3L917P18e/tK/xR8TncE+YBdxu7r7z87Qf3VrdQu7N3cN+KPyAqlaLDdkX4eooRzqxvpUrK8Sy43vv7vx7GU5Wsst+ftfCqrJETqx1tuu1ffH9dY33Pbv7X70JZZf+Xe/VuPe1Ew7f1CkbrH8TmHwoPH7If/3ybAflVhOn/966d7Ui3W01t6iZnV04Jocwf207d7XrjZerC7ioM9wKNxL2q/l9oW/LbiMr1usYdzduO1H2R+8Tob9qMRyYr22/k836MdruZF//vWsbWoEJ1a3t+r+fT7aD/VKfYm12R2aaff7s4VSuVj7aSM3YkOF3A3r88mwH5VYXqxOjnX761p+yX7g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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
# add some missing data: 
sp2$prop[1:2] &lt;- NA
d.2 &lt;- profile_compare(sp2, vars=c(&#39;prop&#39;,&#39;field_ph&#39;,&#39;hue&#39;,&#39;value&#39;), 
max_d=100, k=0.01, plot.depth.matrix=TRUE)
</code></pre>

<pre><code>##        id prop field_ph hue value
## 1   hon-1   22       22  22    22
## 4  hon-13    0        8   8     8
## 8  hon-19    0       17  17    17
## 9   hon-2    0       17  17    17
## 10 hon-20    0       12   0     0
## 17  hon-7    0       30  30    30
## 18  hon-8    0       12  12    12
</code></pre>

<pre><code class="r">
# note small changes in D:
cor(d.1, d.2)
</code></pre>

<pre><code>## [1] 0.9987
</code></pre>

<pre><code class="r">
## 3. identify profiles within a collection that contain all NAs
require(plyr)
s &lt;- ldply(1:10, random_profile)
depths(s) &lt;- id ~ top + bottom

# replace first profile&#39;s data with NA
na.required &lt;- nrow(s[1, ])
s$p1[1:na.required] &lt;- NA
s$p2[1:na.required] &lt;- NA

# attempt profile comparison: this won&#39;t work, throws an error
# d &lt;- profile_compare(s, vars=c(&#39;p1&#39;,&#39;p2&#39;), max_d=100, k=0)

# check for soils that are missing all clay / total RF data
f.check.NA &lt;- function(i) length(which(is.na(i$p1) | is.na(i$p2))) / nrow(i) == 1
missing.too.much.data.idx &lt;- which(profileApply(s, f.check.NA))

# remove bad profiles and try again: works
s.no.na &lt;- profile_compare(s[-missing.too.much.data.idx, ], vars=c(&#39;p1&#39;,&#39;p2&#39;), 
max_d=100, k=0, plot.depth.matrix=TRUE)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAkFBMVEX9/v0AAAAAAEYAAHMARkYARpoAdJoAdL1GAABGAEZGAHNGRgBGRkZGRppGdL1Gm95zAABzAEZzAHNzdABzdHNzvr1zvv2aRgCaRkaadACam3Oavpqa372a396a3/29dAC9m0a9/r29/t69/v2+vr7em0bevnPe35re/r3e/t7e/v39vnP935r9/r39/t79/v3kfi8/AAAAMHRSTlP//////////////////////////////////////////////////////////////wBipdB4AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAZrklEQVR4nO2dC3vqSHJAV3YcnM0D7yaxs3mYnThK5lrY/P9/F7UaYTAI1NVd3dXyOd83cxmbulUlnZGKRog/7AAU+EPpAmCZIBaogFigAmKBCogFKiAWqIBYoAJigQqIBSogFqiAWKACYoEKiAUqIBaogFigAmKBCogFKiAWqIBYoAJigQqIBSogFqiAWKACYoEKiAUqIBaogFigAmKBCogFKiAWqIBYoAJigQpLF6tteu7fvv3046l5eB/+dfhR16z2jzaNf9g1zTpdhnZ8Vv/D8794+0/fQmckts2yxfp8aTzPpz+/IFZ72Nm9WHevu5lizc7Qjk/aPp6L1R6s3iFWDbT7vX5+RNl924G9IKMavVjDfp4l1uwMwxPXxw++6F1b7RbGosVyh5O1P/k8n//2RKyPp4MZTix3yJoj1vwMvU9/8+j02dz/M2JVTr/bB11GRbrxYHF+Kuy+Hjux3I4+i+p/c/+2OTntzc/Qi/W3L/1zP18e/uKfMpwTncFDwj7jprn7z97Qf3VR/S/7J/d/wXBWrpBFi+V22dcpahyH+n19LtbXiOX277+7/ellOYpyv/n7bwPV7Ay9WKtN/7duH1eb4S/u/HP7H32JNQT/PkS17kntvNcPFlm2WMNBYfSgHY5Dw7/PdvvRiOX0+a+X/klerKOovUVtc3Timp3B/bTrn9c160GsPuOoz3gq3Evqo9yx8LeKx/hlizXud7ff9nt5OHmd7fajEcuJ9doN//Q7/TjK7fnn76/a5mZwYvVHq/7P56PjkFfqS6z17vDXdPvjWaUsXKz9spHbY+OE3O/W57PdfjRiDWL1cqy671HD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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

## alternate approach for visualizing missing data
# 10 random profiles
s &lt;- ldply(paste(&#39;soil&#39;, 1:10), random_profile)

# randomly sprinkle some missing data
s[sample(nrow(s), 5), &#39;p1&#39;] &lt;- NA
s[sample(nrow(s), 5), &#39;p2&#39;] &lt;- NA
s[sample(nrow(s), 5), &#39;p3&#39;] &lt;- NA

# set all p4 and p5 attributes of `soil 1&#39; to NA
s[which(s$id == &#39;soil 1&#39;), &#39;p5&#39;] &lt;- NA
s[which(s$id == &#39;soil 1&#39;), &#39;p4&#39;] &lt;- NA

# upgrade to SPC
depths(s) &lt;- id ~ top + bottom

# slice into regular segments
# note: this will compute slice-wise missing data
s.sliced &lt;- slice(s, 0:100 ~ .)

# however, when all data are missing, then NA is retured
# convert these into 1
s.sliced$.pctMissing[is.na(s.sliced$.pctMissing)] &lt;- 1


# symbolize missing data fraction
if(require(RColorBrewer)) {
  cols &lt;- rev(brewer.pal(8, &#39;Spectral&#39;))
  cr &lt;- colorRamp(cols)
  # assign color based on fraction of data NOT missing
  s.sliced$soil_color &lt;- rgb(cr(s.sliced$.pctMissing), max=255)
  # leave out horizon (slice boundaries)
  plot(s.sliced, divide.hz=FALSE)
  # legend
  legend.divs &lt;- c(0, .25, .50, .75, 1)
  legend(&#39;bottom&#39;, legend=legend.divs, pt.bg=rgb(cr(legend.divs), max=255), horiz=TRUE, pt.cex=2, pch=22, bg=&#39;white&#39;, title=&#39;Percent Missing&#39;)
}
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAABj1BMVEX9/v0AAAAAABQAACAAACsAADUAAEYAAEgAAFYAAHMAAHQANY4ARpoASJwAV70AdHQAdJwAdL0AdL8UAAAgAAArAAArZr0yiL01NY41V701dL01j941j/1GAABGAEZGAHNGRgBGRkZGZr1GdL1Gm95Gp/1IAABIAHRISEhInN9WdL1Wvv1exP1xxqRzAABzAHNzIDVzNTVzRppzV1ZzdABzdEZzdHNzdL1zm95zvt5zvv1z3/10AAB0AEh0AHR0dAB0v/+ONQCONRSO/v2Z1qSaPiuaPkaaRgCaRkaaRlaaRnOadHOadJqam3Oap3Oavpqa372a396a3/2cSACcnEicnHSc3/+mZgCmZj69VyC9ZSu9Ziu9dAC9dDW9dEa9dHO9m0a9vnO93/29/v2+5aC/dAC/nEi//7+////VPk/edCDeiCvem0bexIfe36be/v3fnEjf///y6pH6nVn9jzX9p0b9vlb9vnP933P934f935r93739/o79/r39/t79/v3/v3T/35z//7///9////9bpLKRAAAAhXRSTlP/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP//////pK4aAwAAAAlwSFlzAAAPYQAAD2EBqD+naQAAHkBJREFUeJztnY+fG8dZh7uUXkl/AGcaoJRrYnxNMRQHXGgckZQEKAml5scZAgVjuxyGkgrsFtoDwXkd5/5wtCvpJM07Mzu77777657n49iO5t3ZlebxflejWd0ncgADPtH3AcA0QSwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDAB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ehCrvJraSLD63+081rWdKLy0oxSrlGhzxnqerTba/LknVnHh9fl/6exDHsTyMdkPobv79BCxfExQrPIa6/I9gT2I5WOCYpX5mHXmFWJ5maJYHYNYPhBLDWL5QCw1iOUDsdQglg/EUoNYPhBLDWL5QCw1iOUDsdQglg/EUoNYPhBLDWL5uBRr/0vq6r+6V3dzxPKxFWvvp9fWH5s/3qHB5j/aocHm/7lDg833fsBv7a0rXmGroRu5WM/Xi6eqXt2AWPubb1ZivXgr2+82JNbe5mKr7eYBsXY3L25BXH06LfceFKu4OajyqVe8wlZDN26xnm9u1qt6df1i7W/+NLu5fOTa7rr3zeZ+sfY3F1ttN/eLJQ++vMdf7j0k1ou3EtahIpaPCrFWyzLDI7p9db1i7W++GuPiLgdxp4NfLGfv4fsj/GJ5Dr5Y/uzZe0Cs51nKAmfE8lEh1uoOh9Xv8VfXK9b+5qvFd+USdfcU6BfL2bvYaru5Vyx58Ku/y737xVpWp9zrg1g+KsUqXLi8qyHy6gbEkps/Lu51/vX11zdcbh4Qa3dzudV284BY7t7LlfeevQevsRCrKRVilXcwpFxk+cXybF5cZ13e8rXd3CvW/uZyq+3mXrHE3ld/9ewdsVqna7Geb9+N7V78pIglt9punibW7pco7e0dsVqn4yh8uhNBz3fWpadEodxqu3laFO7eubO3967FOn8jXxwdnJzfymbNh27kYt28HKH4qxu9eN9s/nj30iZFLLn3WmLtb7536utTrMXRYf7g5OxwPju//SQv9JpfP7ibHdcbulGL1ep0w/J8tb0pfn/QUqYb5FbbzZOmG9aKefZuKpbnpzktz1h5fjZ7eJovf81nixvz47PDQrI6jFqsVidIL9/4lyP+8b2ds1fKBKncart50gTpWjHP3i3F8lGItfxvJdbyVyHXnamKFfggNvUjnYrNizFef1FReUu8c+dfyuZyq5qbX167p+7dUqzz14tzVSFT8fuj6YoFTWkm1v0sO1xdvJfXWIgFLmbzCRUg1sRBLB+IpQaxfCCWGsTygVhqEMsHYqlBLB+IpQaxfCCWGsTygVhqEMsHYqlBLB+IpQaxfCCWGsTykYGanoZu2GLBaEEsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTEAsMAGxwATEAhMQC0xALDABscAExAITEAtMQCwwAbHABMQCExALTPh/K2lQklMH7kIAAAAASUVORK5CYII=" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

## 4. better plotting of dendrograms with ape package:
require(ape)
require(cluster)
h &lt;- diana(d)
p &lt;- as.phylo(as.hclust(h))
plot(ladderize(p), cex=0.75, label.offset=1)
tiplabels(col=cutree(h, 3), pch=15)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAeFBMVEX9/v0AAAAAAEYAAHMARpoAdHMAdL0AzQBGAABGAEZGAHNGRppGdL1Gm95zAABzAEZzAHNzdABzdJpzvt5zvv2aRgCaRkaaRnOam0aa396a3/29dAC9/r29/v3em0be/t7e/v39vnP935r93739/r39/t79/v3/AABpMEyCAAAAKHRSTlP//////////////////////////////////////////////////wD/AIw85wAAAAlwSFlzAAAPYQAAD2EBqD+naQAADOhJREFUeJzt3W13U8cZheE4pK6TNPTNSRsIbqyC+v//YTWyOTGYObbQs62jOdf1ARHTVXsm95KMsmB/s4WAb079BTAmYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYa3Cn+88+Mjbi+Zy/7Nv30wPm6uL736v+IzCWoVHYX34+af9j9fbt5fbzQ/v7h/ev9594KeKzyisVXgU1vu/tmepXUQtqt0/3D/cXG63tyVPWcJahUdhtZD2z1i7Z6pW1MeH3bPV5kdh0XPxqUdh3V62H99+95/di+GuqF/vHvZh3XjGouvi0398FNbN/ffu+5fEzQ+/3T28u3n1bnN1WfEFCGtMT4X19vrucf+SeHN5/9B+b/jq7755p+ti/pfvv3ff/eRv79p3WvcP7SOb799UfAHCGtMTYU3foLe3HXbfVN0/7Hq7ex/ieMIa0xNh3X3v3rx/vX9H9P7h9u490wLCGtMTYeUJa0zCIkJYRAiLCGERISwihEWEsIgQFhHCIkJYRAiLCGERISwihEWEsIgQFhHCoswnf5Lw1F+MsMZx0fn5SQhrHMIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREh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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
## 5. other uses of the dissimilarity matrix
require(MASS)
# Sammon Mapping: doesn&#39;t like &#39;0&#39; values in dissimilarity matrix
d.sam &lt;- sammon(d)
</code></pre>

<pre><code>## Initial stress        : 0.00901
## stress after  10 iters: 0.00172, magic = 0.500
## stress after  20 iters: 0.00155, magic = 0.500
## stress after  30 iters: 0.00153, magic = 0.500
</code></pre>

<pre><code class="r">
# simple plot
dev.off() ; dev.new()
plot(d.sam$points, type = &quot;n&quot;, xlim=range(d.sam$points[,1] * 1.5))
text(d.sam$points, labels=row.names(as.data.frame(d.sam$points)), 
cex=0.75, col=cutree(h, 3))


## 6. try out the &#39;sample_interval&#39; argument
# compute using sucessively larger sampling intervals
data(sp3)
d &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01)
d.2 &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01, sample_interval=2)
d.10 &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01, sample_interval=10)
d.20 &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01, sample_interval=20)

# check the results via hclust / dendrograms
oldpar &lt;- par(mfcol=c(1,4), mar=c(2,1,2,2))
plot(as.dendrogram(hclust(d)), horiz=TRUE, main=&#39;Every Depth Slice&#39;)
plot(as.dendrogram(hclust(d.2)), horiz=TRUE, main=&#39;Every 2nd Depth Slice&#39;)
plot(as.dendrogram(hclust(d.10)), horiz=TRUE, main=&#39;Every 10th Depth Slice&#39;)
plot(as.dendrogram(hclust(d.20)), horiz=TRUE, main=&#39;Every 20th Depth Slice&#39;)
par(oldpar)

</code></pre>


<hr><div align="center">[Package <em>aqp</em> version 1.5-1 <a href="00Index.html">Index</a>]</div>
</body></html>
