<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Numerical Soil Profile Comparison</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for profile_compare-methods {aqp}"><tr><td>profile_compare-methods {aqp}</td><td align="right">R Documentation</td></tr></table>

<h2>Numerical Soil Profile Comparison</h2>

<h3>Description</h3>


<p>Performs a numerical comparison of soil profiles using named properties, based on a weighted, summed, depth-segment-aligned dissimilarity calculation. If <code>s</code> is a <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code>, site-level variables (2 or more) can also be used. The site-level and horizon-level dissimilarity matricies are then re-scaled to [0,1] and averaged.
</p>


<h3>Usage</h3>

<pre>
pc(s, vars, max_d, k, filter=NULL, sample_interval=NA, 
replace_na=TRUE, add_soil_flag=TRUE, 
return_depth_distances=FALSE, strict_hz_eval=FALSE,
progress='none', plot.depth.matrix=FALSE, rescale.result=FALSE,
verbose=FALSE)
</pre>


<h3>Arguments</h3>


<table summary="R argblock">
<tr valign="top"><td><code>s</code></td>
<td>
<p>a dataframe with at least 2 columns of soil properties, and an 'id' column for each profile. horizon depths must be integers and self-consistent</p>
</td></tr>
<tr valign="top"><td><code>vars</code></td>
<td>
<p>A vector with named properties that will be used in the comparison. These are typically column names describing horizon-level attributes (2 or more), but can also contain site-level attributes (2 or more) if <code>s</code> is a <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code>.</p>
</td></tr>
<tr valign="top"><td><code>max_d</code></td>
<td>
<p>depth-slices up to this depth are considered in the comparison</p>
</td></tr>
<tr valign="top"><td><code>k</code></td>
<td>
<p>a depth-weighting coeficient, use '0' for no depth-weighting (see examples below)</p>
</td></tr>
<tr valign="top"><td><code>filter</code></td>
<td>
<p>an index used to determine which horizons (rows) are included in the analysis</p>
</td></tr>
<tr valign="top"><td><code>sample_interval</code></td>
<td>
<p>use every n-th depth slice instead of every depth slice, useful for working with &gt; 1000 profiles at a time</p>
</td></tr>
<tr valign="top"><td><code>replace_na</code></td>
<td>
<p>if TRUE, missing data are replaced by maximum dissimilarity (TRUE)</p>
</td></tr>
<tr valign="top"><td><code>add_soil_flag</code></td>
<td>
<p>The algorithm will generate a 'soil'/'non-soil' matrix for use when comparing soil profiles with large differences in depth (TRUE). See details section below.</p>
</td></tr>
<tr valign="top"><td><code>return_depth_distances</code></td>
<td>
<p>return intermediate, depth-wise dissimilarity results (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>strict_hz_eval</code></td>
<td>
<p>should horizons be strictly checked for internal self-consistency? (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>progress</code></td>
<td>
<p>'none' (default): argument passed to <code>ddply</code> and related functions, see <code><a href="../../plyr/html/create_progress_bar.html">create_progress_bar</a></code> for all possible options; 'text' is usually fine.</p>
</td></tr>
<tr valign="top"><td><code>plot.depth.matrix</code></td>
<td>
<p>should a plot of the 'soil'/'non-soil' matrix be returned (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>rescale.result</code></td>
<td>
<p>should the result be rescaled to [0,1] (FALSE)</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
<p>extra debug output (FALSE)</p>
</td></tr>
</table>


<h3>Details</h3>


<p>Variability in soil depth can interfere significantly with the calculation of between-profile dissimilarity&ndash; what is the numerical &ldquo;distance&rdquo; (or dissimilarity) between a slice of soil from profile A and the corresponding, but missing, slice from a shallower profile B? Gower's distance metric would yield a NULL distance, despite the fact that intuition suggests otherwise: shallower soils should be more dissimilar from deeper soils. For example, when a 25 cm deep profile is compared with a 50 cm deep profile, numerical distances are only accumulated for the first 25 cm of soil (distances from 26 - 50 cm are NULL). When summed, the total distance between these profiles will generally be less than the distance between two profiles of equal depth. Our algorithm has an option (setting replace_na=TRUE) to replace NULL distances with the maximum distance between any pair of profiles for the current depth slice. In this way, the numerical distance between a slice of soil and a corresponding slice of non-soil reflects the fact that these two materials should be treated very differently (i.e. maximum dissimilarity). 
</p>
<p>This alternative calculation of dissimilarities between soil and non-soil slices solves the problem of comparing shallow profiles with deeper profiles. However, it can result in a new problem: distances calculated between two shallow profiles will be erroneously inflated beyond the extent of either profile's depth. Our algorithm has an additional option (setting add_soil_flag=TRUE) that will preserve NULL distances between slices when both slices represent non-soil material. With this option enabled, shallow profiles will only accumulate mutual dissimilarity to the depth of the deeper profile.
</p>
<p>Note that when the <code>add_soil_flag</code> option is enabled (default), slices are classified as 'soil' down to the maximum depth to which at least one of variables used in the dissimilarity calculation is not NA. This will cause problems when profiles within a collection contain all NAs within the columns used to determine dissimilarity. An approach for identifying and removing these kind of profiles is presented in the examples section below.
</p>
<p>A notice is issued if there are any NA values within the matrix used for distance calculations, as thes values are optionally replaced by the max dissimilarity.
</p>
<p>Our approach builds on the work of (Moore, 1972) and the previously mentioned depth-slicing algorithm.
</p>


<h3>Value</h3>

<p>A dissimilarity matrix object of class 'dissimilarity, dist', optionally scaled to [0, 1].</p>


<h3>Methods</h3>



<ul>
<li><p>data = &quot;SoilProfileCollection&quot; see <code><a href="SoilProfileCollection-class.html">SoilProfileCollection</a></code> 
</p>
</li>
<li><p>data = &quot;data.frame&quot; see <a href="profile_compare-methods.html">profile_compare</a> 
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Dylan E. Beaudette</p>


<h3>References</h3>



<dl>
<dt>1.</dt><dd><p>http://casoilresource.lawr.ucdavis.edu/</p>
</dd>
<dt>2.</dt><dd><p>Moore, A.; Russell, J. &amp; Ward, W. Numerical analysis of soils: A comparison of three soil profile models with field classification. Journal of Soil Science, 1972, 23, 194-209.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="SPC-slice-methods.html">slice</a></code>, <code><a href="../../cluster/html/daisy.html">daisy</a></code></p>


<h3>Examples</h3>

<pre><code class="r">
## 1. check out the influence depth-weight coef:
require(lattice)
z &lt;- rep(1:100,4)
k &lt;- rep(c(0,0.1,0.05,0.01), each=100)
w &lt;- 100*exp(-k*z)

xyplot(z ~ w, groups=k, ylim=c(105,-5), xlim=c(-5,105), type=&#39;l&#39;, 
ylab=&#39;Depth&#39;, xlab=&#39;Weighting Factor&#39;, 
auto.key=list(columns=4, lines=TRUE, points=FALSE, title=&quot;k&quot;, cex=0.8, size=3),
panel=function(...) {
    panel.grid(h=-1,v=-1) 
    panel.superpose(...)
    }
)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
## 2. basic implementation, requires at least two properties
# implementation for a data.frame class object
data(sp1)
d &lt;- profile_compare(sp1, vars=c(&#39;prop&#39;,&#39;group&#39;), max_d=100, k=0.01, 
plot.depth.matrix=TRUE)
</code></pre>

<pre><code>##     id prop group
## 1 P001   17     0
</code></pre>

<pre><code class="r">
# upgrade to SoilProfileCollection
depths(sp1) &lt;- id ~ top + bottom
op &lt;- par(mfrow=c(1,2))
# perform comparison on SoilProfileCollection object
# compare soil/non-soil matrix plot
d &lt;- profile_compare(sp1, vars=c(&#39;prop&#39;,&#39;group&#39;), max_d=100, k=0.01, 
plot.depth.matrix=TRUE)
</code></pre>

<pre><code>##     id prop group
## 1 P001   17     0
</code></pre>

<pre><code class="r"># plot profile collection
plot(sp1)
# annotate max depth of profile comparison
abline(h=100, col=&#39;red&#39;, lty=2)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAACRlBMVEX9/v0AAAAAACAAADUAAEYAAFYAAGUAAHMAFF4AIAAAIFYAIHMAKysANUYANY4APl4APpoARkYARnMARpoARqYASDUASKYAVlYAV1YAV70AZr0AdJoAdL0PAAAUAAAUK4cgAAAgAHMgFF4gNUYgNZogV70gdN4rFAArK2UrPporZr0riN41AAA1ACA1ADU1AHM1NVY1NZo1SAA1SD41m94+AAA+ACA+SDU+Xz4+m95GAABGACtGADVGAEZGAFZGAHNGFABGNQBGRgBGRkZGRodGRppGVlZGdGVGdI5GdL1GiIdGm95WAABWAHNWVnNWVwBWdL1Wm95Wvv1eFABePgBePnNeiEZlAABlACBlAHNlSABlSCBldEZldL1lvv1zAABzACBzACtzAD5zAEZzAHNzIABzRnNzRppzVzVzZgBzdABzdEZzdHNzdL1zj3Nzm5pzm95zp5pzvr1zvt5zvv1z371z3/2HKwCHRgCHXxSHiEaONQCOdEaO/v2aNQCaPgCaRgCaRkaaRnOadACadCCadEaadJqam0aam3Oam5qap3OavpqaxJqa372a396a3/2mRgCmSBSmdEamm0a9VwC9ZUa9ZgC9dAC9dD69dEa9dHO9m0a9vla9vnO933O935q9/qa9/r29/t69/v2+vr7DXxTD/v3eiCvemzXem0bem3Pem5revnPe35re397e/r3e/t7e/v39jzX9p0b9vlb9vmX9vnP9xF7931b933P934f935r9/r39/sP9/t79/v3/AAD////T3jywAAAAwnRSTlP//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD//0E9AlYAAAAJcEhZcwAAD2EAAA9hAag/p2kAACAASURBVHic7Z2Nn+RIWcctGBwVfGMUAVs9FVEE306UY/A8dT11aHwXFUVG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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">par(op)


# more soil properties
data(sp2)
d.1 &lt;- profile_compare(sp2, vars=c(&#39;prop&#39;,&#39;field_ph&#39;,&#39;hue&#39;,&#39;value&#39;), 
max_d=100, k=0.01, plot.depth.matrix=TRUE)
</code></pre>

<pre><code>##        id prop field_ph hue value
## 1   hon-1    0       22  22    22
## 4  hon-13    0        8   8     8
## 8  hon-19    0       17  17    17
## 9   hon-2    0       17  17    17
## 10 hon-20    0       12   0     0
## 17  hon-7    0       30  30    30
## 18  hon-8    0       12  12    12
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAkFBMVEX9/v0AAAAAAEYAAHMARkYARpoAdJoAdL1GAABGAEZGAHNGRgBGRkZGRppGdL1Gm95zAABzAEZzAHNzdABzdHNzvr1zvv2aRgCaRkaadACam3Oavpqa372a396a3/29dAC9m0a9/r29/t69/v2+vr7em0bevnPe35re/r3e/t7e/v39vnP935r9/r39/t79/v3kfi8/AAAAMHRSTlP//////////////////////////////////////////////////////////////wBipdB4AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAabklEQVR4nO2dDXujPHaG10lTp9sPZ7dt0u1HvG9T2neGJP7//65IGMcZIxlkHetBvu/rmhlPMDoH6Q4cBMZ/2AEY8IfSCUCdIBaYgFhgAmKBCYgFJiAWmIBYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYgFhgAmKBCYgFJiAWmIBYYAJigQmIBSYgFpiAWGACYoEJiAUmIBaYgFhgAmKBCYgFJiAWmIBYYAJigQm1i9WsOu7ffvnpx9Pq4af/6/CjdrXev9qu+pftarXJF6EZ3tX98LTh93/6ZdUJgbWpW6zPl1XP8/efj4jVHAa7E+vudTdRrMkRmuFN74+nYjUHq3eItQSa/aif7lF2vwxgJ8igRieWH+dJYk2O4N+4OX7xRefaelcZVYvldieb/uDzfLr0m1gfTwcznFhulzVFrOkROp/+5tHps73/Z8RaON2we10GRdphZ3F6KGy/Xjux3ECfrNUtuX/bfjvsTY/QifW3L917P18e/tK/xR8TncE+YBdxu7r7z87Qf3VrdQu7N3cN+KPyAqlaLDdkX4eooRzqxvpUrK8Sy43vv7vx7GU5Wsst+ftfCqrJETqx1tuu1ffH9dY33Pbv7X70JZZf+Xe/VuPe1Ew7f1CkbrH8TmHwoPH7If/3ybAflVhOn/966d7Ui3W01t6iZnV04Jocwf207d7XrjZerC7ioM9wKNxL2q/l9oW/LbiMr1usYdzduO1H2R+8Tob9qMRyYr22/k836MdruZF//vWsbWoEJ1a3t+r+fT7aD/VKfYm12R2aaff7s4VSuVj7aSM3YkOF3A3r88mwH5VYXqxOjnX761p+yX7g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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
# add some missing data: 
sp2$prop[1:2] &lt;- NA
d.2 &lt;- profile_compare(sp2, vars=c(&#39;prop&#39;,&#39;field_ph&#39;,&#39;hue&#39;,&#39;value&#39;), 
max_d=100, k=0.01, plot.depth.matrix=TRUE)
</code></pre>

<pre><code>##        id prop field_ph hue value
## 1   hon-1   22       22  22    22
## 4  hon-13    0        8   8     8
## 8  hon-19    0       17  17    17
## 9   hon-2    0       17  17    17
## 10 hon-20    0       12   0     0
## 17  hon-7    0       30  30    30
## 18  hon-8    0       12  12    12
</code></pre>

<pre><code class="r">
# note small changes in D:
cor(d.1, d.2)
</code></pre>

<pre><code>## [1] 0.9987
</code></pre>

<pre><code class="r">
## 3. identify profiles within a collection that contain all NAs
require(plyr)
s &lt;- ldply(1:10, random_profile)
depths(s) &lt;- id ~ top + bottom

# replace first profile&#39;s data with NA
na.required &lt;- nrow(s[1, ])
s$p1[1:na.required] &lt;- NA
s$p2[1:na.required] &lt;- NA

# attempt profile comparison: this won&#39;t work, throws an error
# d &lt;- profile_compare(s, vars=c(&#39;p1&#39;,&#39;p2&#39;), max_d=100, k=0)

# check for soils that are missing all clay / total RF data
f.check.NA &lt;- function(i) length(which(is.na(i$p1) | is.na(i$p2))) / nrow(i) == 1
missing.too.much.data.idx &lt;- which(profileApply(s, f.check.NA))

# remove bad profiles and try again: works
s.no.na &lt;- profile_compare(s[-missing.too.much.data.idx, ], vars=c(&#39;p1&#39;,&#39;p2&#39;), 
max_d=100, k=0, plot.depth.matrix=TRUE)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAkFBMVEX9/v0AAAAAAEYAAHMARkYARpoAdJoAdL1GAABGAEZGAHNGRgBGRkZGRppGdL1Gm95zAABzAEZzAHNzdABzdHNzvr1zvv2aRgCaRkaadACam3Oavpqa372a396a3/29dAC9m0a9/r29/t69/v2+vr7em0bevnPe35re/r3e/t7e/v39vnP935r9/r39/t79/v3kfi8/AAAAMHRSTlP//////////////////////////////////////////////////////////////wBipdB4AAAACXBIWXMAAA9hAAAPYQGoP6dpAAAZhElEQVR4nO2di3qrSHZGBzuOnMlFnkliZXKxpuOQ9DGy9f5vFwqEhCwh14W92VVa6/u6j9pmn78oVkNRXPSHPYAAf1i6AVAmiAUiIBaIgFggAmKBCIgFIiAWiIBYIAJigQiIBSIgFoiAWCACYoEIiAUiIBaIgFggAmKBCIgFIiAWiIBYIAJigQiIBSIgFoiAWCACYoEIiAUiIBaIgFggAmKBCIgFIiAWiIBYIELpYtVVy+P7t59+vlRPH92/jj9qqtXh07bqPzZVtZ4voR6Wan94+Rfv/ulbqUewbcoW62tT9bye//yKWPVxY7diPbztPcXyTqiHhXbPl2LVR6v3iJUD9WGrX+5R9t82YCvIoEYrVredvcTyTugWXI8/nGhdW+0Lo2ix3O5k3R98Xi9/eybW58vRDCeW22X5iOWf0Pr0N89On+3jPyNW5rSbvdNlUKQZdhaXh8Lm9NmJ5Tb0RVX7m8f37dlhzz+hFetvN+2yX5unv/SLdMdEZ3AX2CZuq4f/bA39V1fV/rJduP0LuqNyhhQtlttkp0PUMBxqt/WlWKchltu+/+62Zy/LqMr95u+/Dai8E1qxVtv2b909r7bdX9z0y7Y/OonVFf/eVdVuodrv/MEiZYvV7RQGD+puP9T9+2Kzj4ZYTp//2rQL9WKNqg4W1dXowOWd4H7atMs11boTq00c9BkOhQdJ+yq3L/wt42F82WIN291tt8NW7g5eF5t9NMRyYr013T/tRh9XuS3/+v2szTfBidXurdo/X0f7oV6pk1jr/fGvaQ77s0wpXKzDtJHbYsMIud2srxebfTTE6sRq5Vg136u63xw2fH/U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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

## alternate approach for visualizing missing data
# 10 random profiles
s &lt;- ldply(paste(&#39;soil&#39;, 1:10), random_profile)

# randomly sprinkle some missing data
s[sample(nrow(s), 5), &#39;p1&#39;] &lt;- NA
s[sample(nrow(s), 5), &#39;p2&#39;] &lt;- NA
s[sample(nrow(s), 5), &#39;p3&#39;] &lt;- NA

# set all p4 and p5 attributes of `soil 1&#39; to NA
s[which(s$id == &#39;soil 1&#39;), &#39;p5&#39;] &lt;- NA
s[which(s$id == &#39;soil 1&#39;), &#39;p4&#39;] &lt;- NA

# upgrade to SPC
depths(s) &lt;- id ~ top + bottom

# slice into regular segments
# note: this will compute slice-wise missing data
s.sliced &lt;- slice(s, 0:100 ~ .)

# however, when all data are missing, then NA is retured
# convert these into 1
s.sliced$.pctMissing[is.na(s.sliced$.pctMissing)] &lt;- 1


# symbolize missing data fraction
if(require(RColorBrewer)) {
  cols &lt;- rev(brewer.pal(8, &#39;Spectral&#39;))
  cr &lt;- colorRamp(cols)
  # assign color based on fraction of data NOT missing
  s.sliced$soil_color &lt;- rgb(cr(s.sliced$.pctMissing), max=255)
  # leave out horizon (slice boundaries)
  plot(s.sliced, divide.hz=FALSE)
  # legend
  legend.divs &lt;- c(0, .25, .50, .75, 1)
  legend(&#39;bottom&#39;, legend=legend.divs, pt.bg=rgb(cr(legend.divs), max=255), horiz=TRUE, pt.cex=2, pch=22, bg=&#39;white&#39;, title=&#39;Percent Missing&#39;)
}
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAABiVBMVEX9/v0AAAAAABQAACAAACsAADUAAEYAAEgAAFYAAHMAAHQANY4ARpoASJwAV70AdHQAdJwAdL0AdL8UAAAgAAArAAArZr0yiL01NY41V701dL01j941j/1GAABGAEZGAHNGRgBGRkZGZr1GdL1Gm95Gp/1IAABIAHRISEhInN9WdL1Wvv1exP1xxqRzAABzAHNzIDVzNTVzRppzV1ZzdABzdEZzdHNzdL1zm95zvt5zvv1z3/10AAB0AEh0AHR0dAB0v/+ONQCONRSO/v2Z1qSaPiuaPkaaRgCaRkaaRnOadHOadJqam3Oap3Oavpqa372a3/2cSACcnEicnHSc3/+mZgCmZj69VyC9ZSu9Ziu9dAC9dDW9dEa9dHO9m0a9vnO93/29/v2+5aC/dAC/nEi//7+////VPk/edCDeiCvem0bexIfe36be/v3fnEjf///y6pH6nVn9jzX9p0b9vlb9vnP933P934f935r93739/o79/r39/t79/v3/v3T/35z//7///9/////KmpS/AAAAg3RSTlP//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD//////+tB7eEAAAAJcEhZcwAAD2EAAA9hAag/p2kAAB0BSURBVHic7Z2Pn9vmXccnRm90W4ELLQPGrQu5dYRtKWSwpaYdHTDa0QAXKAxCknENjM2QDOgODHdO0vvLsST7bD+/9NXz6KtHlt/vV5qk9ld6LOkdfeTHX/k+NQdQ4FO5XwCME8QCFRALVEAsUAGxQAXEAhUQC1RALFABsUAFxAIVEAtUQCxQAbFABcQCFRALVEAsUAGxQAXEAhUQC1RALFABsUAFxAIVEAtUQCxQAbFABcQCFRALVEAsUAGxQAXEAhUQC1RALFABsUAFxAIVEAtUQCxQAbFABcQCFRALVEAsUAGxQAXEAhUQC1RALFABsUAFxAIVEAtUQCxQAbFABcQCFRALVEAsUAGxQAXEAhUQC1RALFABsUAFxAIVEAtUQCxQAbFA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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

## 4. better plotting of dendrograms with ape package:
require(ape)
require(cluster)
h &lt;- diana(d)
p &lt;- as.phylo(as.hclust(h))
plot(ladderize(p), cex=0.75, label.offset=1)
tiplabels(col=cutree(h, 3), pch=15)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAeFBMVEX9/v0AAAAAAEYAAHMARpoAdHMAdL0AzQBGAABGAEZGAHNGRppGdL1Gm95zAABzAEZzAHNzdABzdJpzvt5zvv2aRgCaRkaaRnOam0aa396a3/29dAC9/r29/v3em0be/t7e/v39vnP935r93739/r39/t79/v3/AABpMEyCAAAAKHRSTlP//////////////////////////////////////////////////wD/AIw85wAAAAlwSFlzAAAPYQAAD2EBqD+naQAADOhJREFUeJzt3W13U8cZheE4pK6TNPTNSRsIbqyC+v//YTWyOTGYObbQs62jOdf1ARHTVXsm95KMsmB/s4WAb079BTAmYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYa3Cn+88+Mjbi+Zy/7Nv30wPm6uL736v+IzCWoVHYX34+af9j9fbt5fbzQ/v7h/ev9594KeKzyisVXgU1vu/tmepXUQtqt0/3D/cXG63tyVPWcJahUdhtZD2z1i7Z6pW1MeH3bPV5kdh0XPxqUdh3V62H99+95/di+GuqF/vHvZh3XjGouvi0398FNbN/ffu+5fEzQ+/3T28u3n1bnN1WfEFCGtMT4X19vrucf+SeHN5/9B+b/jq7755p+ti/pfvv3ff/eRv79p3WvcP7SOb799UfAHCGtMTYU3foLe3HXbfVN0/7Hq7ex/ieMIa0xNh3X3v3rx/vX9H9P7h9u490wLCGtMTYeUJa0zCIkJYRAiLCGERISwihEWEsIgQFhHCIkJYRAiLCGERISwihEWEsIgQFhHCoswnf5Lw1F+MsMZx0fn5SQhrHMIiQlhECIsIYREhLCKERYSwiBAWEcIiQlhECIsIYREh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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
## 5. other uses of the dissimilarity matrix
require(MASS)
# Sammon Mapping: doesn&#39;t like &#39;0&#39; values in dissimilarity matrix
d.sam &lt;- sammon(d)
</code></pre>

<pre><code>## Initial stress        : 0.00901
## stress after  10 iters: 0.00172, magic = 0.500
## stress after  20 iters: 0.00155, magic = 0.500
## stress after  30 iters: 0.00153, magic = 0.500
</code></pre>

<pre><code class="r">
# simple plot
dev.off() ; dev.new()
plot(d.sam$points, type = &quot;n&quot;, xlim=range(d.sam$points[,1] * 1.5))
text(d.sam$points, labels=row.names(as.data.frame(d.sam$points)), 
cex=0.75, col=cutree(h, 3))


## 6. try out the &#39;sample_interval&#39; argument
# compute using sucessively larger sampling intervals
data(sp3)
d &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01)
d.2 &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01, sample_interval=2)
d.10 &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01, sample_interval=10)
d.20 &lt;- profile_compare(sp3, vars=c(&#39;clay&#39;,&#39;cec&#39;,&#39;ph&#39;), 
max_d=100, k=0.01, sample_interval=20)

# check the results via hclust / dendrograms
oldpar &lt;- par(mfcol=c(1,4), mar=c(2,1,2,2))
plot(as.dendrogram(hclust(d)), horiz=TRUE, main=&#39;Every Depth Slice&#39;)
plot(as.dendrogram(hclust(d.2)), horiz=TRUE, main=&#39;Every 2nd Depth Slice&#39;)
plot(as.dendrogram(hclust(d.10)), horiz=TRUE, main=&#39;Every 10th Depth Slice&#39;)
plot(as.dendrogram(hclust(d.20)), horiz=TRUE, main=&#39;Every 20th Depth Slice&#39;)
par(oldpar)

</code></pre>


<hr><div align="center">[Package <em>aqp</em> version 1.5 <a href="00Index.html">Index</a>]</div>
</body></html>
