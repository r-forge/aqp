<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Soil Chemical Data from Serpentinitic Soils of California</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="R.css">

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head><body>

<table width="100%" summary="page for sp4 {aqp}"><tr><td>sp4 {aqp}</td><td align="right">R Documentation</td></tr></table>

<h2>Soil Chemical Data from Serpentinitic Soils of California</h2>

<h3>Description</h3>

<p>Soil Chemical Data from Serpentinitic Soils of California</p>


<h3>Usage</h3>

<pre>data(sp4)</pre>


<h3>Format</h3>


<p>A data frame with 30 observations on the following 13 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>site name</p>
</dd>
<dt><code>name</code></dt><dd><p>horizon designation</p>
</dd>
<dt><code>top</code></dt><dd><p>horizon top boundary in cm</p>
</dd>
<dt><code>bottom</code></dt><dd><p>horizon bottom boundary in cm</p>
</dd>
<dt><code>K</code></dt><dd><p>exchangeable K in c mol/kg</p>
</dd>
<dt><code>Mg</code></dt><dd><p>exchangeable Mg in cmol/kg</p>
</dd>
<dt><code>Ca</code></dt><dd><p>exchangeable Ca in cmol/kg</p>
</dd>
<dt><code>CEC_7</code></dt><dd><p>cation exchange capacity (NH4OAc at pH 7)</p>
</dd>
<dt><code>ex_Ca_to_Mg</code></dt><dd><p>extractable Ca:Mg ratio</p>
</dd>
<dt><code>sand</code></dt><dd><p>sand content by weight percentage</p>
</dd>
<dt><code>silt</code></dt><dd><p>silt content by weight percentage</p>
</dd>
<dt><code>clay</code></dt><dd><p>clay content by weight percentage</p>
</dd>
<dt><code>CF</code></dt><dd><p>&gt;2mm fraction by volume percentage</p>
</dd>
</dl>



<h3>Details</h3>

<p>Selected soil physical and chemical data from (McGahan et al., 2009).</p>


<h3>Source</h3>

<p>https://www.soils.org/publications/sssaj/articles/73/6/2087</p>


<h3>References</h3>

<p>McGahan, D.G., Southard, R.J, Claassen, V.P. 2009. Plant-Available Calcium Varies Widely in Soils on Serpentinite Landscapes. Soil Sci. Soc. Am. J. 73: 2087-2095.</p>


<h3>Examples</h3>

<pre><code class="r">
# setup environment
library(aqp)
library(scales)
library(RColorBrewer)

# load sample data set, a simple data.frame object with horizon-level data from 10 profiles
data(sp4)
str(sp4)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    30 obs. of  13 variables:
##  $ id         : chr  &quot;colusa&quot; &quot;colusa&quot; &quot;colusa&quot; &quot;colusa&quot; ...
##  $ name       : chr  &quot;A&quot; &quot;ABt&quot; &quot;Bt1&quot; &quot;Bt2&quot; ...
##  $ top        : int  0 3 8 30 0 9 0 4 13 0 ...
##  $ bottom     : int  3 8 30 42 9 34 4 13 40 6 ...
##  $ K          : num  0.3 0.2 0.1 0.1 0.2 0.3 0.2 0.6 0.8 0.4 ...
##  $ Mg         : num  25.7 23.7 23.2 44.3 21.9 18.9 12.1 12.1 17.7 16.4 ...
##  $ Ca         : num  9 5.6 1.9 0.3 4.4 4.5 1.4 7 4.4 24.1 ...
##  $ CEC_7      : num  23 21.4 23.7 43 18.8 27.5 23.7 18 20 31.1 ...
##  $ ex_Ca_to_Mg: num  0.35 0.23 0.08 0.01 0.2 0.2 0.58 0.51 0.25 1.47 ...
##  $ sand       : int  46 42 40 27 54 49 43 36 27 43 ...
##  $ silt       : int  33 31 28 18 20 18 55 49 45 42 ...
##  $ clay       : int  21 27 32 55 25 34 3 15 27 15 ...
##  $ CF         : num  0.12 0.27 0.27 0.16 0.55 0.84 0.5 0.75 0.67 0.02 ...
</code></pre>

<pre><code class="r">
# optionally read about it...
# ?sp4

# upgrade to SoilProfileCollection
# &#39;id&#39; is the name of the column containing the profile ID
# &#39;top&#39; is the name of the column containing horizon upper boundaries
# &#39;bottom&#39; is the name of the column containing horizon lower boundaries
depths(sp4) &lt;- id ~ top + bottom

# check it out
class(sp4) # class name
</code></pre>

<pre><code>## [1] &quot;SoilProfileCollection&quot;
## attr(,&quot;package&quot;)
## [1] &quot;aqp&quot;
</code></pre>

<pre><code class="r">str(sp4) # internal structure
</code></pre>

<pre><code>## Formal class &#39;SoilProfileCollection&#39; [package &quot;aqp&quot;] with 7 slots
##   ..@ idcol     : chr &quot;id&quot;
##   ..@ depthcols : chr [1:2] &quot;top&quot; &quot;bottom&quot;
##   ..@ metadata  :&#39;data.frame&#39;:   1 obs. of  1 variable:
##   .. ..$ depth_units: chr &quot;cm&quot;
##   ..@ horizons  :&#39;data.frame&#39;:   30 obs. of  13 variables:
##   .. ..$ id         : chr [1:30] &quot;colusa&quot; &quot;colusa&quot; &quot;colusa&quot; &quot;colusa&quot; ...
##   .. ..$ name       : chr [1:30] &quot;A&quot; &quot;ABt&quot; &quot;Bt1&quot; &quot;Bt2&quot; ...
##   .. ..$ top        : int [1:30] 0 3 8 30 0 9 0 4 13 0 ...
##   .. ..$ bottom     : int [1:30] 3 8 30 42 9 34 4 13 40 3 ...
##   .. ..$ K          : num [1:30] 0.3 0.2 0.1 0.1 0.2 0.3 0.2 0.6 0.8 0.6 ...
##   .. ..$ Mg         : num [1:30] 25.7 23.7 23.2 44.3 21.9 18.9 12.1 12.1 17.7 28.3 ...
##   .. ..$ Ca         : num [1:30] 9 5.6 1.9 0.3 4.4 4.5 1.4 7 4.4 5.8 ...
##   .. ..$ CEC_7      : num [1:30] 23 21.4 23.7 43 18.8 27.5 23.7 18 20 29.3 ...
##   .. ..$ ex_Ca_to_Mg: num [1:30] 0.35 0.23 0.08 0.01 0.2 0.2 0.58 0.51 0.25 0.2 ...
##   .. ..$ sand       : int [1:30] 46 42 40 27 54 49 43 36 27 42 ...
##   .. ..$ silt       : int [1:30] 33 31 28 18 20 18 55 49 45 26 ...
##   .. ..$ clay       : int [1:30] 21 27 32 55 25 34 3 15 27 32 ...
##   .. ..$ CF         : num [1:30] 0.12 0.27 0.27 0.16 0.55 0.84 0.5 0.75 0.67 0.25 ...
##   ..@ site      :&#39;data.frame&#39;:   10 obs. of  1 variable:
##   .. ..$ id: chr [1:10] &quot;colusa&quot; &quot;glenn&quot; &quot;kings&quot; &quot;mariposa&quot; ...
##   ..@ sp        :Formal class &#39;SpatialPoints&#39; [package &quot;sp&quot;] with 3 slots
##   .. .. ..@ coords     : num [1, 1] 0
##   .. .. ..@ bbox       : logi [1, 1] NA
##   .. .. ..@ proj4string:Formal class &#39;CRS&#39; [package &quot;sp&quot;] with 1 slots
##   .. .. .. .. ..@ projargs: chr NA
##   ..@ diagnostic:&#39;data.frame&#39;:   0 obs. of  0 variables
</code></pre>

<pre><code class="r">
# inspect object properties
idname(sp4) # self-explanitory
</code></pre>

<pre><code>## [1] &quot;id&quot;
</code></pre>

<pre><code class="r">horizonDepths(sp4) # self-explanitory
</code></pre>

<pre><code>## [1] &quot;top&quot;    &quot;bottom&quot;
</code></pre>

<pre><code class="r">
# you can change these:
depth_units(sp4) # defaults to &#39;cm&#39;
</code></pre>

<pre><code>## [1] &quot;cm&quot;
</code></pre>

<pre><code class="r">metadata(sp4) # not much to start with
</code></pre>

<pre><code>##   depth_units
## 1          cm
</code></pre>

<pre><code class="r">
# alter the depth unit metadata
depth_units(sp4) &lt;- &#39;inches&#39; # units are really &#39;cm&#39;

# more generic interface for adjusting metadata
md &lt;- metadata(sp4) # save original metadata

# add columns
md$describer &lt;- &#39;DGM&#39;
md$date &lt;- as.Date(&#39;2009-01-01&#39;)
md$citation &lt;- &#39;McGahan, D.G., Southard, R.J, Claassen, V.P. 2009. Plant-Available Calcium Varies Widely in Soils on Serpentinite Landscapes. Soil Sci. Soc. Am. J. 73: 2087-2095.&#39;

# re-assign
metadata(sp4) &lt;- md
depth_units(sp4) &lt;- &#39;cm&#39; # fix depth units, back to &#39;cm&#39;

# further inspection with common function overloads
length(sp4) # number of profiles in the collection
</code></pre>

<pre><code>## [1] 10
</code></pre>

<pre><code class="r">nrow(sp4) # number of horizons in the collection
</code></pre>

<pre><code>## [1] 30
</code></pre>

<pre><code class="r">names(sp4) # column names
</code></pre>

<pre><code>## $horizons
##  [1] &quot;id&quot;          &quot;name&quot;        &quot;top&quot;         &quot;bottom&quot;      &quot;K&quot;          
##  [6] &quot;Mg&quot;          &quot;Ca&quot;          &quot;CEC_7&quot;       &quot;ex_Ca_to_Mg&quot; &quot;sand&quot;       
## [11] &quot;silt&quot;        &quot;clay&quot;        &quot;CF&quot;         
## 
## $site
## [1] &quot;id&quot;
</code></pre>

<pre><code class="r">min(sp4) # shallowest profile depth in collection
</code></pre>

<pre><code>## [1] 16
</code></pre>

<pre><code class="r">max(sp4) # deepest profile depth in collection
</code></pre>

<pre><code>## [1] 49
</code></pre>

<pre><code class="r">
# extraction of soil profile components
profile_id(sp4) # vector of profile IDs
</code></pre>

<pre><code>##  [1] &quot;colusa&quot;         &quot;glenn&quot;          &quot;kings&quot;          &quot;mariposa&quot;      
##  [5] &quot;mendocino&quot;      &quot;napa&quot;           &quot;san benito&quot;     &quot;shasta&quot;        
##  [9] &quot;shasta-trinity&quot; &quot;tehama&quot;
</code></pre>

<pre><code class="r">horizons(sp4) # horizon data
</code></pre>

<pre><code>##                id name top bottom   K   Mg   Ca CEC_7 ex_Ca_to_Mg sand
## 1          colusa    A   0      3 0.3 25.7  9.0  23.0        0.35   46
## 2          colusa  ABt   3      8 0.2 23.7  5.6  21.4        0.23   42
## 3          colusa  Bt1   8     30 0.1 23.2  1.9  23.7        0.08   40
## 4          colusa  Bt2  30     42 0.1 44.3  0.3  43.0        0.01   27
## 5           glenn    A   0      9 0.2 21.9  4.4  18.8        0.20   54
## 6           glenn   Bt   9     34 0.3 18.9  4.5  27.5        0.20   49
## 7           kings    A   0      4 0.2 12.1  1.4  23.7        0.58   43
## 8           kings  Bt1   4     13 0.6 12.1  7.0  18.0        0.51   36
## 9           kings  Bt2  13     40 0.8 17.7  4.4  20.0        0.25   27
## 19       mariposa    A   0      3 0.6 28.3  5.8  29.3        0.20   42
## 20       mariposa  Bt1   3     14 0.4 33.7  6.2  27.9        0.18   41
## 21       mariposa  Bt2  14     34 0.3 44.3  6.2  34.1        0.14   36
## 22       mariposa  Bt3  34     49 0.1 78.2  4.4  43.6        0.06   36
## 23      mendocino    A   0      2 0.5 12.8  2.2  19.3        0.18   57
## 24      mendocino  Bt1   2      8 0.2 27.1  3.4  19.8        0.13   51
## 25      mendocino  Bt2   8     30 0.2 30.5  3.7  22.9        0.12   51
## 10           napa    A   0      6 0.4 16.4 24.1  31.1        1.47   43
## 11           napa   Bt   6     20 0.1 16.2 21.5  27.9        1.32   54
## 12     san benito    A   0      8  NA  3.0  0.7   3.1        0.24   80
## 13     san benito   Bt   8     20 0.0  0.1  5.6   5.6        0.11   74
## 14         shasta    A   0      3 0.3  9.7  3.5  13.2        0.36   37
## 15         shasta   Bt   3     40 0.2 10.1  2.0  12.2        0.20   39
## 26 shasta-trinity   A1   0      2 0.2 18.8  6.6  23.0        0.35   34
## 27 shasta-trinity   A2   2      5 0.2 25.5  4.1  21.5        0.16   33
## 28 shasta-trinity   AB   5     12 0.3 29.3  3.5  29.6        0.12   24
## 29 shasta-trinity  Bt1  12     23 0.2 30.3  1.5  26.5        0.05   20
## 30 shasta-trinity  Bt2  23     40 0.1 64.9  0.8  48.7        0.01   11
## 16         tehama    A   0      3 0.4 12.4 16.3  40.2        1.31   57
## 17         tehama  Bt1   3      7 0.5 20.2 16.5  32.7        0.82   55
## 18         tehama  Bt2   7     16 0.2 27.7 13.7  30.0        0.50   51
##    silt clay   CF
## 1    33   21 0.12
## 2    31   27 0.27
## 3    28   32 0.27
## 4    18   55 0.16
## 5    20   25 0.55
## 6    18   34 0.84
## 7    55    3 0.50
## 8    49   15 0.75
## 9    45   27 0.67
## 19   26   32 0.25
## 20   34   25 0.38
## 21   33   31 0.71
## 22   31   33 0.67
## 23   30   13 0.16
## 24   28   21 0.14
## 25   26   23 0.80
## 10   42   15 0.02
## 11   29   17 0.07
## 12    8   12 0.43
## 13    7   19 0.60
## 14   49   14 0.78
## 15   46   14 0.88
## 26   44   22 0.17
## 27   42   25 0.13
## 28   36   40 0.09
## 29   29   51 0.05
## 30   22   67 0.05
## 16   19   24 0.43
## 17   20   25 0.10
## 18   17   32 0.34
</code></pre>

<pre><code class="r">
# extraction of specific horizon attributes
sp4$clay # vector of clay content
</code></pre>

<pre><code>##  [1] 21 27 32 55 25 34  3 15 27 32 25 31 33 13 21 23 15 17 12 19 14 14 22
## [24] 25 40 51 67 24 25 32
</code></pre>

<pre><code class="r">
# subsetting SoilProfileCollection objects
sp4[1, ] # first profile in the collection
</code></pre>

<pre><code>## Object of class SoilProfileCollection
## Number of profiles: 1
## 
## Horizon attributes:
##       id name top bottom   K   Mg  Ca CEC_7 ex_Ca_to_Mg sand silt clay
## 1 colusa    A   0      3 0.3 25.7 9.0  23.0        0.35   46   33   21
## 2 colusa  ABt   3      8 0.2 23.7 5.6  21.4        0.23   42   31   27
## 3 colusa  Bt1   8     30 0.1 23.2 1.9  23.7        0.08   40   28   32
## 4 colusa  Bt2  30     42 0.1 44.3 0.3  43.0        0.01   27   18   55
##     CF
## 1 0.12
## 2 0.27
## 3 0.27
## 4 0.16
## 
## Sampling site attributes:
##       id
## 1 colusa
## 
## Spatial Data:
##      [,1]
## [1,]   NA
## CRS arguments: NA
</code></pre>

<pre><code class="r">sp4[, 1] # first horizon from each profile
</code></pre>

<pre><code>## Object of class SoilProfileCollection
## Number of profiles: 10
## Depth range: 2-9 cm
## 
## Horizon attributes:
##          id name top bottom   K   Mg   Ca CEC_7 ex_Ca_to_Mg sand silt clay
## 1    colusa    A   0      3 0.3 25.7  9.0  23.0        0.35   46   33   21
## 2     glenn    A   0      9 0.2 21.9  4.4  18.8        0.20   54   20   25
## 3     kings    A   0      4 0.2 12.1  1.4  23.7        0.58   43   55    3
## 4  mariposa    A   0      3 0.6 28.3  5.8  29.3        0.20   42   26   32
## 5 mendocino    A   0      2 0.5 12.8  2.2  19.3        0.18   57   30   13
## 6      napa    A   0      6 0.4 16.4 24.1  31.1        1.47   43   42   15
##     CF
## 1 0.12
## 2 0.55
## 3 0.50
## 4 0.25
## 5 0.16
## 6 0.02
## 
## Sampling site attributes:
##          id
## 1    colusa
## 2     glenn
## 3     kings
## 4  mariposa
## 5 mendocino
## 6      napa
</code></pre>

<pre><code class="r">
# basic plot method, highly customizable: see manual page ?plotSPC
plot(sp4)
# inspect plotting area, very simple to overlay graphical elements
abline(v=1:length(sp4), lty=3, col=&#39;blue&#39;)
# profiles are centered at integers, from 1 to length(obj)
axis(1, line=-1.5, at=1:10, cex.axis=0.75, font=4, col=&#39;blue&#39;, lwd=2)
# y-axis is based on profile depths
axis(2, line=-1, at=pretty(1:max(sp4)), cex.axis=0.75, font=4, las=1, col=&#39;blue&#39;, lwd=2)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAAAwFBMVEX9/v0AAAAAAEYAAEgAAHMAAHQAAJwAAL8AAN8AAP8ARpoAdL1GAABGAEZGAHNGRkZGRppGdL1Gm95zAABzAEZzAHNzRppzdABzdEZzdHNzdL1zm95zvr1zvv2aRgCaRkaaRnOadACadHOadJqam0aam3Oa396a3/29dAC9dEa9dHO9m0a9vnO935q9/r29/t69/v2////em0bevnPe35re397e/r3e/t7e/v39vnP9vr3935r9/r39/t79/v3///85f0psAAAAQHRSTlP//////////////////////////////////////////////////////////////////////////////////wD/fF2juwAAAAlwSFlzAAAPYQAAD2EBqD+naQAAHc9JREFUeJztnQ2b2zZ2RpeTabOSZmN7pna2caVm2zqj2E2q5brrYfWx//9flSApakQAxAWBS16B73km9pPRSxCQjnkhkKL+cAKAgT9M3QGQJhALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsDC6WAvEBMT4gVizjPGDUghYgFiABZTCWcb4gVizjPGDUghYgFiABZTCWcb4gVizjPGDUghYgFiABZTCWcb4gVizjPGDUghYgFiABZTCWcb4gVizjPGDUghYgFiABZTCWcb4gVizjPGDUghYgFiABZTCWcb4gVizjPGDUghYgFiABZTCWcb4gVizjPGDUghYgFiABZTCWcb4gVizjPGDUghYgFiABZTCWcb4gVizjPETT6zjJrt7jtYauHGiiXXcLL9tli+xmgM3TjSximx9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xXGTEU7K5tXpN3euWawhxAiny/Z/el7Yrosbm5HFKkdNeYIeVpTzjkVGilUryITz81vamc7t8hvtnKhaOnZliCM9PK2aq5N6qJ9b23VxYzOuWOU/PMoyam65tssAKbbNCCeb3K9cRXOVEAFK14rSeEKuekIc/jXPre26uLEZV6xitacUpZI/0o4K3z8RYkX2HeGZLo2hTFBKSWmnGEgjLXf6PeHAVpqycNlSVFeYLLrXxU3F2HOsgnjRGGlWVLZGmhQtKfW3vq7M3Vi2/ifSGLbfUV7dnDIRU6b8ceMcqnpuv+9eFzcVY4uV0y553T/Qpgk54SnM736hTDrq68pcKTUjIl0eRBtBuVPKM1JmCrf1qiUx18WNLRbtKH2gVDgF4QBYPtXE6RNluq0iJLFI/4JUS6RjuCrAzp2q53Yv5bq40d8VUoyhH8sJr8q2euPvNKa5rszdNSWWWwXaQOur2EiTA/fFbtUuydfFcTOyWJS34MoF2gTrkbhEQHmmm+vKnLkyQ9kpbaAqRWitWpQgHUxP5OviuBlZLNJRuqiOMW4XtpTZtoIiDHWpkrj+SDwOEXeaU96J1s+tlOvicK4QsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAsQC7AAsQALEAuwALEACxALsACxAAv/DzcGdMvwCxshAAAAAElFTkSuQmCC" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">

# setup some colors- to symbolize soil properties
cols &lt;- rev(brewer.pal(8, &#39;Spectral&#39;))
# generate a color ramp function based on the color pallette defined above
cr &lt;- colorRamp(cols)
# associate colors with exchangeable Ca:Mg, and save to new horizon-level attribute
sp4$soil_color &lt;- rgb(cr(rescale(sp4$ex_Ca_to_Mg)), max=255)

# plot again, this time using new colors
par(mar=c(0,0,0,0))
plot(sp4) # how does it know about horizon names / colors? see the manual page.
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAABAlBMVEX9/v0AAAAAAEYAAHMARkYARnMARpoAdHMAdJoAdKYAdL0yiL07k7g+lbdDm7RGAABGAEZGAHNGRgBGRkZGRppGdL1Gm95Ko7FNprBPqa9SrK5Xsatct6lhvKdldEZpw6RtxKRwxqRzAABzAEZzAHNzRgBzRppzdABzdEZzdHNzdL1zm95zvr1zvv2HiEaR06SU1KSaRgCaRnOadHOadJqam0aam3Oavpqa372a396a3/29dAC9dEa9dHO9m0a935q93/29/r29/v2/5Z/C5p/Dm0bVPk/W7pvem0bevnPe397e/r3e/v3rX0bsYkX74oz9vnP935r93739/r39/t79/v3ykAFfAAAAVnRSTlP/////////////////////////////////////////////////////////////////////////////////////////////////////////////////AEpNbNkAAAAJcEhZcwAAD2EAAA9hAag/p2kAABUcSURBVHic7d0Lf9tYXofxlQOzEC4ZpsTcL5sd2qVdL8wCZde9DAQWBBSQcf3+3wqSjqyoPn8d5fjoZ9ny83z6yc6m56+L+62jOo79gx2RoB9MfQA0z4BFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkoBFkp4Fa/P1OmKTEavd0rjNH3NIVduHVdoGBipuHg8+U+3ivbEXf+XhsoEV7r/bM+juZ/+/xhZO2znAOk0HsEbP/KMsFs+CdbgsvMLY6P5T7W+dMax3WXbbfCz//MsDLf9kPn9X/d/tQ5Z99ckYKX/71+5WlZZ6rLh5ld08uo/2PqoNL9b15qtFbt7tpFu++Cb7je/Kfbo9F1l28301+U214XpXnQP71X5x9yDclr1zetVu4Cn32WZP9S688+3eDO3pdQ/HfXLz9S+/yxbrzvbdYHcP9WfKD4tfuJ0Mr6iWLN42N8HTfrJsuXv3m+3+uls4uPmeoWKEemE5SXn1cdnC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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
# apply a function to each profile, returning a single value per profile,
# in the same order as profile_id(sp4)
soil.depths &lt;- profileApply(sp4, max) # recall that max() gives the depth of a soil profile

# check that the order is correct
all.equal(names(soil.depths), profile_id(sp4))
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

<pre><code class="r">
# a vector of values that is the same length as the number of profiles
# can be stored into site-level data
sp4$depth &lt;- soil.depths
# check: looks good
max(sp4[1, ]) == sp4$depth[1]
</code></pre>

<pre><code>## [1] TRUE
</code></pre>

<pre><code class="r">
# extract site-level data 
site(sp4) # as a data.frame
</code></pre>

<pre><code>##                id depth
## 1          colusa    42
## 2           glenn    34
## 3           kings    40
## 4        mariposa    49
## 5       mendocino    30
## 6            napa    20
## 7      san benito    20
## 8          shasta    40
## 9  shasta-trinity    40
## 10         tehama    16
</code></pre>

<pre><code class="r">sp4$depth # specific columns as a vector
</code></pre>

<pre><code>##  [1] 42 34 40 49 30 20 20 40 40 16
</code></pre>

<pre><code class="r">
# use site-level data to alter plotting order
new.order &lt;- order(sp4$depth) # the result is an index of rank
par(mar=c(0,0,0,0))
plot(sp4, plot.order=new.order)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAJYCAMAAACJuGjuAAABDlBMVEX9/v0AAAAAADUAAEYAAFYAAHMAIAAARkYARnMARpoAV1YAdHMAdJoAdL0yiL07k7g+lbdDm7RGAABGAEZGAHNGRgBGRkZGRppGdGVGdL1Gm95Ko7FNprBPqa9SrK5WAABXsatct6lhvKdpw6RtxKRwxqRzAABzAEZzAHNzRgBzRppzdABzdEZzdHNzdL1zm95zvr1zvv2OdACR06SU1KSaRgCaRnOadHOadJqam0aam3Oavpqa372a396a3/2mm0a9dAC9dEa9dHO9m0a935q93/29/r29/v2/5Z/C5p/VPk/W7pvem0bevnPe397e/r3e/v3rX0bsYkX74oz9vnP935r93739/r39/t79/v3Pe5UnAAAAWnRSTlP//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wDR1opvAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAWMklEQVR4nO3diXvbelbG8REmwGUISy5TJmHfMpd2aMfAHaDMmC4XwiKggIyr//8fQYvtqD6vfspRdGLL+b5PnrRx9B5LzieKvH+vJCQg3zv2CpDzDLBISIBFQgIsEhJgkZAAi4QEWCQkwCIhARYJCbBISIBFQgIsEhJgkZAAi4QEWCQkwCIhARYJCbBISIBFQgIsEhJgkZAAi4QEWCQkwCIhARYJCbBISIBFQgIsEhJgkZAAi4QEWCQkwCIhARYJCbBISIBFQgIsEhJgkZAAi4QEWCQkwCIhARYJCbBISIBFQgIsEhJgkZAAi4SkF9b7VftvcXH3BKthz2X99Wq/Diqb2+Xh4r1JflMt6iiU8iL6cs0HFmj/vz/Pvi33rdS4xnTpg1Usjgyruw4qB7CSccPyxa78wZqnFxCbKbf8mEz86YH1+dtssXqXZZfVhfIqu7jb3GbZV5/yxQ+yX/u2+k/7peh1ly6qpXf//3J0NXa7SLN43WuWLTvnuP7659t1+KX2PLvfrGb88tWyPaX9XF3q22HtifdnVi1Y/0g67f25itRzFqv9tLbfrrK+mA4uouaU+tL72f2XqQXai/ptll18tzvPZsuz7KZ8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" alt="plot of chunk unnamed-chunk-1"/> </p>

<pre><code class="r">
# deconstruct SoilProfileCollection into a data.frame, with horizon+site data
as(sp4, &#39;data.frame&#39;)
</code></pre>

<pre><code>##                id name top bottom   K   Mg   Ca CEC_7 ex_Ca_to_Mg sand
## 1          colusa    A   0      3 0.3 25.7  9.0  23.0        0.35   46
## 2          colusa  ABt   3      8 0.2 23.7  5.6  21.4        0.23   42
## 3          colusa  Bt1   8     30 0.1 23.2  1.9  23.7        0.08   40
## 4          colusa  Bt2  30     42 0.1 44.3  0.3  43.0        0.01   27
## 5           glenn    A   0      9 0.2 21.9  4.4  18.8        0.20   54
## 6           glenn   Bt   9     34 0.3 18.9  4.5  27.5        0.20   49
## 7           kings    A   0      4 0.2 12.1  1.4  23.7        0.58   43
## 8           kings  Bt1   4     13 0.6 12.1  7.0  18.0        0.51   36
## 9           kings  Bt2  13     40 0.8 17.7  4.4  20.0        0.25   27
## 10       mariposa    A   0      3 0.6 28.3  5.8  29.3        0.20   42
## 11       mariposa  Bt1   3     14 0.4 33.7  6.2  27.9        0.18   41
## 12       mariposa  Bt2  14     34 0.3 44.3  6.2  34.1        0.14   36
## 13       mariposa  Bt3  34     49 0.1 78.2  4.4  43.6        0.06   36
## 14      mendocino    A   0      2 0.5 12.8  2.2  19.3        0.18   57
## 15      mendocino  Bt1   2      8 0.2 27.1  3.4  19.8        0.13   51
## 16      mendocino  Bt2   8     30 0.2 30.5  3.7  22.9        0.12   51
## 17           napa    A   0      6 0.4 16.4 24.1  31.1        1.47   43
## 18           napa   Bt   6     20 0.1 16.2 21.5  27.9        1.32   54
## 19     san benito    A   0      8  NA  3.0  0.7   3.1        0.24   80
## 20     san benito   Bt   8     20 0.0  0.1  5.6   5.6        0.11   74
## 21         shasta    A   0      3 0.3  9.7  3.5  13.2        0.36   37
## 22         shasta   Bt   3     40 0.2 10.1  2.0  12.2        0.20   39
## 23 shasta-trinity   A1   0      2 0.2 18.8  6.6  23.0        0.35   34
## 24 shasta-trinity   A2   2      5 0.2 25.5  4.1  21.5        0.16   33
## 25 shasta-trinity   AB   5     12 0.3 29.3  3.5  29.6        0.12   24
## 26 shasta-trinity  Bt1  12     23 0.2 30.3  1.5  26.5        0.05   20
## 27 shasta-trinity  Bt2  23     40 0.1 64.9  0.8  48.7        0.01   11
## 28         tehama    A   0      3 0.4 12.4 16.3  40.2        1.31   57
## 29         tehama  Bt1   3      7 0.5 20.2 16.5  32.7        0.82   55
## 30         tehama  Bt2   7     16 0.2 27.7 13.7  30.0        0.50   51
##    silt clay   CF soil_color depth
## 1    33   21 0.12    #91D3A4    42
## 2    31   27 0.27    #69C3A4    42
## 3    28   32 0.27    #439BB4    42
## 4    18   55 0.16    #3288BD    42
## 5    20   25 0.55    #61BCA7    34
## 6    18   34 0.84    #61BCA7    34
## 7    55    3 0.50    #D6EE9B    40
## 8    49   15 0.75    #C2E69F    40
## 9    45   27 0.67    #70C6A4    40
## 10   26   32 0.25    #61BCA7    49
## 11   34   25 0.38    #5CB7A9    49
## 12   33   31 0.71    #52ACAE    49
## 13   31   33 0.67    #3E95B7    49
## 14   30   13 0.16    #5CB7A9    30
## 15   28   21 0.14    #4FA9AF    30
## 16   26   23 0.80    #4DA6B0    30
## 17   42   15 0.02    #D53E4F    20
## 18   29   17 0.07    #EB5F46    20
## 19    8   12 0.43    #6DC4A4    20
## 20    7   19 0.60    #4AA3B1    20
## 21   49   14 0.78    #94D4A4    40
## 22   46   14 0.88    #61BCA7    40
## 23   44   22 0.17    #91D3A4    40
## 24   42   25 0.13    #57B1AB    40
## 25   36   40 0.09    #4DA6B0    40
## 26   29   51 0.05    #3B93B8    40
## 27   22   67 0.05    #3288BD    40
## 28   19   24 0.43    #EC6245    16
## 29   20   25 0.10    #FBE28C    16
## 30   17   32 0.34    #BFE59F    16
</code></pre>

<pre><code class="r">
</code></pre>


<hr><div align="center">[Package <em>aqp</em> version 1.5-1 <a href="00Index.html">Index</a>]</div>
</body></html>
